GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:30:50 Page 1
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


   1  option MCP=convert;
   2  option MCP=convert;
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:30:50 Page 2
Hansen's Activity Analysis Example (HANSMCP,SEQ=135)
C o m p i l a t i o n


      Hansen's Activity Analysis Example
       
       
      Scarf, H, and Hansen, T, The Computation of Economic Equilibria.
      Yale University Press, 1973.
       
  12   
  13  sets    c       commodities
  14   
  15     /    agric, food, textiles, hserv, entert, houseop, capeop, steel,
  16          coal, lumber, housbop, capbop, labor, exchange/
  17   
  18   
  19          h       consumers
  20    /     agent1, agent2, agent3, agent4  /
  21   
  22   
  23          s       sectors
  24    /     dom1, dom2, dom3, dom4, dom5, dom6, dom7,
  25          dom8, dom9, dom10, dom11, dom12,
  26          imp1, imp2, imp3, imp4, imp5, imp6, imp7,
  27          exp1, exp2, exp3, exp4, exp5, exp6, exp7 /
  28   
  29  alias (c,cc);
  30   
  31  table e(c,h)  commodity endowments
  32   
  33             agent1    agent2  agent3    agent4
  34  housbop         2       0.4               0.8
  35  capbop          3         2               7.5
  36  labor         0.6       0.8       1       0.6
  37   
  38   
  39  table d(c,h) reference demands
  40   
  41                      agent1     agent2     agent3     agent4
  42      agric              0.1        0.2        0.3        0.1
  43      food               0.2        0.2        0.2        0.2
  44      textiles           0.1        0.1        0.3        0.1
  45      hserv              0.1        0.1        0.1        0.1
  46      entert             0.1        0.1        0.1        0.1
  47      houseop            0.3        0.1                   0.1
  48      capeop             0.1        0.2                   0.3
  49   
  50  parameter  esub(h)  elasticities in demand
  51   
  52      /   agent1          1,        agent2          1,
  53          agent3          1,        agent4          1 /;
  54   
  55  table data(*,c,s)  activity analysis matrix
  56   
  57                         dom1        dom2        dom3        dom4        dom5
  58   
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:30:50 Page 3
Hansen's Activity Analysis Example (HANSMCP,SEQ=135)
C o m p i l a t i o n


  59  output.agric           5.00
  60  output.food                        5.00
  61  output.textiles                                2.00
  62  output.hserv                                               2.00
  63  output.entert                                                          4.00
  64  output.houseop                                             0.32
  65  output.capeop          0.40        1.30        1.20
  66  input .agric                       3.50        0.10                    0.70
  67  input .food            0.90                    0.10                    0.80
  68  input .textiles        0.20        0.50                    0.10        0.10
  69  input .hserv           1.00        2.00        2.00                    2.00
  70  input .steel           0.20        0.40        0.20        0.10
  71  input .coal            1.00        0.10        0.10        1.00
  72  input .lumber          0.50        0.40        0.30        0.30
  73  input .housbop                                             0.40
  74  input .capbop          0.50        1.50        1.50        0.10        0.10
  75  input .labor           0.40        0.20        0.20        0.02        0.40
  76   
  77                +        dom6        dom7        dom8        dom9       dom10
  78   
  79  output.houseop         0.80
  80  output.capeop          1.10        6.00        1.80        1.20        0.40
  81  output.steel                                   2.00
  82  output.coal                                                2.00
  83  output.lumber                                                          1.00
  84  input .textiles        0.80        0.40        0.10        0.10        0.10
  85  input .hserv           0.40        1.80        1.60        0.80        0.20
  86  input .steel           1.00        2.00                    0.50        0.20
  87  input .coal                        0.20        1.00                    0.20
  88  input .lumber          3.00        0.20        0.20        0.50
  89  input .capbop          1.50        2.50        2.50        1.50        0.50
  90  input .labor           0.30        0.10        0.10        0.40        0.40
  91   
  92                +       dom11       dom12        imp1        imp2        imp3
  93   
  94  output.agric                                   1.00
  95  output.food                                                1.00
  96  output.textiles                                                        1.00
  97  output.houseop                     0.36
  98  output.capeop          0.90
  99  input .hserv                                   0.40        0.20        0.20
 100  input .housbop                     0.40
 101  input .capbop          1.00                    0.20        0.10        0.10
 102  input .labor                                   0.04        0.02        0.02
 103  input .exchange                                0.50        0.40        0.80
 104   
 105                +        imp4        imp5        imp6        imp7        exp1
 106   
 107  output.capeop          1.00
 108  output.steel                       1.00
 109  output.coal                                    1.00
 110  output.lumber                                              1.00
 111  output.exchange                                                        0.50
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:30:50 Page 4
Hansen's Activity Analysis Example (HANSMCP,SEQ=135)
C o m p i l a t i o n


 112  input .agric                                                           1.00
 113  input .hserv           0.40        0.40        0.40        0.40        0.20
 114  input .capbop          0.20        0.20        0.20        0.20        0.20
 115  input .labor           0.04        0.04        0.04        0.04        0.04
 116  input .exchange        1.20        0.60        0.70        0.40
 117   
 118                +        exp2        exp3        exp4        exp5        exp6
 119   
 120  output.exchange        0.40        0.80        1.20        0.60        0.70
 121  input .food            1.00
 122  input .textiles                    1.00
 123  input .hserv           0.20        0.20        0.40        0.40        0.40
 124  input .capeop                                  1.00
 125  input .steel                                               1.00
 126  input .coal                                                            1.00
 127  input .capbop          0.10        0.10        0.20        0.20        0.20
 128  input .labor           0.02        0.02        0.04        0.04        0.04
 129   
 130                +        exp7
 131   
 132  output.exchange        0.40
 133  input .hserv           0.40
 134  input .lumber          1.00
 135  input .capbop          0.20
 136  input .labor           0.04
 137   
 138   
 139  parameter       alpha(c,h)      demand function share parameter;
 140  alpha(c,h) = d(c,h) / sum(cc, d(cc,h));
 141   
 142  parameter  a(c,s)  activity analysis matrix;
 143  a(c,s) = data("output",c,s) - data("input",c,s);
 144   
 145  positive
 146  variables
 147          p(c)    commodity price,
 148          y(s)    production,
 149          i(h)    income;
 150   
 151  equations
 152          mkt(c)          commodity market,
 153          profit(s)       zero profit,
 154          income(h)       income index;
 155   
 156  *       distinguish ces and cobb-douglas demand functions:
 157   
 158  mkt(c)..        sum(s, a(c,s) * y(s)) + sum(h, e(c,h)) =g=
 159   
 160                  sum(h$(esub(h) ne 1),
 161                  (i(h)/sum(cc, alpha(cc,h) * p(cc)**(1-esub(h)))) *
 162                  alpha(c,h) * (1/p(c))**esub(h)) +
 163   
 164                  sum(h$(esub(h) eq 1),
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:30:50 Page 5
Hansen's Activity Analysis Example (HANSMCP,SEQ=135)
C o m p i l a t i o n


 165                  i(h) * alpha(c,h) / p(c));
 166   
 167  profit(s)..     -sum(c, a(c,s) * p(c)) =g= 0;
 168   
 169  income(h)..     i(h) =g= sum(c, p(c) * e(c,h));
 170   
 171  model hansen / mkt.p, profit.y, income.i/;
 172   
 173  p.l(c) = 1;
 174  y.l(s) = 1;
 175  i.l(h) = 1;
 176   
 177  p.lo(c)  = 0.00001$(smax(h, alpha(c,h)) gt eps);
 178   
 179  *       fix the price of numeraire commodity:
 180   
 181  p.fx(c)$(ord(c) eq 1) = 1;
 182   
 183  solve hansen using mcp;
 184   


COMPILATION TIME     =        0.001 SECONDS      3 MB  24.7.4 r58773 LEX-LEG
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:30:50 Page 6
Hansen's Activity Analysis Example (HANSMCP,SEQ=135)
Equation Listing    SOLVE hansen Using MCP From line 183


---- mkt  =G=  commodity market

mkt(agric)..  (0.7)*p(agric) + 5*y(dom1) - 3.5*y(dom2) - 0.1*y(dom3) - 0.7*y(dom5) + y(imp1) - y(exp1) - (0.1)*i(agent1) - (0.2)*i(agent2) - (0.3)*i(agent3) - (0.1)*i(agent4) =G= 0 ; (LHS = 0)
     
mkt(food)..  (0.8)*p(food) - 0.9*y(dom1) + 5*y(dom2) - 0.1*y(dom3) - 0.8*y(dom5) + y(imp2) - y(exp2) - (0.2)*i(agent1) - (0.2)*i(agent2) - (0.2)*i(agent3) - (0.2)*i(agent4) =G= 0 ; (LHS = 2.4)
     
mkt(textiles)..  (0.6)*p(textiles) - 0.2*y(dom1) - 0.5*y(dom2) + 2*y(dom3) - 0.1*y(dom4) - 0.1*y(dom5) - 0.8*y(dom6) - 0.4*y(dom7) - 0.1*y(dom8) - 0.1*y(dom9) - 0.1*y(dom10) + y(imp3) - y(exp3) - (0.1)*i(agent1) - (0.1)*i(agent2) - (0.3)*i(agent3)
     
      - (0.1)*i(agent4) =G= 0 ; (LHS = -1, INFES = 1 ****)
     
REMAINING 11 ENTRIES SKIPPED


---- profit  =G=  zero profit

profit(dom1)..  - 5*p(agric) + 0.9*p(food) + 0.2*p(textiles) + p(hserv) - 0.4*p(capeop) + 0.2*p(steel) + p(coal) + 0.5*p(lumber) + 0.5*p(capbop) + 0.4*p(labor) =G= 0 ; (LHS = -0.699999999999999, INFES = 0.699999999999999 ****)
     
profit(dom2)..  3.5*p(agric) - 5*p(food) + 0.5*p(textiles) + 2*p(hserv) - 1.3*p(capeop) + 0.4*p(steel) + 0.1*p(coal) + 0.4*p(lumber) + 1.5*p(capbop) + 0.2*p(labor) =G= 0 ; (LHS = 2.3)
     
profit(dom3)..  0.1*p(agric) + 0.1*p(food) - 2*p(textiles) + 2*p(hserv) - 1.2*p(capeop) + 0.2*p(steel) + 0.1*p(coal) + 0.3*p(lumber) + 1.5*p(capbop) + 0.2*p(labor) =G= 0 ; (LHS = 1.3)
     
REMAINING 23 ENTRIES SKIPPED


---- income  =G=  income index

income(agent1)..  - 2*p(housbop) - 3*p(capbop) - 0.6*p(labor) + i(agent1) =G= 0 ; (LHS = -4.6, INFES = 4.6 ****)
     
income(agent2)..  - 0.4*p(housbop) - 2*p(capbop) - 0.8*p(labor) + i(agent2) =G= 0 ; (LHS = -2.2, INFES = 2.2 ****)
     
income(agent3)..  - p(labor) + i(agent3) =G= 0 ; (LHS = 0)
     
REMAINING ENTRY SKIPPED

GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:30:50 Page 7
Hansen's Activity Analysis Example (HANSMCP,SEQ=135)
Column Listing      SOLVE hansen Using MCP From line 183


---- p  commodity price

p(agric)
                (.LO, .L, .UP, .M = 1, 1, 1, 0)
       (0.7)    mkt(agric)
       -5       profit(dom1)
        3.5     profit(dom2)
        0.1     profit(dom3)
        0.7     profit(dom5)
       -1       profit(imp1)
        1       profit(exp1)

p(food)
                (.LO, .L, .UP, .M = 1E-5, 1, +INF, 0)
       (0.8)    mkt(food)
        0.9     profit(dom1)
       -5       profit(dom2)
        0.1     profit(dom3)
        0.8     profit(dom5)
       -1       profit(imp2)
        1       profit(exp2)

p(textiles)
                (.LO, .L, .UP, .M = 1E-5, 1, +INF, 0)
       (0.6)    mkt(textiles)
        0.2     profit(dom1)
        0.5     profit(dom2)
       -2       profit(dom3)
        0.1     profit(dom4)
        0.1     profit(dom5)
        0.8     profit(dom6)
        0.4     profit(dom7)
        0.1     profit(dom8)
        0.1     profit(dom9)
        0.1     profit(dom10)
       -1       profit(imp3)
        1       profit(exp3)

REMAINING 11 ENTRIES SKIPPED

---- y  production

y(dom1)
                (.LO, .L, .UP, .M = 0, 1, +INF, 0)
        5       mkt(agric)
       -0.9     mkt(food)
       -0.2     mkt(textiles)
       -1       mkt(hserv)
        0.4     mkt(capeop)
       -0.2     mkt(steel)
       -1       mkt(coal)
       -0.5     mkt(lumber)
       -0.5     mkt(capbop)
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:30:50 Page 8
Hansen's Activity Analysis Example (HANSMCP,SEQ=135)
Column Listing      SOLVE hansen Using MCP From line 183


     y  production

       -0.4     mkt(labor)

y(dom2)
                (.LO, .L, .UP, .M = 0, 1, +INF, 0)
       -3.5     mkt(agric)
        5       mkt(food)
       -0.5     mkt(textiles)
       -2       mkt(hserv)
        1.3     mkt(capeop)
       -0.4     mkt(steel)
       -0.1     mkt(coal)
       -0.4     mkt(lumber)
       -1.5     mkt(capbop)
       -0.2     mkt(labor)

y(dom3)
                (.LO, .L, .UP, .M = 0, 1, +INF, 0)
       -0.1     mkt(agric)
       -0.1     mkt(food)
        2       mkt(textiles)
       -2       mkt(hserv)
        1.2     mkt(capeop)
       -0.2     mkt(steel)
       -0.1     mkt(coal)
       -0.3     mkt(lumber)
       -1.5     mkt(capbop)
       -0.2     mkt(labor)

REMAINING 23 ENTRIES SKIPPED

---- i  income

i(agent1)
                (.LO, .L, .UP, .M = 0, 1, +INF, 0)
      (-0.1)    mkt(agric)
      (-0.2)    mkt(food)
      (-0.1)    mkt(textiles)
      (-0.1)    mkt(hserv)
      (-0.1)    mkt(entert)
      (-0.3)    mkt(houseop)
      (-0.1)    mkt(capeop)
        1       income(agent1)

i(agent2)
                (.LO, .L, .UP, .M = 0, 1, +INF, 0)
      (-0.2)    mkt(agric)
      (-0.2)    mkt(food)
      (-0.1)    mkt(textiles)
      (-0.1)    mkt(hserv)
      (-0.1)    mkt(entert)
      (-0.1)    mkt(houseop)
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:30:50 Page 9
Hansen's Activity Analysis Example (HANSMCP,SEQ=135)
Column Listing      SOLVE hansen Using MCP From line 183


     i  income

      (-0.2)    mkt(capeop)
        1       income(agent2)

i(agent3)
                (.LO, .L, .UP, .M = 0, 1, +INF, 0)
      (-0.3)    mkt(agric)
      (-0.2)    mkt(food)
      (-0.3)    mkt(textiles)
      (-0.1)    mkt(hserv)
      (-0.1)    mkt(entert)
        1       income(agent3)

REMAINING ENTRY SKIPPED
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 10:30:50 Page 10
Hansen's Activity Analysis Example (HANSMCP,SEQ=135)
Model Statistics    SOLVE hansen Using MCP From line 183


MODEL STATISTICS

BLOCKS OF EQUATIONS           3     SINGLE EQUATIONS           44
BLOCKS OF VARIABLES           3     SINGLE VARIABLES           44
NON ZERO ELEMENTS           367     NON LINEAR N-Z             33
DERIVATIVE POOL              20     CONSTANT POOL              21
CODE LENGTH                 144


GENERATION TIME      =        0.003 SECONDS      4 MB  24.7.4 r58773 LEX-LEG


EXECUTION TIME       =        0.003 SECONDS      4 MB  24.7.4 r58773 LEX-LEG
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 10:30:50 Page 11
Hansen's Activity Analysis Example (HANSMCP,SEQ=135)
Solution Report     SOLVE hansen Using MCP From line 183


               S O L V E      S U M M A R Y

     MODEL   hansen              
     TYPE    MCP                 
     SOLVER  CONVERT             FROM LINE  183

**** SOLVER STATUS     1 Normal Completion         
**** MODEL STATUS      14 No Solution Returned     

 RESOURCE USAGE, LIMIT          0.000      1000.000
 ITERATION COUNT, LIMIT         0    2000000000
 EVALUATION ERRORS              0             0

Convert 2.0      24.7.4 r58773 Released Sep 19, 2016 LEG x86 64bit/Linux      

--- Using Option File
Reading parameter(s) from "/home/renigijus/gams/opt-mod-lib/gamslib/hansmcp/convert.opt"
>>  gams hansmcp-scalar.gms
Finished reading from "/home/renigijus/gams/opt-mod-lib/gamslib/hansmcp/convert.opt"
Gams      : hansmcp-scalar.gms


No solution returned


EXECUTION TIME       =        0.000 SECONDS      2 MB  24.7.4 r58773 LEX-LEG


USER: Remigijus Paulavicius, Single User License     S170731:0859AO-LNX
      Imperial College London, Dept. of Chemical Engineering    DC13449
      License for teaching and research at degree granting institutions


**** FILE SUMMARY

Input      /home/renigijus/gams/opt-mod-lib/gamslib/hansmcp/hansmcp.gms
Output     /home/renigijus/gams/opt-mod-lib/gamslib/hansmcp/hansmcp-scalar.gms.lst
