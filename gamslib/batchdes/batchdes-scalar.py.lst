GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:52 Page 1
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


   1  option MINLP=convert;
   2  option MINLP=convert;
   3  option MINLP=convert;
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:52 Page 2
Optimal Design for Chemical Batch Processing (BATCHDES,SEQ=119)
C o m p i l a t i o n


   5   
       
         A chemical batch process having three processing stages: mixing,
         reaction and centrifuge separation, produce two products. This
         model is used to determine the number and sizes of units to
         operate in parallel at each stage. The resulting model is
         nonlinear and mixed integer;
       
       
      Morari, M, and Grossmann, I E, Eds, Chemical Engineering Optimization
      Models with GAMS. Computer Aids for Chemical Engineering Corporation,
      1991.
       
      Kocis, G R, and Grossmann, I E, Global Optimization of Nonconvex MINLP
      Problems in Process Synthesis. Independent Engineering Chemical
      Research 27 (1988), 1407-1421.
       
  24  Sets         i         products         / a , b /
  25               j         stages           /mixer, reactor, centrifuge/
  26               k         potential number of parallel units  / 1 * 3 /
  27   
  28  Scalar       h         horizon time (available time hrs)  /6000./
  29               vlow      lower bound for size of batch unit /250./
  30               vupp      upper bound for size of batch unit /2500./
  31   
  32  Parameters   q(i)      demand of product i  /
  33                          a   200000
  34                          b   150000        /
  35               alpha(j)  cost coefficient for batch units
  36                        / mixer        250.
  37                          reactor      500.
  38                          centrifuge   340. /
  39               beta(j)   cost exponent for batch units
  40                        / mixer        0.6
  41                          reactor      0.6
  42                          centrifuge   0.6  /
  43   
  44  * the parameters below are defined to obtain the original variables
  45               actv(j)   actual volume (l)
  46               actb(i)   actual batch sizes (kg)
  47               acttl(i)  actual cycle times (hrs)
  48               actn(j)   actual number of units in parallel
  49               coeff(k)  represent number of parallel units   ;
  50   
  51  coeff(k) = log(ord(k))  ;
  52   
  53  Table        s(i,j)    size factor for product i in stage j (kg per l)
  54             mixer     reactor   centrifuge
  55     a          2         3         4
  56     b          4         6         3
  57   
  58  Table        t(i,j)    processing time of product i in batch j (hrs)
  59             mixer     reactor   centrifuge
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:52 Page 3
Optimal Design for Chemical Batch Processing (BATCHDES,SEQ=119)
C o m p i l a t i o n


  60     a          8        20         4
  61     b         10        12         3
  62   
  63  Variables    y(k,j)    binary variable denoting stage existence
  64               v(j)      volume of stage j (l)
  65               b(i)      batch size of product i (kg)
  66               tl(i)     cycle time of product i (hrs)
  67               n(j)      number of units in parallel stage j
  68               cost      total cost of batch processing units ($)  ;
  69   
  70  Binary   Variables     y(k,j) ;
  71  Positive Variables     v(j) , b(i) , tl(i) , n(j) ;
  72   
  73  Equations    vol(i,j)   calculate volume of stage j
  74               cycle(i,j) calculate cycle time of product i
  75               time       time constraint
  76               units(j)   calculate number of processing units per stage
  77               lim(j)     limit selection to one number
  78               obj        objective function definition ;
  79   
  80  * convexified formulation of model equations
  81  * volume requirement in stage j
  82  vol(i,j)..   v(j)  =g=  log(s(i,j)) +b(i) ;
  83   
  84  * cycle time for each product i
  85  cycle(i,j).. n(j) + tl(i)  =g=  log(t(i,j)) ;
  86   
  87  * constraint for production time
  88  time..       sum(i , q(i) * exp(tl(i) - b(i))) =l= h ;
  89   
  90  * relating number of units to 0-1 variables
  91  units(j)..   n(j)  =e=       sum(k , coeff(k) * y(k,j)) ;
  92   
  93  * only one choice for parallel units is feasible
  94  lim(j)..     sum(k , y(k,j)) =e= 1 ;
  95   
  96  * defining objective function
  97  obj..        cost  =g=  sum(j ,alpha(j)*(exp(n(j) + beta(j)*v(j))));
  98   
  99  Model   batch   / all / ;
 100   
 101  * bounds section
 102  v.lo(j)   =  log(vlow) ;
 103  v.up(j)   =  log(vupp);
 104  n.up(j)   =  log(3.) ;
 105   
 106  * tight lower bounds are computed below for cycle times and batch sizes
 107  Parameters   tllow(i)       lower bound on tl(i)
 108               tlupp(i)       upper bound on tl(i) ;
 109   
 110  tllow(i)  =  smax(j, t(i,j) / exp(n.up(j))) ;
 111  tlupp(i)  =  smax(j, t(i,j) ) ;
 112   
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:52 Page 4
Optimal Design for Chemical Batch Processing (BATCHDES,SEQ=119)
C o m p i l a t i o n


 113  tl.lo(i)  =  log(tllow(i)) ;
 114  tl.up(i)  =  log(tlupp(i)) ;
 115   
 116  Parameters   blow(i)        lower bound on b(i)
 117               bupp(i)        upper bound on b(i)  ;
 118   
 119  blow(i)  =  q(i) * ( smax(j, t(i,j) / exp(n.up(j))))/ h;
 120  bupp(i)  =  min( q(i) , smin(j , exp(v.up(j))/s(i,j))) ;
 121   
 122  b.lo(i)   =  log(blow(i)) ;
 123  b.up(i)   =  log(bupp(i)) ;
 124   
 125  *  initial point
 126  * binary variables set for 3 units per stage
 127   
 128  y.l(k,j)              = 0.;
 129  y.l('3','mixer')      = 1;
 130  y.l('3','reactor')    = 1;
 131  y.l('3','centrifuge') = 1;
 132  n.l(j)                = sum( k , coeff(k)*  y.l(k,j) ) ;
 133   
 134  * batch sizes are set at the mid-point between bounds
 135  b.l(i)    = (b.up(i) + b.lo(i))/2 ;
 136  v.l(j)    = smax(i ,  log(s(i,j)) + b.l(i)) ;
 137  tl.l(i)   = smax(j ,  log(t(i,j))-n.l(j)) ;
 138   
 139  Option optcr=0;
 140  Solve batch using minlp minimizing cost ;
 141   
 142  * converting variables into original form
 143  actv(j)  = exp(v.l(j)) ;
 144  actb(i)  = exp(b.l(i)) ;
 145  acttl(i) = exp(tl.l(i));
 146  actn(j)  = exp(n.l(j)) ;
 147   
 148  * optimal design
 149  Display actv, actb, acttl, actn ;


COMPILATION TIME     =        0.002 SECONDS      3 MB  24.7.4 r58773 LEX-LEG
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:52 Page 5
Optimal Design for Chemical Batch Processing (BATCHDES,SEQ=119)
Equation Listing    SOLVE batch Using MINLP From line 140


---- vol  =G=  calculate volume of stage j

vol(a,mixer)..  v(mixer) - b(a) =G= 0.693147180559945 ; (LHS = 0.784307958956923)
     
vol(a,reactor)..  v(reactor) - b(a) =G= 1.09861228866811 ; (LHS = 1.18977306706509)
     
vol(a,centrifuge)..  v(centrifuge) - b(a) =G= 1.38629436111989 ; (LHS = 1.38629436111989)
     
REMAINING 3 ENTRIES SKIPPED


---- cycle  =G=  calculate cycle time of product i

cycle(a,mixer)..  tl(a) + n(mixer) =G= 2.07944154167984 ; (LHS = 2.99573227355399)
     
cycle(a,reactor)..  tl(a) + n(reactor) =G= 2.99573227355399 ; (LHS = 2.99573227355399)
     
cycle(a,centrifuge)..  tl(a) + n(centrifuge) =G= 1.38629436111989 ; (LHS = 2.99573227355399)
     
REMAINING 3 ENTRIES SKIPPED


---- time  =L=  time constraint

time..  - (3577.70876399966)*b(a) - (2939.38769133981)*b(b) + (3577.70876399966)*tl(a) + (2939.38769133981)*tl(b) =L= 6000 ; (LHS = 6517.09645533948, INFES = 517.096455339479 ****)
     

---- units  =E=  calculate number of processing units per stage

units(mixer)..  - 0.693147180559945*y(2,mixer) - 1.09861228866811*y(3,mixer) + n(mixer) =E= 0 ; (LHS = 0)
     
units(reactor)..  - 0.693147180559945*y(2,reactor) - 1.09861228866811*y(3,reactor) + n(reactor) =E= 0 ; (LHS = 0)
     
units(centrifuge)..  - 0.693147180559945*y(2,centrifuge) - 1.09861228866811*y(3,centrifuge) + n(centrifuge) =E= 0 ; (LHS = 0)
     

---- lim  =E=  limit selection to one number

lim(mixer)..  y(1,mixer) + y(2,mixer) + y(3,mixer) =E= 1 ; (LHS = 1)
     
lim(reactor)..  y(1,reactor) + y(2,reactor) + y(3,reactor) =E= 1 ; (LHS = 1)
     
lim(centrifuge)..  y(1,centrifuge) + y(2,centrifuge) + y(3,centrifuge) =E= 1 ; (LHS = 1)
     

---- obj  =G=  objective function definition

obj..  - (25141.1498186984)*v(mixer) - (64131.2769053431)*v(reactor) - (49066.7923833869)*v(centrifuge) - (41901.9163644973)*n(mixer) - (106885.461508905)*n(reactor) - (81777.9873056449)*n(centrifuge) + cost =G= 0 ;
     
      (LHS = -230565.365179047, INFES = 230565.365179047 ****)
     
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:52 Page 6
Optimal Design for Chemical Batch Processing (BATCHDES,SEQ=119)
Column Listing      SOLVE batch Using MINLP From line 140


---- y  binary variable denoting stage existence

y(1,mixer)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
        1       lim(mixer)

y(1,reactor)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
        1       lim(reactor)

y(1,centrifuge)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
        1       lim(centrifuge)

REMAINING 6 ENTRIES SKIPPED

---- v  volume of stage j (l)

v(mixer)
                (.LO, .L, .UP, .M = 5.52146091786225, 6.70502272492805, 7.82404601085629, 0)
        1       vol(a,mixer)
        1       vol(b,mixer)
  (-25141.1498) obj

v(reactor)
                (.LO, .L, .UP, .M = 5.52146091786225, 7.11048783303622, 7.82404601085629, 0)
        1       vol(a,reactor)
        1       vol(b,reactor)
  (-64131.2769) obj

v(centrifuge)
                (.LO, .L, .UP, .M = 5.52146091786225, 7.30700912709102, 7.82404601085629, 0)
        1       vol(a,centrifuge)
        1       vol(b,centrifuge)
  (-49066.7924) obj


---- b  batch size of product i (kg)

b(a)
                (.LO, .L, .UP, .M = 5.40367788220586, 5.92071476597113, 6.4377516497364, 0)
       -1       vol(a,mixer)
       -1       vol(a,reactor)
       -1       vol(a,centrifuge)
   (-3577.7088) time

b(b)
                (.LO, .L, .UP, .M = 4.60517018598809, 5.31872836380816, 6.03228654162824, 0)
       -1       vol(b,mixer)
       -1       vol(b,reactor)
       -1       vol(b,centrifuge)
   (-2939.3877) time

GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:52 Page 7
Optimal Design for Chemical Batch Processing (BATCHDES,SEQ=119)
Column Listing      SOLVE batch Using MINLP From line 140


---- tl  cycle time of product i (hrs)

tl(a)
                (.LO, .L, .UP, .M = 1.89711998488588, 1.89711998488588, 2.99573227355399, 0)
        1       cycle(a,mixer)
        1       cycle(a,reactor)
        1       cycle(a,centrifuge)
    (3577.7088) time
        1.8971  (OLD LEVEL ****)

tl(b)
                (.LO, .L, .UP, .M = 1.38629436111989, 1.38629436111989, 2.484906649788, 0)
        1       cycle(b,mixer)
        1       cycle(b,reactor)
        1       cycle(b,centrifuge)
    (2939.3877) time


---- n  number of units in parallel stage j

n(mixer)
                (.LO, .L, .UP, .M = 0, 1.09861228866811, 1.09861228866811, 0)
        1       cycle(a,mixer)
        1       cycle(b,mixer)
        1       units(mixer)
  (-41901.9164) obj

n(reactor)
                (.LO, .L, .UP, .M = 0, 1.09861228866811, 1.09861228866811, 0)
        1       cycle(a,reactor)
        1       cycle(b,reactor)
        1       units(reactor)
 (-106885.4615) obj

n(centrifuge)
                (.LO, .L, .UP, .M = 0, 1.09861228866811, 1.09861228866811, 0)
        1       cycle(a,centrifuge)
        1       cycle(b,centrifuge)
        1       units(centrifuge)
  (-81777.9873) obj


---- cost  total cost of batch processing units ($)

cost
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       obj

GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:52 Page 8
Optimal Design for Chemical Batch Processing (BATCHDES,SEQ=119)
Model Statistics    SOLVE batch Using MINLP From line 140


MODEL STATISTICS

BLOCKS OF EQUATIONS           6     SINGLE EQUATIONS           20
BLOCKS OF VARIABLES           6     SINGLE VARIABLES           20  1 projected
NON ZERO ELEMENTS            53     NON LINEAR N-Z             10
DERIVATIVE POOL              20     CONSTANT POOL              22
CODE LENGTH                  29     DISCRETE VARIABLES          9


GENERATION TIME      =        0.003 SECONDS      4 MB  24.7.4 r58773 LEX-LEG


EXECUTION TIME       =        0.003 SECONDS      4 MB  24.7.4 r58773 LEX-LEG
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:52 Page 9
Optimal Design for Chemical Batch Processing (BATCHDES,SEQ=119)
Solution Report     SOLVE batch Using MINLP From line 140


               S O L V E      S U M M A R Y

     MODEL   batch               OBJECTIVE  cost
     TYPE    MINLP               DIRECTION  MINIMIZE
     SOLVER  CONVERT             FROM LINE  140

**** SOLVER STATUS     1 Normal Completion         
**** MODEL STATUS      14 No Solution Returned     
**** OBJECTIVE VALUE                0.0000

 RESOURCE USAGE, LIMIT          0.000      1000.000
 ITERATION COUNT, LIMIT         0    2000000000
 EVALUATION ERRORS              0             0

Convert 2.0      24.7.4 r58773 Released Sep 19, 2016 LEG x86 64bit/Linux      

--- Using Option File
Reading parameter(s) from "/home/renigijus/gams/opt-mod-lib/gamslib/batchdes/convert.opt"
>>  pyomo batchdes-scalar.py
Finished reading from "/home/renigijus/gams/opt-mod-lib/gamslib/batchdes/convert.opt"
Pyomo     : batchdes-scalar.py


No solution returned
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 10:24:52 Page 10
Optimal Design for Chemical Batch Processing (BATCHDES,SEQ=119)
E x e c u t i o n


----    149 PARAMETER actv  actual volume (l)

mixer       816.497,    reactor    1224.745,    centrifuge 1490.712


----    149 PARAMETER actb  actual batch sizes (kg)

a 372.678,    b 204.124


----    149 PARAMETER acttl  actual cycle times (hrs)

a 6.667,    b 4.000


----    149 PARAMETER actn  actual number of units in parallel

mixer      3.000,    reactor    3.000,    centrifuge 3.000



EXECUTION TIME       =        0.000 SECONDS      3 MB  24.7.4 r58773 LEX-LEG


USER: Remigijus Paulavicius, Single User License     S170731:0859AO-LNX
      Imperial College London, Dept. of Chemical Engineering    DC13449
      License for teaching and research at degree granting institutions


**** FILE SUMMARY

Input      /home/renigijus/gams/opt-mod-lib/gamslib/batchdes/batchdes.gms
Output     /home/renigijus/gams/opt-mod-lib/gamslib/batchdes/batchdes-scalar.py.lst
