GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:43:35 Page 1
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


   1  option LP=convert;
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:43:35 Page 2
Grid/MT Transportation Problem with Single Submit and Collect Loop (TGRIDMIX,SEQ=391)
C o m p i l a t i o n


       
      This problem finds a least cost shipping schedule that meets
      requirements at markets and supplies at factories.
       
      The model demonstrates how to run multiple scenarios with different
      demands in a parallel fashion using the GAMS asynchronous grid and
      threads facility. This model submits and collects jobs in a single
      loop. This allows to control the total number of active jobs during
      the entire execution.
       
       
      Dantzig, G B, Chapter 3.3. In Linear Programming and Extensions.
      Princeton University Press, Princeton, New Jersey, 1963.
       
  19   
  20    Sets
  21         i   canning plants   / seattle, san-diego /
  22         j   markets          / new-york, chicago, topeka / ;
  23   
  24    Parameters
  25   
  26         a(i)  capacity of plant i in cases
  27           /    seattle     350
  28                san-diego   600  /
  29   
  30         b(j)  demand at market j in cases
  31           /    new-york    325
  32                chicago     300
  33                topeka      275  / ;
  34   
  35    Table d(i,j)  distance in thousands of miles
  36                      new-york       chicago      topeka
  37        seattle          2.5           1.7          1.8
  38        san-diego        2.5           1.8          1.4  ;
  39   
  40    Scalar f  freight in dollars per case per thousand miles  /90/ ;
  41   
  42    Parameter c(i,j)  transport cost in thousands of dollars per case ;
  43   
  44              c(i,j) = f * d(i,j) / 1000 ;
  45   
  46    Variables
  47         x(i,j)  shipment quantities in cases
  48         z       total transportation costs in thousands of dollars ;
  49   
  50    Positive Variable x ;
  51   
  52    Equations
  53         cost        define objective function
  54         supply(i)   observe supply limit at plant i
  55         demand(j)   satisfy demand at market j ;
  56   
  57    cost ..        z  =e=  sum((i,j), c(i,j)*x(i,j)) ;
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:43:35 Page 3
Grid/MT Transportation Problem with Single Submit and Collect Loop (TGRIDMIX,SEQ=391)
C o m p i l a t i o n


  58   
  59    supply(i) ..   sum(j, x(i,j))  =l=  a(i) ;
  60   
  61    demand(j) ..   sum(i, x(i,j))  =g=  b(j) ;
  62   
  63    Model transport /all/ ;
  64   
  66   
  67  transport.limcol    = 0;
  68  transport.limrow    = 0;
  69  transport.solprint  = 2;
  71  option threadsAsync=4;
  72   
  73  set  s           scenarios          / 1*10 /
  74       sl          solvelink          / Threads, Grid  /
  75       nexS(s)     next job to submit
  76       actS(s)     active jobs
  77       colS(s)     collected jobs
  78  parameter
  79       slnum(sl)   solvelink number / Threads 6
  80                                      Grid    3 /
  81       dem(s,j)    random demand
  82       h(s)        store the instance handle
  83       repx        solution report
  84       repy        summary report
  85       maxS        maximum number of active jobs /4/
  86       tStart      time stamp;
  87   
  88   
  89  dem(s,j)= b(j)*uniform(.95,1.15); // create some random demands
  90  loop(sl,
  91    tStart = jnow;
  92    repy(sl,s,'solvestat') = na;
  93    repy(sl,s,'modelstat') = na;
  94    actS(s) = no; h(s) = 0; nexS(s) = sameas('1',s);
  95    transport.solvelink = slnum(sl);
  96   
  97    repeat
  98       while (card(actS)<maxS and card(nexS),
  99          loop(nexS(s),
 100             b(j) = dem(s,j)
 101             Solve transport using lp minimizing z;
 102             h(s) = transport.handle;
 103             actS(s) = yes;
 104          );
 105          nexS(s) = nexS(s-1); // advance nexS
 106       );
 107       colS(s) = no;
 108       display$ReadyCollect(h) 'Waiting for next instance to collect';
 109       loop(actS(s)$handlecollect(h(s)),
 110          repx(sl,s,i,j) = x.l(i,j);
 111          repy(sl,s,'solvestat') = transport.solvestat;
 112          repy(sl,s,'modelstat') = transport.modelstat;
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:43:35 Page 4
Grid/MT Transportation Problem with Single Submit and Collect Loop (TGRIDMIX,SEQ=391)
C o m p i l a t i o n


 113          repy(sl,s,'resusd'   ) = transport.resusd;
 114          repy(sl,s,'objval')    = transport.objval;
 115          display$handledelete(h(s)) 'trouble deleting handles' ;
 116          colS(s) = yes; h(s) = 0;
 117       ); actS(colS) = no;
 118    until (card(nexS)=0 and card(actS) = 0) or timeelapsed > 10;  // wait until all models are loaded
 119    repy(sl,'time','elapsed') = (jnow - tStart)*3600*24;
 120    abort$sum(s$(repy(sl,s,'solvestat')=na),1) 'Some jobs did not return';
 121  );
 122  display repx, repy;


COMPILATION TIME     =        0.001 SECONDS      3 MB  24.7.4 r58773 LEX-LEG
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:43:35 Page 5
Grid/MT Transportation Problem with Single Submit and Collect Loop (TGRIDMIX,SEQ=391)
E x e c u t i o n


----    122 PARAMETER repx  solution report

                      ( ALL       0.000 )


----    122 PARAMETER repy  summary report

               solvestat   modelstat     elapsed

Threads.1          1.000      14.000
Threads.2          1.000      14.000
Threads.3          1.000      14.000
Threads.4          1.000      14.000
Threads.5          1.000      14.000
Threads.6          1.000      14.000
Threads.7          1.000      14.000
Threads.8          1.000      14.000
Threads.9          1.000      14.000
Threads.10         1.000      14.000
Threads.time                               0.083
Grid   .1          1.000      14.000
Grid   .2          1.000      14.000
Grid   .3          1.000      14.000
Grid   .4          1.000      14.000
Grid   .5          1.000      14.000
Grid   .6          1.000      14.000
Grid   .7          1.000      14.000
Grid   .8          1.000      14.000
Grid   .9          1.000      14.000
Grid   .10         1.000      14.000
Grid   .time                               0.089



EXECUTION TIME       =        0.172 SECONDS      4 MB  24.7.4 r58773 LEX-LEG


USER: Remigijus Paulavicius, Single User License     S170731:0859AO-LNX
      Imperial College London, Dept. of Chemical Engineering    DC13449
      License for teaching and research at degree granting institutions


**** FILE SUMMARY

Input      /home/renigijus/gams/opt-mod-lib/gamslib/tgridmix/tgridmix.gms
Output     /home/renigijus/gams/opt-mod-lib/gamslib/tgridmix/tgridmix-scalar.mod.lst
