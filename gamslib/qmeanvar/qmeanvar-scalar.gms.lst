GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:23:27 Page 1
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


   1  option MIQCP=convert;
   2  option MIQCP=convert;
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:23:27 Page 2
Financial Optimization: Risk Management using MIQCP (QMEANVAR,SEQ=291)
C o m p i l a t i o n


   4   
       
         Minimum and maximum trade constraints are added to the standard
         mean-variance model. If it is not profitable to trade within these
         ranges, no trade should take place. A turnover constraint is added
         to improve stability of the solution to small changes in data. The
         resulting model is now expressed as a MIQCP and a frontiers is
         computed.
       
      Dahl, H, Meeraus, A, and Zenios, S A, Some Financial Optimization
      Models: Risk Management. In Zenios, S A, Ed, Financial Optimization.
      Cambridge University Press, New York, NY, 1993.
       
  20   
  21  Set  i  securities  / cn, fr, gr, jp, sw, uk, us /;  alias (i,j) ;
  22   
  23  Parameter  mu(i)  expected return of security /
  24   
  25      cn     0.1287
  26      fr     0.1096
  27      gr     0.0501
  28      jp     0.1524
  29      sw     0.0763
  30      uk     0.1854
  31      us     0.0620 /
  32   
  33   
  34  Table  q(i,j)   covariance matrix
  35   
  36              cn      fr      gr      jp      sw      uk      us
  37      cn    42.18
  38      fr    20.18   70.89
  39      gr    10.88   21.58   25.51
  40      jp     5.30   15.41    9.60   22.33
  41      sw    12.32   23.24   22.63   10.32   30.01
  42      uk    23.84   23.80   13.22   10.46   16.36   42.23
  43      us    17.41   12.62    4.70    1.00    7.20    9.90   16.42 ;
  44   
  45  *  we will continue to use only the lower triangle of the q-matrix
  46  *  and adjust the off diagonal entries to give the correct results.
  47   
  48  q(i,j) = 2*q(j,i) ;  q(i,i) = q(i,i)/2;
  49   
  50   
  51  Scalars  tau   bounding parameter on turnover of current holdings  /0.3 /;
  52   
  53  Set pd  portfolio data labels  /
  54            old       current holdings fraction of the portfolio
  55            umin      minimum increase of holdings fraction of security i
  56            umax      maximum increase of holdings fraction of security i
  57            lmin      minimum decrease of holdings fraction of security i
  58            lmax      maximum decrease of holdings fraction of security i  /
  59   
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:23:27 Page 3
Financial Optimization: Risk Management using MIQCP (QMEANVAR,SEQ=291)
C o m p i l a t i o n


  60   
  61  Table    bdata(i,pd)    portfolio data and trading restrictions
  62  *                    - increase -        - decrease -
  63                old    umin    umax        lmin    lmax
  64          cn    0.2    0.03    0.11        0.02    0.30
  65          fr    0.2    0.04    0.10        0.02    0.15
  66          gr    0.0    0.04    0.07        0.04    0.10
  67          jp    0.0    0.03    0.11        0.04    0.10
  68          sw    0.2    0.03    0.20        0.04    0.10
  69          uk    0.2    0.03    0.10        0.04    0.15
  70          us    0.2    0.03    0.10        0.04    0.30    ;
  71   
  72  bdata(i,'lmax') = min(bdata(i,'old'),bdata(i,'lmax')); ! tighten bound
  73   
  74  Abort$(abs(sum(i, bdata(i,'old'))-1) >= 1e5) 'error in bdata', bdata;
  75   
  76  Variables
  77      var       variance of portfolio
  78      ret       return of portfolio
  79      x(i)      fraction of portfolio of current holdings of i
  80      xi(i)     fraction of portfolio increase
  81      xd(i)     fraction of portfolio decrease
  82      y(i)      binary switch for increasing current holdings of i
  83      z(i)      binary switch for decreasing current holdings of i
  84   
  85  Binary Variables  y,z; positive variables x, xi, xd;
  86   
  87   
  88  Equations  budget     budget constraint
  89             turnover   restrict maximum turnover of portfolio
  90             maxinc(i)  bound of maximum lot increase of fraction of i
  91             mininc(i)  bound of minimum lot increase of fraction of i
  92             maxdec(i)  bound of maximum lot decrease of fraction of i
  93             mindec(i)  bound of minimum lot decrease of fraction of i
  94             binsum(i)  restrict use of binary variables
  95             xdef(i)    final portfolio definition
  96             retdef     return definition
  97             vardef     variance definition;
  98   
  99  budget..   sum(i, x(i))  =e=  1 ;
 100   
 101  xdef(i)..  x(i) =e= bdata(i,'old') - xd(i) + xi(i);
 102   
 103  maxinc(i)..  xi(i)  =l=  bdata(i,'umax')*y(i) ;
 104  mininc(i)..  xi(i)  =g=  bdata(i,'umin')*y(i) ;
 105  maxdec(i)..  xd(i)  =l=  bdata(i,'lmax')*z(i) ;
 106  mindec(i)..  xd(i)  =g=  bdata(i,'lmin')*z(i) ;
 107  binsum(i).. y(i) + z(i) =l= 1;
 108   
 109  turnover.. sum(i, xi(i)) =l=  tau ;
 110   
 111  retdef..  ret =e= sum(i, mu(i)*x(i));
 112   
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:23:27 Page 4
Financial Optimization: Risk Management using MIQCP (QMEANVAR,SEQ=291)
C o m p i l a t i o n


 113  vardef..  var =e= sum((i,j), x(i)*q(i,j)*x(j));
 114   
 115   
 116   
 117  Models
 118  maxret / budget, xdef, turnover, maxinc, mininc, maxdec, mindec, binsum, retdef /
 119  minvar / budget, xdef, turnover, maxinc, mininc, maxdec, mindec, binsum, retdef, vardef /;
 120   
 121  Set  p       efficient frontier points     / oldr, minvar, p1*p4, maxret, oldv /
 122       pp(p)   efficient frontier points     /         p1*p4                     /
 123   
 124  Scalars     rmin     minimum variance
 125              rmax     maximum variance ;
 126   
 127  Parameter Report(p,i,*)  Portfolio Details at different points
 128            xres(*,p)      Summary report at different points;
 129   
 130  Option limcol=0, limrow=0, solprint=off, optcr=0;
 131   
 132  Loop(p('maxret'),
 133     Solve maxret max ret using miqcp ; rmax = ret.l;
 134     xres(i,p)         = x.l(i);
 135     report(p,i,'inc') = xi.l(i);
 136     report(p,i,'dec') = xd.l(i) );
 137   
 138  xres(i,'oldr')  = bdata(i,'old');
 139  xres(i,'oldv')  = bdata(i,'old');
 140   
 141  Loop(p('minvar'),
 142     Solve minvar min var using miqcp ;  rmin = ret.l;
 143     xres(i,p)         = x.l(i);
 144     report(p,i,'inc') = xi.l(i);
 145     report(p,i,'dec') = xd.l(i) );
 146   
 147  Loop(p(pp),
 148     ret.fx = rmin + (rmax-rmin)/(card(pp)+1)*ord(pp) ;
 149     Solve minvar min var using miqcp ;
 150     xres(i,p)         = x.l(i);
 151     report(p,i,'inc') = xi.l(i);
 152     report(p,i,'dec') = xd.l(i) );
 153   
 154  xres('mean',p) = sum(i, mu(i)*xres(i,p));
 155  xres('var' ,p) = sum((i,j), xres(i,p)*q(i,j)*xres(j,p));
 156  Display xres, report;
 157   
EXIT /home/renigijus/gams/opt-mod-lib/gamslib/qmeanvar/qmeanvar.gms
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:23:27 Page 5
Financial Optimization: Risk Management using MIQCP (QMEANVAR,SEQ=291)
Include File Summary


   SEQ   GLOBAL TYPE      PARENT   LOCAL  FILENAME

     1        1 INPUT          0       0  /home/renigijus/gams/opt-mod-lib/gamslib/qmeanvar/qmeanvar.gms
     2      158 EXIT           1     158  /home/renigijus/gams/opt-mod-lib/gamslib/qmeanvar/qmeanvar.gms


COMPILATION TIME     =        0.001 SECONDS      3 MB  24.7.4 r58773 LEX-LEG
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:23:27 Page 6
Financial Optimization: Risk Management using MIQCP (QMEANVAR,SEQ=291)
Model Statistics    SOLVE maxret Using MIQCP From line 133


MODEL STATISTICS

BLOCKS OF EQUATIONS           9     SINGLE EQUATIONS           45
BLOCKS OF VARIABLES           6     SINGLE VARIABLES           36
NON ZERO ELEMENTS           111     NON LINEAR N-Z              0
DERIVATIVE POOL              20     CONSTANT POOL              16
CODE LENGTH                   0     DISCRETE VARIABLES         14


GENERATION TIME      =        0.003 SECONDS      4 MB  24.7.4 r58773 LEX-LEG


EXECUTION TIME       =        0.003 SECONDS      4 MB  24.7.4 r58773 LEX-LEG
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:23:27 Page 7
Financial Optimization: Risk Management using MIQCP (QMEANVAR,SEQ=291)
Solution Report     SOLVE maxret Using MIQCP From line 133


               S O L V E      S U M M A R Y

     MODEL   maxret              OBJECTIVE  ret
     TYPE    MIQCP               DIRECTION  MAXIMIZE
     SOLVER  CONVERT             FROM LINE  133

**** SOLVER STATUS     1 Normal Completion         
**** MODEL STATUS      14 No Solution Returned     
**** OBJECTIVE VALUE                0.0000

 RESOURCE USAGE, LIMIT          0.000      1000.000
 ITERATION COUNT, LIMIT         0    2000000000
 EVALUATION ERRORS              0             0

Convert 2.0      24.7.4 r58773 Released Sep 19, 2016 LEG x86 64bit/Linux      

--- Using Option File
Reading parameter(s) from "/home/renigijus/gams/opt-mod-lib/gamslib/qmeanvar/convert.opt"
>>  gams qmeanvar-scalar.gms
Finished reading from "/home/renigijus/gams/opt-mod-lib/gamslib/qmeanvar/convert.opt"
Gams      : qmeanvar-scalar.gms


No solution returned
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:23:27 Page 8
Financial Optimization: Risk Management using MIQCP (QMEANVAR,SEQ=291)
Model Statistics    SOLVE minvar Using MIQCP From line 142


MODEL STATISTICS

BLOCKS OF EQUATIONS          10     SINGLE EQUATIONS           46
BLOCKS OF VARIABLES           7     SINGLE VARIABLES           37
NON ZERO ELEMENTS           119     NON LINEAR N-Z              7
DERIVATIVE POOL              20     CONSTANT POOL              43
CODE LENGTH                 115     DISCRETE VARIABLES         14


GENERATION TIME      =        0.002 SECONDS      3 MB  24.7.4 r58773 LEX-LEG


EXECUTION TIME       =        0.002 SECONDS      3 MB  24.7.4 r58773 LEX-LEG
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:23:27 Page 9
Financial Optimization: Risk Management using MIQCP (QMEANVAR,SEQ=291)
Solution Report     SOLVE minvar Using MIQCP From line 142


               S O L V E      S U M M A R Y

     MODEL   minvar              OBJECTIVE  var
     TYPE    MIQCP               DIRECTION  MINIMIZE
     SOLVER  CONVERT             FROM LINE  142

**** SOLVER STATUS     1 Normal Completion         
**** MODEL STATUS      14 No Solution Returned     
**** OBJECTIVE VALUE                0.0000

 RESOURCE USAGE, LIMIT          0.000      1000.000
 ITERATION COUNT, LIMIT         0    2000000000
 EVALUATION ERRORS              0             0

Convert 2.0      24.7.4 r58773 Released Sep 19, 2016 LEG x86 64bit/Linux      

--- Using Option File
Reading parameter(s) from "/home/renigijus/gams/opt-mod-lib/gamslib/qmeanvar/convert.opt"
>>  gams qmeanvar-scalar.gms
Finished reading from "/home/renigijus/gams/opt-mod-lib/gamslib/qmeanvar/convert.opt"
Gams      : qmeanvar-scalar.gms


No solution returned
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:23:27 Page 10
Financial Optimization: Risk Management using MIQCP (QMEANVAR,SEQ=291)
Model Statistics    SOLVE minvar Using MIQCP From line 149


LOOPS                                   pp   p1


MODEL STATISTICS

BLOCKS OF EQUATIONS          10     SINGLE EQUATIONS           46
BLOCKS OF VARIABLES           7     SINGLE VARIABLES           37
NON ZERO ELEMENTS           119     NON LINEAR N-Z              7
DERIVATIVE POOL              20     CONSTANT POOL              43
CODE LENGTH                 115     DISCRETE VARIABLES         14


GENERATION TIME      =        0.003 SECONDS      3 MB  24.7.4 r58773 LEX-LEG


EXECUTION TIME       =        0.003 SECONDS      3 MB  24.7.4 r58773 LEX-LEG
               L O O P S                 pp p1

GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:23:27 Page 11
Financial Optimization: Risk Management using MIQCP (QMEANVAR,SEQ=291)
Solution Report     SOLVE minvar Using MIQCP From line 149


               S O L V E      S U M M A R Y

     MODEL   minvar              OBJECTIVE  var
     TYPE    MIQCP               DIRECTION  MINIMIZE
     SOLVER  CONVERT             FROM LINE  149

**** SOLVER STATUS     1 Normal Completion         
**** MODEL STATUS      14 No Solution Returned     
**** OBJECTIVE VALUE                0.0000

 RESOURCE USAGE, LIMIT          0.000      1000.000
 ITERATION COUNT, LIMIT         0    2000000000
 EVALUATION ERRORS              0             0

Convert 2.0      24.7.4 r58773 Released Sep 19, 2016 LEG x86 64bit/Linux      

--- Using Option File
Reading parameter(s) from "/home/renigijus/gams/opt-mod-lib/gamslib/qmeanvar/convert.opt"
>>  gams qmeanvar-scalar.gms
Finished reading from "/home/renigijus/gams/opt-mod-lib/gamslib/qmeanvar/convert.opt"
Gams      : qmeanvar-scalar.gms


No solution returned
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:23:27 Page 12
Financial Optimization: Risk Management using MIQCP (QMEANVAR,SEQ=291)
Model Statistics    SOLVE minvar Using MIQCP From line 149


LOOPS                                   pp   p2


MODEL STATISTICS

BLOCKS OF EQUATIONS          10     SINGLE EQUATIONS           46
BLOCKS OF VARIABLES           7     SINGLE VARIABLES           37
NON ZERO ELEMENTS           119     NON LINEAR N-Z              7
DERIVATIVE POOL              20     CONSTANT POOL              43
CODE LENGTH                 115     DISCRETE VARIABLES         14


GENERATION TIME      =        0.002 SECONDS      3 MB  24.7.4 r58773 LEX-LEG


EXECUTION TIME       =        0.003 SECONDS      3 MB  24.7.4 r58773 LEX-LEG
               L O O P S                 pp p2

GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:23:27 Page 13
Financial Optimization: Risk Management using MIQCP (QMEANVAR,SEQ=291)
Solution Report     SOLVE minvar Using MIQCP From line 149


               S O L V E      S U M M A R Y

     MODEL   minvar              OBJECTIVE  var
     TYPE    MIQCP               DIRECTION  MINIMIZE
     SOLVER  CONVERT             FROM LINE  149

**** SOLVER STATUS     1 Normal Completion         
**** MODEL STATUS      14 No Solution Returned     
**** OBJECTIVE VALUE                0.0000

 RESOURCE USAGE, LIMIT          0.000      1000.000
 ITERATION COUNT, LIMIT         0    2000000000
 EVALUATION ERRORS              0             0

Convert 2.0      24.7.4 r58773 Released Sep 19, 2016 LEG x86 64bit/Linux      

--- Using Option File
Reading parameter(s) from "/home/renigijus/gams/opt-mod-lib/gamslib/qmeanvar/convert.opt"
>>  gams qmeanvar-scalar.gms
Finished reading from "/home/renigijus/gams/opt-mod-lib/gamslib/qmeanvar/convert.opt"
Gams      : qmeanvar-scalar.gms


No solution returned
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:23:27 Page 14
Financial Optimization: Risk Management using MIQCP (QMEANVAR,SEQ=291)
Model Statistics    SOLVE minvar Using MIQCP From line 149


LOOPS                                   pp   p3


MODEL STATISTICS

BLOCKS OF EQUATIONS          10     SINGLE EQUATIONS           46
BLOCKS OF VARIABLES           7     SINGLE VARIABLES           37
NON ZERO ELEMENTS           119     NON LINEAR N-Z              7
DERIVATIVE POOL              20     CONSTANT POOL              43
CODE LENGTH                 115     DISCRETE VARIABLES         14


GENERATION TIME      =        0.002 SECONDS      3 MB  24.7.4 r58773 LEX-LEG


EXECUTION TIME       =        0.002 SECONDS      3 MB  24.7.4 r58773 LEX-LEG
               L O O P S                 pp p3

GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:23:27 Page 15
Financial Optimization: Risk Management using MIQCP (QMEANVAR,SEQ=291)
Solution Report     SOLVE minvar Using MIQCP From line 149


               S O L V E      S U M M A R Y

     MODEL   minvar              OBJECTIVE  var
     TYPE    MIQCP               DIRECTION  MINIMIZE
     SOLVER  CONVERT             FROM LINE  149

**** SOLVER STATUS     1 Normal Completion         
**** MODEL STATUS      14 No Solution Returned     
**** OBJECTIVE VALUE                0.0000

 RESOURCE USAGE, LIMIT          0.000      1000.000
 ITERATION COUNT, LIMIT         0    2000000000
 EVALUATION ERRORS              0             0

Convert 2.0      24.7.4 r58773 Released Sep 19, 2016 LEG x86 64bit/Linux      

--- Using Option File
Reading parameter(s) from "/home/renigijus/gams/opt-mod-lib/gamslib/qmeanvar/convert.opt"
>>  gams qmeanvar-scalar.gms
Finished reading from "/home/renigijus/gams/opt-mod-lib/gamslib/qmeanvar/convert.opt"
Gams      : qmeanvar-scalar.gms


No solution returned
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:23:27 Page 16
Financial Optimization: Risk Management using MIQCP (QMEANVAR,SEQ=291)
Model Statistics    SOLVE minvar Using MIQCP From line 149


LOOPS                                   pp   p4


MODEL STATISTICS

BLOCKS OF EQUATIONS          10     SINGLE EQUATIONS           46
BLOCKS OF VARIABLES           7     SINGLE VARIABLES           37
NON ZERO ELEMENTS           119     NON LINEAR N-Z              7
DERIVATIVE POOL              20     CONSTANT POOL              43
CODE LENGTH                 115     DISCRETE VARIABLES         14


GENERATION TIME      =        0.002 SECONDS      3 MB  24.7.4 r58773 LEX-LEG


EXECUTION TIME       =        0.002 SECONDS      3 MB  24.7.4 r58773 LEX-LEG
               L O O P S                 pp p4

GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:23:27 Page 17
Financial Optimization: Risk Management using MIQCP (QMEANVAR,SEQ=291)
Solution Report     SOLVE minvar Using MIQCP From line 149


               S O L V E      S U M M A R Y

     MODEL   minvar              OBJECTIVE  var
     TYPE    MIQCP               DIRECTION  MINIMIZE
     SOLVER  CONVERT             FROM LINE  149

**** SOLVER STATUS     1 Normal Completion         
**** MODEL STATUS      14 No Solution Returned     
**** OBJECTIVE VALUE                0.0000

 RESOURCE USAGE, LIMIT          0.000      1000.000
 ITERATION COUNT, LIMIT         0    2000000000
 EVALUATION ERRORS              0             0

Convert 2.0      24.7.4 r58773 Released Sep 19, 2016 LEG x86 64bit/Linux      

--- Using Option File
Reading parameter(s) from "/home/renigijus/gams/opt-mod-lib/gamslib/qmeanvar/convert.opt"
>>  gams qmeanvar-scalar.gms
Finished reading from "/home/renigijus/gams/opt-mod-lib/gamslib/qmeanvar/convert.opt"
Gams      : qmeanvar-scalar.gms


No solution returned
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:23:27 Page 18
Financial Optimization: Risk Management using MIQCP (QMEANVAR,SEQ=291)
E x e c u t i o n


----    156 PARAMETER xres  Summary report at different points

            oldr        oldv

cn         0.200       0.200
fr         0.200       0.200
sw         0.200       0.200
uk         0.200       0.200
us         0.200       0.200
mean       0.112       0.112
var       21.419      21.419


----    156 PARAMETER Report  Portfolio Details at different points

                      ( ALL       0.000 )



EXECUTION TIME       =        0.000 SECONDS      3 MB  24.7.4 r58773 LEX-LEG


USER: Remigijus Paulavicius, Single User License     S170731:0859AO-LNX
      Imperial College London, Dept. of Chemical Engineering    DC13449
      License for teaching and research at degree granting institutions


**** FILE SUMMARY

Input      /home/renigijus/gams/opt-mod-lib/gamslib/qmeanvar/qmeanvar.gms
Output     /home/renigijus/gams/opt-mod-lib/gamslib/qmeanvar/qmeanvar-scalar.gms.lst
