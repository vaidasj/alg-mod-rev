GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:23:26 Page 1
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


   1  option MIQCP=convert;
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:23:26 Page 2
Financial Optimization: Risk Management using MIQCP (QMEANVAR,SEQ=291)
C o m p i l a t i o n


   3   
       
         Minimum and maximum trade constraints are added to the standard
         mean-variance model. If it is not profitable to trade within these
         ranges, no trade should take place. A turnover constraint is added
         to improve stability of the solution to small changes in data. The
         resulting model is now expressed as a MIQCP and a frontiers is
         computed.
       
      Dahl, H, Meeraus, A, and Zenios, S A, Some Financial Optimization
      Models: Risk Management. In Zenios, S A, Ed, Financial Optimization.
      Cambridge University Press, New York, NY, 1993.
       
  19   
  20  Set  i  securities  / cn, fr, gr, jp, sw, uk, us /;  alias (i,j) ;
  21   
  22  Parameter  mu(i)  expected return of security /
  23   
  24      cn     0.1287
  25      fr     0.1096
  26      gr     0.0501
  27      jp     0.1524
  28      sw     0.0763
  29      uk     0.1854
  30      us     0.0620 /
  31   
  32   
  33  Table  q(i,j)   covariance matrix
  34   
  35              cn      fr      gr      jp      sw      uk      us
  36      cn    42.18
  37      fr    20.18   70.89
  38      gr    10.88   21.58   25.51
  39      jp     5.30   15.41    9.60   22.33
  40      sw    12.32   23.24   22.63   10.32   30.01
  41      uk    23.84   23.80   13.22   10.46   16.36   42.23
  42      us    17.41   12.62    4.70    1.00    7.20    9.90   16.42 ;
  43   
  44  *  we will continue to use only the lower triangle of the q-matrix
  45  *  and adjust the off diagonal entries to give the correct results.
  46   
  47  q(i,j) = 2*q(j,i) ;  q(i,i) = q(i,i)/2;
  48   
  49   
  50  Scalars  tau   bounding parameter on turnover of current holdings  /0.3 /;
  51   
  52  Set pd  portfolio data labels  /
  53            old       current holdings fraction of the portfolio
  54            umin      minimum increase of holdings fraction of security i
  55            umax      maximum increase of holdings fraction of security i
  56            lmin      minimum decrease of holdings fraction of security i
  57            lmax      maximum decrease of holdings fraction of security i  /
  58   
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:23:26 Page 3
Financial Optimization: Risk Management using MIQCP (QMEANVAR,SEQ=291)
C o m p i l a t i o n


  59   
  60  Table    bdata(i,pd)    portfolio data and trading restrictions
  61  *                    - increase -        - decrease -
  62                old    umin    umax        lmin    lmax
  63          cn    0.2    0.03    0.11        0.02    0.30
  64          fr    0.2    0.04    0.10        0.02    0.15
  65          gr    0.0    0.04    0.07        0.04    0.10
  66          jp    0.0    0.03    0.11        0.04    0.10
  67          sw    0.2    0.03    0.20        0.04    0.10
  68          uk    0.2    0.03    0.10        0.04    0.15
  69          us    0.2    0.03    0.10        0.04    0.30    ;
  70   
  71  bdata(i,'lmax') = min(bdata(i,'old'),bdata(i,'lmax')); ! tighten bound
  72   
  73  Abort$(abs(sum(i, bdata(i,'old'))-1) >= 1e5) 'error in bdata', bdata;
  74   
  75  Variables
  76      var       variance of portfolio
  77      ret       return of portfolio
  78      x(i)      fraction of portfolio of current holdings of i
  79      xi(i)     fraction of portfolio increase
  80      xd(i)     fraction of portfolio decrease
  81      y(i)      binary switch for increasing current holdings of i
  82      z(i)      binary switch for decreasing current holdings of i
  83   
  84  Binary Variables  y,z; positive variables x, xi, xd;
  85   
  86   
  87  Equations  budget     budget constraint
  88             turnover   restrict maximum turnover of portfolio
  89             maxinc(i)  bound of maximum lot increase of fraction of i
  90             mininc(i)  bound of minimum lot increase of fraction of i
  91             maxdec(i)  bound of maximum lot decrease of fraction of i
  92             mindec(i)  bound of minimum lot decrease of fraction of i
  93             binsum(i)  restrict use of binary variables
  94             xdef(i)    final portfolio definition
  95             retdef     return definition
  96             vardef     variance definition;
  97   
  98  budget..   sum(i, x(i))  =e=  1 ;
  99   
 100  xdef(i)..  x(i) =e= bdata(i,'old') - xd(i) + xi(i);
 101   
 102  maxinc(i)..  xi(i)  =l=  bdata(i,'umax')*y(i) ;
 103  mininc(i)..  xi(i)  =g=  bdata(i,'umin')*y(i) ;
 104  maxdec(i)..  xd(i)  =l=  bdata(i,'lmax')*z(i) ;
 105  mindec(i)..  xd(i)  =g=  bdata(i,'lmin')*z(i) ;
 106  binsum(i).. y(i) + z(i) =l= 1;
 107   
 108  turnover.. sum(i, xi(i)) =l=  tau ;
 109   
 110  retdef..  ret =e= sum(i, mu(i)*x(i));
 111   
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:23:26 Page 4
Financial Optimization: Risk Management using MIQCP (QMEANVAR,SEQ=291)
C o m p i l a t i o n


 112  vardef..  var =e= sum((i,j), x(i)*q(i,j)*x(j));
 113   
 114   
 115   
 116  Models
 117  maxret / budget, xdef, turnover, maxinc, mininc, maxdec, mindec, binsum, retdef /
 118  minvar / budget, xdef, turnover, maxinc, mininc, maxdec, mindec, binsum, retdef, vardef /;
 119   
 120  Set  p       efficient frontier points     / oldr, minvar, p1*p4, maxret, oldv /
 121       pp(p)   efficient frontier points     /         p1*p4                     /
 122   
 123  Scalars     rmin     minimum variance
 124              rmax     maximum variance ;
 125   
 126  Parameter Report(p,i,*)  Portfolio Details at different points
 127            xres(*,p)      Summary report at different points;
 128   
 129  Option limcol=0, limrow=0, solprint=off, optcr=0;
 130   
 131  Loop(p('maxret'),
 132     Solve maxret max ret using miqcp ; rmax = ret.l;
 133     xres(i,p)         = x.l(i);
 134     report(p,i,'inc') = xi.l(i);
 135     report(p,i,'dec') = xd.l(i) );
 136   
 137  xres(i,'oldr')  = bdata(i,'old');
 138  xres(i,'oldv')  = bdata(i,'old');
 139   
 140  Loop(p('minvar'),
 141     Solve minvar min var using miqcp ;  rmin = ret.l;
 142     xres(i,p)         = x.l(i);
 143     report(p,i,'inc') = xi.l(i);
 144     report(p,i,'dec') = xd.l(i) );
 145   
 146  Loop(p(pp),
 147     ret.fx = rmin + (rmax-rmin)/(card(pp)+1)*ord(pp) ;
 148     Solve minvar min var using miqcp ;
 149     xres(i,p)         = x.l(i);
 150     report(p,i,'inc') = xi.l(i);
 151     report(p,i,'dec') = xd.l(i) );
 152   
 153  xres('mean',p) = sum(i, mu(i)*xres(i,p));
 154  xres('var' ,p) = sum((i,j), xres(i,p)*q(i,j)*xres(j,p));
 155  Display xres, report;
 156   
EXIT /home/renigijus/gams/opt-mod-lib/gamslib/qmeanvar/qmeanvar.gms
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:23:26 Page 5
Financial Optimization: Risk Management using MIQCP (QMEANVAR,SEQ=291)
Include File Summary


   SEQ   GLOBAL TYPE      PARENT   LOCAL  FILENAME

     1        1 INPUT          0       0  /home/renigijus/gams/opt-mod-lib/gamslib/qmeanvar/qmeanvar.gms
     2      157 EXIT           1     157  /home/renigijus/gams/opt-mod-lib/gamslib/qmeanvar/qmeanvar.gms


COMPILATION TIME     =        0.001 SECONDS      3 MB  24.7.4 r58773 LEX-LEG
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:23:26 Page 6
Financial Optimization: Risk Management using MIQCP (QMEANVAR,SEQ=291)
Model Statistics    SOLVE maxret Using MIQCP From line 132


MODEL STATISTICS

BLOCKS OF EQUATIONS           9     SINGLE EQUATIONS           45
BLOCKS OF VARIABLES           6     SINGLE VARIABLES           36
NON ZERO ELEMENTS           111     NON LINEAR N-Z              0
DERIVATIVE POOL              20     CONSTANT POOL              16
CODE LENGTH                   0     DISCRETE VARIABLES         14


GENERATION TIME      =        0.002 SECONDS      4 MB  24.7.4 r58773 LEX-LEG


EXECUTION TIME       =        0.002 SECONDS      4 MB  24.7.4 r58773 LEX-LEG
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:23:26 Page 7
Financial Optimization: Risk Management using MIQCP (QMEANVAR,SEQ=291)
Solution Report     SOLVE maxret Using MIQCP From line 132


               S O L V E      S U M M A R Y

     MODEL   maxret              OBJECTIVE  ret
     TYPE    MIQCP               DIRECTION  MAXIMIZE
     SOLVER  CONVERT             FROM LINE  132

**** SOLVER STATUS     1 Normal Completion         
**** MODEL STATUS      14 No Solution Returned     
**** OBJECTIVE VALUE                0.0000

 RESOURCE USAGE, LIMIT          0.000      1000.000
 ITERATION COUNT, LIMIT         0    2000000000
 EVALUATION ERRORS              0             0

Convert 2.0      24.7.4 r58773 Released Sep 19, 2016 LEG x86 64bit/Linux      

--- Using Option File
Reading parameter(s) from "/home/renigijus/gams/opt-mod-lib/gamslib/qmeanvar/convert.opt"
>>  ampl qmeanvar-scalar.mod
Finished reading from "/home/renigijus/gams/opt-mod-lib/gamslib/qmeanvar/convert.opt"
Ampl      : qmeanvar-scalar.mod


No solution returned
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:23:26 Page 8
Financial Optimization: Risk Management using MIQCP (QMEANVAR,SEQ=291)
Model Statistics    SOLVE minvar Using MIQCP From line 141


MODEL STATISTICS

BLOCKS OF EQUATIONS          10     SINGLE EQUATIONS           46
BLOCKS OF VARIABLES           7     SINGLE VARIABLES           37
NON ZERO ELEMENTS           119     NON LINEAR N-Z              7
DERIVATIVE POOL              20     CONSTANT POOL              43
CODE LENGTH                 115     DISCRETE VARIABLES         14


GENERATION TIME      =        0.002 SECONDS      3 MB  24.7.4 r58773 LEX-LEG


EXECUTION TIME       =        0.002 SECONDS      3 MB  24.7.4 r58773 LEX-LEG
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:23:26 Page 9
Financial Optimization: Risk Management using MIQCP (QMEANVAR,SEQ=291)
Solution Report     SOLVE minvar Using MIQCP From line 141


               S O L V E      S U M M A R Y

     MODEL   minvar              OBJECTIVE  var
     TYPE    MIQCP               DIRECTION  MINIMIZE
     SOLVER  CONVERT             FROM LINE  141

**** SOLVER STATUS     1 Normal Completion         
**** MODEL STATUS      14 No Solution Returned     
**** OBJECTIVE VALUE                0.0000

 RESOURCE USAGE, LIMIT          0.000      1000.000
 ITERATION COUNT, LIMIT         0    2000000000
 EVALUATION ERRORS              0             0

Convert 2.0      24.7.4 r58773 Released Sep 19, 2016 LEG x86 64bit/Linux      

--- Using Option File
Reading parameter(s) from "/home/renigijus/gams/opt-mod-lib/gamslib/qmeanvar/convert.opt"
>>  ampl qmeanvar-scalar.mod
Finished reading from "/home/renigijus/gams/opt-mod-lib/gamslib/qmeanvar/convert.opt"
Ampl      : qmeanvar-scalar.mod


No solution returned
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:23:26 Page 10
Financial Optimization: Risk Management using MIQCP (QMEANVAR,SEQ=291)
Model Statistics    SOLVE minvar Using MIQCP From line 148


LOOPS                                   pp   p1


MODEL STATISTICS

BLOCKS OF EQUATIONS          10     SINGLE EQUATIONS           46
BLOCKS OF VARIABLES           7     SINGLE VARIABLES           37
NON ZERO ELEMENTS           119     NON LINEAR N-Z              7
DERIVATIVE POOL              20     CONSTANT POOL              43
CODE LENGTH                 115     DISCRETE VARIABLES         14


GENERATION TIME      =        0.002 SECONDS      3 MB  24.7.4 r58773 LEX-LEG


EXECUTION TIME       =        0.003 SECONDS      3 MB  24.7.4 r58773 LEX-LEG
               L O O P S                 pp p1

GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:23:26 Page 11
Financial Optimization: Risk Management using MIQCP (QMEANVAR,SEQ=291)
Solution Report     SOLVE minvar Using MIQCP From line 148


               S O L V E      S U M M A R Y

     MODEL   minvar              OBJECTIVE  var
     TYPE    MIQCP               DIRECTION  MINIMIZE
     SOLVER  CONVERT             FROM LINE  148

**** SOLVER STATUS     1 Normal Completion         
**** MODEL STATUS      14 No Solution Returned     
**** OBJECTIVE VALUE                0.0000

 RESOURCE USAGE, LIMIT          0.000      1000.000
 ITERATION COUNT, LIMIT         0    2000000000
 EVALUATION ERRORS              0             0

Convert 2.0      24.7.4 r58773 Released Sep 19, 2016 LEG x86 64bit/Linux      

--- Using Option File
Reading parameter(s) from "/home/renigijus/gams/opt-mod-lib/gamslib/qmeanvar/convert.opt"
>>  ampl qmeanvar-scalar.mod
Finished reading from "/home/renigijus/gams/opt-mod-lib/gamslib/qmeanvar/convert.opt"
Ampl      : qmeanvar-scalar.mod


No solution returned
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:23:26 Page 12
Financial Optimization: Risk Management using MIQCP (QMEANVAR,SEQ=291)
Model Statistics    SOLVE minvar Using MIQCP From line 148


LOOPS                                   pp   p2


MODEL STATISTICS

BLOCKS OF EQUATIONS          10     SINGLE EQUATIONS           46
BLOCKS OF VARIABLES           7     SINGLE VARIABLES           37
NON ZERO ELEMENTS           119     NON LINEAR N-Z              7
DERIVATIVE POOL              20     CONSTANT POOL              43
CODE LENGTH                 115     DISCRETE VARIABLES         14


GENERATION TIME      =        0.003 SECONDS      3 MB  24.7.4 r58773 LEX-LEG


EXECUTION TIME       =        0.003 SECONDS      3 MB  24.7.4 r58773 LEX-LEG
               L O O P S                 pp p2

GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:23:26 Page 13
Financial Optimization: Risk Management using MIQCP (QMEANVAR,SEQ=291)
Solution Report     SOLVE minvar Using MIQCP From line 148


               S O L V E      S U M M A R Y

     MODEL   minvar              OBJECTIVE  var
     TYPE    MIQCP               DIRECTION  MINIMIZE
     SOLVER  CONVERT             FROM LINE  148

**** SOLVER STATUS     1 Normal Completion         
**** MODEL STATUS      14 No Solution Returned     
**** OBJECTIVE VALUE                0.0000

 RESOURCE USAGE, LIMIT          0.000      1000.000
 ITERATION COUNT, LIMIT         0    2000000000
 EVALUATION ERRORS              0             0

Convert 2.0      24.7.4 r58773 Released Sep 19, 2016 LEG x86 64bit/Linux      

--- Using Option File
Reading parameter(s) from "/home/renigijus/gams/opt-mod-lib/gamslib/qmeanvar/convert.opt"
>>  ampl qmeanvar-scalar.mod
Finished reading from "/home/renigijus/gams/opt-mod-lib/gamslib/qmeanvar/convert.opt"
Ampl      : qmeanvar-scalar.mod


No solution returned
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:23:26 Page 14
Financial Optimization: Risk Management using MIQCP (QMEANVAR,SEQ=291)
Model Statistics    SOLVE minvar Using MIQCP From line 148


LOOPS                                   pp   p3


MODEL STATISTICS

BLOCKS OF EQUATIONS          10     SINGLE EQUATIONS           46
BLOCKS OF VARIABLES           7     SINGLE VARIABLES           37
NON ZERO ELEMENTS           119     NON LINEAR N-Z              7
DERIVATIVE POOL              20     CONSTANT POOL              43
CODE LENGTH                 115     DISCRETE VARIABLES         14


GENERATION TIME      =        0.002 SECONDS      3 MB  24.7.4 r58773 LEX-LEG


EXECUTION TIME       =        0.003 SECONDS      3 MB  24.7.4 r58773 LEX-LEG
               L O O P S                 pp p3

GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:23:26 Page 15
Financial Optimization: Risk Management using MIQCP (QMEANVAR,SEQ=291)
Solution Report     SOLVE minvar Using MIQCP From line 148


               S O L V E      S U M M A R Y

     MODEL   minvar              OBJECTIVE  var
     TYPE    MIQCP               DIRECTION  MINIMIZE
     SOLVER  CONVERT             FROM LINE  148

**** SOLVER STATUS     1 Normal Completion         
**** MODEL STATUS      14 No Solution Returned     
**** OBJECTIVE VALUE                0.0000

 RESOURCE USAGE, LIMIT          0.000      1000.000
 ITERATION COUNT, LIMIT         0    2000000000
 EVALUATION ERRORS              0             0

Convert 2.0      24.7.4 r58773 Released Sep 19, 2016 LEG x86 64bit/Linux      

--- Using Option File
Reading parameter(s) from "/home/renigijus/gams/opt-mod-lib/gamslib/qmeanvar/convert.opt"
>>  ampl qmeanvar-scalar.mod
Finished reading from "/home/renigijus/gams/opt-mod-lib/gamslib/qmeanvar/convert.opt"
Ampl      : qmeanvar-scalar.mod


No solution returned
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:23:26 Page 16
Financial Optimization: Risk Management using MIQCP (QMEANVAR,SEQ=291)
Model Statistics    SOLVE minvar Using MIQCP From line 148


LOOPS                                   pp   p4


MODEL STATISTICS

BLOCKS OF EQUATIONS          10     SINGLE EQUATIONS           46
BLOCKS OF VARIABLES           7     SINGLE VARIABLES           37
NON ZERO ELEMENTS           119     NON LINEAR N-Z              7
DERIVATIVE POOL              20     CONSTANT POOL              43
CODE LENGTH                 115     DISCRETE VARIABLES         14


GENERATION TIME      =        0.001 SECONDS      3 MB  24.7.4 r58773 LEX-LEG


EXECUTION TIME       =        0.002 SECONDS      3 MB  24.7.4 r58773 LEX-LEG
               L O O P S                 pp p4

GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:23:26 Page 17
Financial Optimization: Risk Management using MIQCP (QMEANVAR,SEQ=291)
Solution Report     SOLVE minvar Using MIQCP From line 148


               S O L V E      S U M M A R Y

     MODEL   minvar              OBJECTIVE  var
     TYPE    MIQCP               DIRECTION  MINIMIZE
     SOLVER  CONVERT             FROM LINE  148

**** SOLVER STATUS     1 Normal Completion         
**** MODEL STATUS      14 No Solution Returned     
**** OBJECTIVE VALUE                0.0000

 RESOURCE USAGE, LIMIT          0.000      1000.000
 ITERATION COUNT, LIMIT         0    2000000000
 EVALUATION ERRORS              0             0

Convert 2.0      24.7.4 r58773 Released Sep 19, 2016 LEG x86 64bit/Linux      

--- Using Option File
Reading parameter(s) from "/home/renigijus/gams/opt-mod-lib/gamslib/qmeanvar/convert.opt"
>>  ampl qmeanvar-scalar.mod
Finished reading from "/home/renigijus/gams/opt-mod-lib/gamslib/qmeanvar/convert.opt"
Ampl      : qmeanvar-scalar.mod


No solution returned
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:23:26 Page 18
Financial Optimization: Risk Management using MIQCP (QMEANVAR,SEQ=291)
E x e c u t i o n


----    155 PARAMETER xres  Summary report at different points

            oldr        oldv

cn         0.200       0.200
fr         0.200       0.200
sw         0.200       0.200
uk         0.200       0.200
us         0.200       0.200
mean       0.112       0.112
var       21.419      21.419


----    155 PARAMETER Report  Portfolio Details at different points

                      ( ALL       0.000 )



EXECUTION TIME       =        0.001 SECONDS      3 MB  24.7.4 r58773 LEX-LEG


USER: Remigijus Paulavicius, Single User License     S170731:0859AO-LNX
      Imperial College London, Dept. of Chemical Engineering    DC13449
      License for teaching and research at degree granting institutions


**** FILE SUMMARY

Input      /home/renigijus/gams/opt-mod-lib/gamslib/qmeanvar/qmeanvar.gms
Output     /home/renigijus/gams/opt-mod-lib/gamslib/qmeanvar/qmeanvar-scalar.mod.lst
