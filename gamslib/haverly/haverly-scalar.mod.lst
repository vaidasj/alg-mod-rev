GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:32:28 Page 1
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


   1  option NLP=convert;
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:32:28 Page 2
Haverly's pooling problem example (HAVERLY,SEQ=214)
C o m p i l a t i o n


       
         Haverly's pooling problem example. This is a non-convex problem.
         Setting initial levels for the nonlinear variables is a good
         approach to find the global optimum.
       
       
      Haverly, C A, Studies of the Behavior of Recursion for the Pooling
      Problem. ACM SIGMAP Bull 25 (1978), 29-32.
       
      Adhya, N, Tawaralani, M, and Sahinidis, N, A Lagrangian Approach to
      the Pooling Problem. Independent Engineering Chemical Research 38
      (1999), 1956-1972.
       
       
      ----- crudeA ------/--- pool --|
                        /            |--- finalX
      ----- crudeB ----/             |
                                     |--- finalY
      ----- crudeC ------------------|
       
  25   
  26  sets s supplies (crudes) / crudeA, crudeB, crudeC /
  27       f final products    / finalX, finalY /
  28       i intermediate sources for final products / Pool, CrudeC /
  29       poolin(s) crudes going into pool tank / crudeA, crudeB /
  30   
  31  table data_S(s,*) supply data summary
  32   
  33           price  sulfur
  34  crudeA     6     3
  35  crudeB    16     1
  36  crudeC    10     2
  37   
  38  table data_f(f,*) final product data
  39   
  40           price  sulfur demand
  41  finalX     9     2.5    100
  42  finalY    15     1.5    200
  43   
  44  parameters sulfur_content(s) supply quality in (percent)
  45             req_sulfur(f)     required max sulfur content (percentage)
  46             demand(f)         final product demand;
  47   
  48  sulfur_content(s) = data_S(s,'sulfur');
  49  req_sulfur(f)     = data_F(f,'sulfur');
  50  demand(f)         = data_F(f,'demand');
  51   
  52  equations
  53     costdef       cost equation
  54     incomedef     income equation
  55     blend(f)      blending of final products
  56     poolbal       pool tank balance
  57     crudeCbal     balance for crudeC
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:32:28 Page 3
Haverly's pooling problem example (HAVERLY,SEQ=214)
C o m p i l a t i o n


  58     poolqualbal   pool quality balance
  59     blendqualbal  quality balance for blending
  60     profitdef     profit equation
  61   
  62  positive variables
  63     crude(s)    amount of crudes being used
  64     stream(i,f) streams
  65     q           pool quality
  66  variables
  67     profit      total profit
  68     cost        total costs
  69     income      total income
  70     final(f)    amount of final products sold;
  71   
  72   
  73  profitdef.. profit =e= income - cost;
  74   
  75  costdef..   cost   =e= sum(s, data_S(s,'price')*crude(s));
  76   
  77  incomedef.. income =e= sum(f, data_F(f,'price')*final(f));
  78   
  79  blend(f)..  final(f) =e=  sum(i, stream(i,f));
  80   
  81  poolbal..   sum(poolin, crude(poolin)) =e= sum(f, stream('pool',f));
  82   
  83  crudeCbal.. crude('crudeC') =e= sum(f, stream('crudeC',f));
  84   
  85  poolqualbal.. q*sum(f, stream('pool', f)) =e=
  86                     sum(poolin, sulfur_content(poolin)*crude(poolin));
  87   
  88  blendqualbal(f)..
  89              q*stream('pool',f) + sulfur_content('CrudeC')*stream('CrudeC',f)
  90                       =l=  req_sulfur(f)*sum(i,stream(i,f));
  91   
  92  final.up(f) = demand(f);
  93   
  94  model m /all/;
  95   
  96  * Because of the product terms, some local solver may get
  97  * trapped at 0*0, we therefore set an initial value for q.
  98  q.l=1;
  99   
 100  solve m maximizing profit using nlp;


COMPILATION TIME     =        0.001 SECONDS      3 MB  24.7.4 r58773 LEX-LEG
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:32:28 Page 4
Haverly's pooling problem example (HAVERLY,SEQ=214)
Equation Listing    SOLVE m Using NLP From line 100


---- costdef  =E=  cost equation

costdef..  - 6*crude(crudeA) - 16*crude(crudeB) - 10*crude(crudeC) + cost =E= 0 ; (LHS = 0)
     

---- incomedef  =E=  income equation

incomedef..  income - 9*final(finalX) - 15*final(finalY) =E= 0 ; (LHS = 0)
     

---- blend  =E=  blending of final products

blend(finalX)..  - stream(crudeC,finalX) - stream(Pool,finalX) + final(finalX) =E= 0 ; (LHS = 0)
     
blend(finalY)..  - stream(crudeC,finalY) - stream(Pool,finalY) + final(finalY) =E= 0 ; (LHS = 0)
     

---- poolbal  =E=  pool tank balance

poolbal..  crude(crudeA) + crude(crudeB) - stream(Pool,finalX) - stream(Pool,finalY) =E= 0 ; (LHS = 0)
     

---- crudeCbal  =E=  balance for crudeC

crudeCbal..  crude(crudeC) - stream(crudeC,finalX) - stream(crudeC,finalY) =E= 0 ; (LHS = 0)
     

---- poolqualbal  =E=  pool quality balance

poolqualbal..  - 3*crude(crudeA) - crude(crudeB) + (1)*stream(Pool,finalX) + (1)*stream(Pool,finalY) + (0)*q =E= 0 ; (LHS = 0)
     

---- blendqualbal  =L=  quality balance for blending

blendqualbal(finalX)..  - 0.5*stream(crudeC,finalX) - (1.5)*stream(Pool,finalX) + (0)*q =L= 0 ; (LHS = 0)
     
blendqualbal(finalY)..  0.5*stream(crudeC,finalY) - (0.5)*stream(Pool,finalY) + (0)*q =L= 0 ; (LHS = 0)
     

---- profitdef  =E=  profit equation

profitdef..  profit + cost - income =E= 0 ; (LHS = 0)
     
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:32:28 Page 5
Haverly's pooling problem example (HAVERLY,SEQ=214)
Column Listing      SOLVE m Using NLP From line 100


---- crude  amount of crudes being used

crude(crudeA)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
       -6       costdef
        1       poolbal
       -3       poolqualbal

crude(crudeB)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
      -16       costdef
        1       poolbal
       -1       poolqualbal

crude(crudeC)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
      -10       costdef
        1       crudeCbal


---- stream  streams

stream(crudeC,finalX)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
       -1       blend(finalX)
       -1       crudeCbal
       -0.5     blendqualbal(finalX)

stream(crudeC,finalY)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
       -1       blend(finalY)
       -1       crudeCbal
        0.5     blendqualbal(finalY)

stream(Pool,finalX)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
       -1       blend(finalX)
       -1       poolbal
       (1)      poolqualbal
      (-1.5)    blendqualbal(finalX)

REMAINING ENTRY SKIPPED

---- q  pool quality

q
                (.LO, .L, .UP, .M = 0, 1, +INF, 0)
       (0)      poolqualbal
       (0)      blendqualbal(finalX)
       (0)      blendqualbal(finalY)

GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:32:28 Page 6
Haverly's pooling problem example (HAVERLY,SEQ=214)
Column Listing      SOLVE m Using NLP From line 100


---- profit  total profit

profit
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       profitdef


---- cost  total costs

cost
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       costdef
        1       profitdef


---- income  total income

income
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       incomedef
       -1       profitdef


---- final  amount of final products sold

final(finalX)
                (.LO, .L, .UP, .M = -INF, 0, 100, 0)
       -9       incomedef
        1       blend(finalX)

final(finalY)
                (.LO, .L, .UP, .M = -INF, 0, 200, 0)
      -15       incomedef
        1       blend(finalY)

GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:32:28 Page 7
Haverly's pooling problem example (HAVERLY,SEQ=214)
Model Statistics    SOLVE m Using NLP From line 100


MODEL STATISTICS

BLOCKS OF EQUATIONS           8     SINGLE EQUATIONS           10
BLOCKS OF VARIABLES           7     SINGLE VARIABLES           13
NON ZERO ELEMENTS            34     NON LINEAR N-Z              7
DERIVATIVE POOL              20     CONSTANT POOL              18
CODE LENGTH                  18


GENERATION TIME      =        0.003 SECONDS      4 MB  24.7.4 r58773 LEX-LEG


EXECUTION TIME       =        0.003 SECONDS      4 MB  24.7.4 r58773 LEX-LEG
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:32:28 Page 8
Haverly's pooling problem example (HAVERLY,SEQ=214)
Solution Report     SOLVE m Using NLP From line 100


               S O L V E      S U M M A R Y

     MODEL   m                   OBJECTIVE  profit
     TYPE    NLP                 DIRECTION  MAXIMIZE
     SOLVER  CONVERT             FROM LINE  100

**** SOLVER STATUS     1 Normal Completion         
**** MODEL STATUS      14 No Solution Returned     
**** OBJECTIVE VALUE                0.0000

 RESOURCE USAGE, LIMIT          0.000      1000.000
 ITERATION COUNT, LIMIT         0    2000000000
 EVALUATION ERRORS              0             0

Convert 2.0      24.7.4 r58773 Released Sep 19, 2016 LEG x86 64bit/Linux      

--- Using Option File
Reading parameter(s) from "/home/renigijus/gams/opt-mod-lib/gamslib/haverly/convert.opt"
>>  ampl haverly-scalar.mod
Finished reading from "/home/renigijus/gams/opt-mod-lib/gamslib/haverly/convert.opt"
Ampl      : haverly-scalar.mod


No solution returned


EXECUTION TIME       =        0.000 SECONDS      2 MB  24.7.4 r58773 LEX-LEG


USER: Remigijus Paulavicius, Single User License     S170731:0859AO-LNX
      Imperial College London, Dept. of Chemical Engineering    DC13449
      License for teaching and research at degree granting institutions


**** FILE SUMMARY

Input      /home/renigijus/gams/opt-mod-lib/gamslib/haverly/haverly.gms
Output     /home/renigijus/gams/opt-mod-lib/gamslib/haverly/haverly-scalar.mod.lst
