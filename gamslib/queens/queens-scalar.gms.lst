GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:48 Page 1
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


   1  option MIP=convert;
   2  option MIP=convert;
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:48 Page 2
Maximum Queens Chess Problem  (QUEENS,SEQ=103)
C o m p i l a t i o n


   5   
       
         This model finds all possible ways to arrange eight queens on a chess
         board in such a way that no two queens check against any other queen.
         The solution proceeds in two steps. In the first step, we find any
         solution. In the second step we find all solutions by adding cuts to
         to the original problem set. Finally, a reporting step is added
         to print all solutions found. This problem has a long history. In 1850
         it was investigated by C.F. Gauss, but he was unable to solve it
         completely. There are 92 possible solutions.
       
       
      Dudeney, H E, Amusements in Mathematics. Dover, New York, 1970.
       
      Beauvais, J, Solving the Maximum Queens Chess Problem with OSL. IBM
      Kingston, EKKNEWS 2 (1991).
       
  24   
  25  Sets i  size of chess board     / 1*8 /
  26       s  diagonal offsets        / 1*13 /   ! 2i-3 diagonals
  27  Alias (i,j)
  28   
  29  Parameter sh(s) shift values for diagonals
  30            rev(i) reverse order;
  31   
  32  sh(s)  = ord(s) - card(i) + 1 ;
  33  rev(i) = card(i) + 1 - 2*ord(i);
  34  Display sh, rev;
  35   
  36  Binary Variable x(i,j) square occupied by Queen
  37         Variable tot    total squares occupied by queens
  38   
  39  Equations a(i)  no to queens may be in the same rank
  40            b(j)  no to queens may be in the same file
  41            c(s)  no to queens may be in the same diagonal (forward)
  42            d(s)  no to queens may be in the same diagonal (backward)
  43            obj   objective definition ;
  44   
  45  a(i).. sum(j, x(i,j)) =e= 1;
  46   
  47  b(j).. sum(i, x(i,j)) =e= 1;
  48   
  49  c(s).. sum(i, x(i,i+sh(s))) =l= 1;
  50   
  51  d(s).. sum(i, x(i,i+(rev(i)+sh(s)))) =l= 1;
  52   
  53  obj..  tot =e= sum((i,j), x(i,j));
  54   
  55  Model queen1 first model for queens / all /;
  56   
  57  Option optcr = 0;
  58   
  59  Solve queen1 maximizing tot using mip;
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:48 Page 3
Maximum Queens Chess Problem  (QUEENS,SEQ=103)
C o m p i l a t i o n


  60   
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:48 Page 4
Maximum Queens Chess Problem  (QUEENS,SEQ=103)
Find all remaining solutions


  62   
  63  Sets nn    max number of solutions groups / 1*20 /
  64       n(nn) dynamic set for solution groups
  65       t     multiple solutions via rotations and reflections /
  66             found       original solution
  67             rot-90      original solution rotated  90 degrees
  68             rot-180     original solution rotated 180 degrees
  69             rot-270     original solution rotated 270 degrees
  70             ref-h       original solution reflected horizontally
  71             ref-v       original solution reflected vertically
  72             ref-r       original solution reflected diagonally main
  73             ref-l       original solution reflected diagonally back   /
  74   
  75  Scalar    saverow, coloff;
  76  Parameter cutval all possible solutions for cut generation;
  77   
  78  Equation cut(nn,t)  known solutions to be eliminated;
  79   
  80  cut(n,t).. sum((i,j), cutval(n,t,i,j)*x(i,j)) =l= card(i)-1;
  81   
  82  Model queens queens model with cuts / all /;
  83   
  84  Option limrow=0, limcol=0, solprint=off;
  85   
  86   
  87  n(nn) = no;  ! clear set of cuts
  88   
  89  queens.solvestat = 1;
  90  queens.modelstat = 1;
  91   
  92  Loop(nn$(queens.solvestat=1 and
  93           queens.modelstat=1),
  94   
  95     n(nn) = yes;   ! add element to set
  96   
  97     cutval(nn,'found'   ,i,j) = x.l(i       ,j       );
  98     cutval(nn,'rot-90'  ,i,j) = x.l(j+rev(j),i       );
  99     cutval(nn,'rot-180' ,i,j) = x.l(i+rev(i),j+rev(j));
 100     cutval(nn,'rot-270' ,i,j) = x.l(j       ,i+rev(i));
 101     cutval(nn,'ref-h'   ,i,j) = x.l(i+rev(i),j       );
 102     cutval(nn,'ref-v'   ,i,j) = x.l(i       ,j+rev(j));
 103     cutval(nn,'ref-r'   ,i,j) = x.l(j       ,i       );
 104     cutval(nn,'ref-l'   ,i,j) = x.l(j+rev(j),i+rev(i));
 105   
 106     Solve queens maximizing tot using mip;    )
 107   
 108  Option cutval:0:3:1; display cutval;
 109   
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:48 Page 5
Maximum Queens Chess Problem  (QUEENS,SEQ=103)
Write solution report to PUT file


 111   
 112  File   queen report file for solution groups ; put queen; queen.pc=3;
 113  Scalar saverow  row position to start second report column
 114         coloff   column offset for board displays;
 115   
 116  Puttl 'Queens Solution Summary        ' system.date ' ' system.time
 117  Loop(n(nn),
 118     Putpage;
 119     Put @12 // 'Solution Number ' ord(nn):3:0 ' of ' card(n):<3:0 ;
 120     saverow = file.cr; coloff = 1;
 121     Loop(t,
 122        if(ord(t)=5,
 123           file.cr = saverow;
 124           coloff  = 31);
 125        Put // @coloff 'Type = ' t.tl // @(coloff+2) ;
 126        Loop(j,
 127           Put j.tl:>2);
 128        Loop(i,
 129           Put / @coloff i.tl:>2;
 130           Loop(j,
 131              If(cutval(n,t,i,j),
 132                 Put ' x'
 133               Else Put '  ' ) ) ) ) );
 134   


COMPILATION TIME     =        0.001 SECONDS      3 MB  24.7.4 r58773 LEX-LEG
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:48 Page 6
Maximum Queens Chess Problem  (QUEENS,SEQ=103)
E x e c u t i o n


----     34 PARAMETER sh  shift values for diagonals

1  -6.000,    2  -5.000,    3  -4.000,    4  -3.000,    5  -2.000,    6  -1.000,    8   1.000,    9   2.000,    10  3.000,    11  4.000,    12  5.000,    13  6.000


----     34 PARAMETER rev  reverse order

1  7.000,    2  5.000,    3  3.000,    4  1.000,    5 -1.000,    6 -3.000,    7 -5.000,    8 -7.000

GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:48 Page 7
Maximum Queens Chess Problem  (QUEENS,SEQ=103)
Equation Listing    SOLVE queen1 Using MIP From line 59


---- a  =E=  no to queens may be in the same rank

a(1)..  x(1,1) + x(1,2) + x(1,3) + x(1,4) + x(1,5) + x(1,6) + x(1,7) + x(1,8) =E= 1 ; (LHS = 0, INFES = 1 ****)
     
a(2)..  x(2,1) + x(2,2) + x(2,3) + x(2,4) + x(2,5) + x(2,6) + x(2,7) + x(2,8) =E= 1 ; (LHS = 0, INFES = 1 ****)
     
a(3)..  x(3,1) + x(3,2) + x(3,3) + x(3,4) + x(3,5) + x(3,6) + x(3,7) + x(3,8) =E= 1 ; (LHS = 0, INFES = 1 ****)
     
REMAINING 5 ENTRIES SKIPPED


---- b  =E=  no to queens may be in the same file

b(1)..  x(1,1) + x(2,1) + x(3,1) + x(4,1) + x(5,1) + x(6,1) + x(7,1) + x(8,1) =E= 1 ; (LHS = 0, INFES = 1 ****)
     
b(2)..  x(1,2) + x(2,2) + x(3,2) + x(4,2) + x(5,2) + x(6,2) + x(7,2) + x(8,2) =E= 1 ; (LHS = 0, INFES = 1 ****)
     
b(3)..  x(1,3) + x(2,3) + x(3,3) + x(4,3) + x(5,3) + x(6,3) + x(7,3) + x(8,3) =E= 1 ; (LHS = 0, INFES = 1 ****)
     
REMAINING 5 ENTRIES SKIPPED


---- c  =L=  no to queens may be in the same diagonal (forward)

c(1)..  x(7,1) + x(8,2) =L= 1 ; (LHS = 0)
     
c(2)..  x(6,1) + x(7,2) + x(8,3) =L= 1 ; (LHS = 0)
     
c(3)..  x(5,1) + x(6,2) + x(7,3) + x(8,4) =L= 1 ; (LHS = 0)
     
REMAINING 10 ENTRIES SKIPPED


---- d  =L=  no to queens may be in the same diagonal (backward)

d(1)..  x(1,2) + x(2,1) =L= 1 ; (LHS = 0)
     
d(2)..  x(1,3) + x(2,2) + x(3,1) =L= 1 ; (LHS = 0)
     
d(3)..  x(1,4) + x(2,3) + x(3,2) + x(4,1) =L= 1 ; (LHS = 0)
     
REMAINING 10 ENTRIES SKIPPED


---- obj  =E=  objective definition

obj..  - x(1,1) - x(1,2) - x(1,3) - x(1,4) - x(1,5) - x(1,6) - x(1,7) - x(1,8) - x(2,1) - x(2,2) - x(2,3) - x(2,4) - x(2,5) - x(2,6) - x(2,7) - x(2,8) - x(3,1) - x(3,2) - x(3,3) - x(3,4) - x(3,5) - x(3,6) - x(3,7) - x(3,8) - x(4,1) - x(4,2) - x(4,3)
     
      - x(4,4) - x(4,5) - x(4,6) - x(4,7) - x(4,8) - x(5,1) - x(5,2) - x(5,3) - x(5,4) - x(5,5) - x(5,6) - x(5,7) - x(5,8) - x(6,1) - x(6,2) - x(6,3) - x(6,4) - x(6,5) - x(6,6) - x(6,7) - x(6,8) - x(7,1) - x(7,2) - x(7,3) - x(7,4) - x(7,5) - x(7,6)
     
      - x(7,7) - x(7,8) - x(8,1) - x(8,2) - x(8,3) - x(8,4) - x(8,5) - x(8,6) - x(8,7) - x(8,8) + tot =E= 0 ; (LHS = 0)
     
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:48 Page 8
Maximum Queens Chess Problem  (QUEENS,SEQ=103)
Column Listing      SOLVE queen1 Using MIP From line 59


---- x  square occupied by Queen

x(1,1)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
        1       a(1)
        1       b(1)
        1       c(7)
       -1       obj

x(1,2)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
        1       a(1)
        1       b(2)
        1       c(8)
        1       d(1)
       -1       obj

x(1,3)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
        1       a(1)
        1       b(3)
        1       c(9)
        1       d(2)
       -1       obj

REMAINING 61 ENTRIES SKIPPED

---- tot  total squares occupied by queens

tot
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       obj

GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:48 Page 9
Maximum Queens Chess Problem  (QUEENS,SEQ=103)
Model Statistics    SOLVE queen1 Using MIP From line 59


MODEL STATISTICS

BLOCKS OF EQUATIONS           5     SINGLE EQUATIONS           43
BLOCKS OF VARIABLES           2     SINGLE VARIABLES           65
NON ZERO ELEMENTS           317     DISCRETE VARIABLES         64


GENERATION TIME      =        0.003 SECONDS      4 MB  24.7.4 r58773 LEX-LEG


EXECUTION TIME       =        0.003 SECONDS      4 MB  24.7.4 r58773 LEX-LEG
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 10:24:48 Page 10
Maximum Queens Chess Problem  (QUEENS,SEQ=103)
Solution Report     SOLVE queen1 Using MIP From line 59


               S O L V E      S U M M A R Y

     MODEL   queen1              OBJECTIVE  tot
     TYPE    MIP                 DIRECTION  MAXIMIZE
     SOLVER  CONVERT             FROM LINE  59

**** SOLVER STATUS     1 Normal Completion         
**** MODEL STATUS      14 No Solution Returned     
**** OBJECTIVE VALUE                0.0000

 RESOURCE USAGE, LIMIT          0.000      1000.000
 ITERATION COUNT, LIMIT         0    2000000000

Convert 2.0      24.7.4 r58773 Released Sep 19, 2016 LEG x86 64bit/Linux      

--- Using Option File
Reading parameter(s) from "/home/renigijus/gams/opt-mod-lib/gamslib/queens/convert.opt"
>>  gams queens-scalar.gms
Finished reading from "/home/renigijus/gams/opt-mod-lib/gamslib/queens/convert.opt"
Gams      : queens-scalar.gms


No solution returned
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 10:24:48 Page 11
Maximum Queens Chess Problem  (QUEENS,SEQ=103)
Model Statistics    SOLVE queens Using MIP From line 106


LOOPS                                   nn   1


MODEL STATISTICS

BLOCKS OF EQUATIONS           6     SINGLE EQUATIONS           43
BLOCKS OF VARIABLES           2     SINGLE VARIABLES           65
NON ZERO ELEMENTS           317     DISCRETE VARIABLES         64


GENERATION TIME      =        0.001 SECONDS      3 MB  24.7.4 r58773 LEX-LEG


EXECUTION TIME       =        0.001 SECONDS      3 MB  24.7.4 r58773 LEX-LEG
               L O O P S                 nn 1

GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 10:24:48 Page 12
Maximum Queens Chess Problem  (QUEENS,SEQ=103)
Solution Report     SOLVE queens Using MIP From line 106


               S O L V E      S U M M A R Y

     MODEL   queens              OBJECTIVE  tot
     TYPE    MIP                 DIRECTION  MAXIMIZE
     SOLVER  CONVERT             FROM LINE  106

**** SOLVER STATUS     1 Normal Completion         
**** MODEL STATUS      14 No Solution Returned     
**** OBJECTIVE VALUE                0.0000

 RESOURCE USAGE, LIMIT          0.000      1000.000
 ITERATION COUNT, LIMIT         0    2000000000

Convert 2.0      24.7.4 r58773 Released Sep 19, 2016 LEG x86 64bit/Linux      

--- Using Option File
Reading parameter(s) from "/home/renigijus/gams/opt-mod-lib/gamslib/queens/convert.opt"
>>  gams queens-scalar.gms
Finished reading from "/home/renigijus/gams/opt-mod-lib/gamslib/queens/convert.opt"
Gams      : queens-scalar.gms


No solution returned
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 10:24:48 Page 13
Maximum Queens Chess Problem  (QUEENS,SEQ=103)
E x e c u t i o n


----    108 PARAMETER cutval  all possible solutions for cut generation

                      ( ALL          0. )


**** REPORT FILE SUMMARY

queen /home/renigijus/gams/opt-mod-lib/gamslib/queens/queen.put


EXECUTION TIME       =        0.001 SECONDS      3 MB  24.7.4 r58773 LEX-LEG


USER: Remigijus Paulavicius, Single User License     S170731:0859AO-LNX
      Imperial College London, Dept. of Chemical Engineering    DC13449
      License for teaching and research at degree granting institutions


**** FILE SUMMARY

Input      /home/renigijus/gams/opt-mod-lib/gamslib/queens/queens.gms
Output     /home/renigijus/gams/opt-mod-lib/gamslib/queens/queens-scalar.gms.lst
