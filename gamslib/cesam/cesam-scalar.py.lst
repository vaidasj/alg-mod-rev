GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:05:51 Page 1
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


   1  option MCP=convert;
   2  option MCP=convert;
   3  option MCP=convert;
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:05:51 Page 2
Cross Entropy SAM Estimation (CESAM,SEQ=228)
C o m p i l a t i o n


       CESAM illustrates a cross entropy technique for estimating the cells
       of a consistent SAM assuming that the initial data are inconsistent
       and measured with error. The method is applied to a stylized macro
       SAM for Mozambique. Some macro control totals are assumed known with
       error, and also all the row and column totals are assumed
       known only with error. We assume that the user can specify
       a prior estimate of the standard error of the estimates of the row
       and column sums and of the macro control totals.
       
       
      Robinson, S, Cattaneo, A, and El-Said, M, Updating and Estimating
      a Social Accounting Matrix Using Cross Enthropy Methods. Economic
      System Research 13, 1 (2001).
       
      Golan, G, Judge, G, and Miller, D, Maximum Enthropy Econometrics.
      John Wiley and Sons, 1996.
       
       Programmed by Sherman Robinson and Moataz El-Said, November 2000.
       Trade and Macroeconomics Division
       International Food Policy Research Institute (IFPRI)
       2033 K Street, N.W.
       Washington, DC 20006 USA
       Email: S.Robinson@CGIAR.ORG
              M.El-Said@CGIAR.ORG
       
       Data set is based on a SAM developed by C. Arndt, A. S. Cruz, H. T.
       Jensen, S. Robinson, and F. Tarp, "Social Accounting Matrices
       for Mozambique - 1994 and 1995." TMD Discussion Paper No. 28, IFPRI,
       July 1998.
       
       Original version programmed by Sherman Robinson and Andrea Cattaneo.
       
  39   
  40   
  41  SETS
  42   
  43   i      sam accounts   / ACT     Activities
  44                           COM     Commodities
  45                           FAC     Factors
  46                           ENT     Enterprises
  47                           HOU     Households
  48                           GRE     Govt recurrent expenditures
  49                           GIN     Govt investment
  50                           CAP     Capital account
  51                           ROW     Rest of world
  52                           TOTAL /
  53   
  54   ii(i)  all accounts in i except TOTAL
  55                         / ACT     Activities
  56                           COM     Commodities
  57                           FAC     Factors
  58                           ENT     Enterprises
  59                           HOU     Households
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:05:51 Page 3
Cross Entropy SAM Estimation (CESAM,SEQ=228)
C o m p i l a t i o n


  60                           GRE     Govt recurrent expenditures
  61                           GIN     Govt investment
  62                           CAP     Capital account
  63                           ROW     Rest of world /
  64   
  65   macro  macro controls  /gdpfc2, gdp2 /
  66   
  67  * The set jwt defines the dimension of the support set for the error
  68  * distribution and the number of weights that must be estimated for each
  69  * error. In this case, we specify a five parameter error distribution.
  70  * For a three parameter distribution, jwt is set to /1*3/.
  71   
  72   jwt    set of weights for errors in variables
  73                         / 1*5 /
  74  ;
  75   
  76  * ii(i)       = YES;
  77  * ii("Total") = NO;
  78   
  79  ALIAS (i,j), (ii,jj);
  80   
  81  *########################    SAM DATABASE       ########################
  82  TABLE SAM(i,j)  social accounting matrix
  83                         ACT            COM            FAC            ENT
  84  ACT                    0.0     14827.4240            0.0            0.0
  85  COM              7917.5040            0.0            0.0            0.0
  86  FAC              9805.4140            0.0            0.0            0.0
  87  ENT                    0.0            0.0      3699.7060            0.0
  88  HOU                    0.0            0.0      6031.3080      3417.5060
  89  GRE               733.6000       357.4000        74.4000       165.2000
  90  GIN                    0.0            0.0            0.0            0.0
  91  CAP                    0.0            0.0            0.0       150.0000
  92  ROW                    0.0      5573.8150            0.0            0.0
  93  Total           18456.5180      20758.639       9805.414       3732.706
  94   
  95    +                    HOU            GRE            GIN            CAP
  96  ACT              2101.0490        -0.3270            0.0            0.0
  97  *COM             6753.3320      1764.5000      2118.5000      2197.7980
  98  COM              6953.3320      1564.5000      2518.5000      2597.7980
  99  FAC                    0.0            0.0            0.0            0.0
 100  ENT                    0.0        33.0000            0.0            0.0
 101  HOU                    0.0        29.6000            0.0            0.0
 102  GRE               139.5000            0.0            0.0            0.0
 103  GIN                    0.0            0.0            0.0            0.0
 104  CAP               649.1560      -356.6730      -406.2000            0.0
 105  ROW                    0.0            0.0            0.0            0.0
 106  Total             9643.037         1470.1         1712.3       2197.798
 107   
 108    +                    ROW      Total
 109  ACT              1488.1570      18416.303
 110  COM                    0.0      20751.634
 111  FAC                    0.0       9805.414
 112  ENT                    0.0       3732.706
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:05:51 Page 4
Cross Entropy SAM Estimation (CESAM,SEQ=228)
C o m p i l a t i o n


 113  HOU               209.5010       9687.915
 114  GRE                    0.0         1470.1
 115  GIN              1712.3000         1712.3
 116  CAP              2163.8570        2200.14
 117  ROW                    0.0       5573.815
 118  Total             5573.815
 119       ;
 120   
 121  *#########################  Parameters and Scalars #####################
 122  PARAMETER
 123   
 124   SAM0(i,j)        Base SAM transactions matrix
 125   T0(i,j)          Matrix of SAM transactions (flow matrix)
 126   T1(i,j)          SAM transactions Adjusted to eliminate negative entries
 127   Abar0(i,j)       Prior SAM coefficient matrix
 128   Abar1(i,j)       Prior SAM adjusted to eliminate negative coefficients
 129   Target0(i)       Targets for macro SAM column totals
 130   vbar1(i,jwt)     Error support set 1
 131   vbar2(macro,jwt) Error support set 2
 132   wbar1(i,jwt)     Weights on error support set 1
 133   wbar2(macro,jwt) Weights on error support set 2
 134   sigmay1(i)       Prior standard error of column sums
 135   sigmay2(macro)   Prior standard error of macro aggregates
 136   epsilon          Tolerance to allow zero entries in SAM
 137  ;
 138   
 139  SCALARS
 140   
 141   gdp0          base GDP
 142   gdp00         GDP from final SAM
 143   gdpfc0        GDP at factor cost
 144  ;
 145   
 146  *################# Initializing Parameters
 147   SAM("TOTAL",jj)      = sum(ii, SAM(ii,jj));
 148   SAM(ii,"TOTAL")      = sum(jj, SAM(ii,jj));
 149   sam0(i,j)            = sam(i,j);
 150   
 151  *#################
 152  * Divide SAM entries by 1000 for better scaling.
 153  * The SAM is scaled to enhance solver efficiency. Nonlinear solvers are
 154  * more efficient if variables are scaled similarly. In this case,
 155  * coefficients to be estimated range between 0 and 1, so SAM values
 156  * are also scaled.
 157   
 158   Scalar scalesam Scaling value  /1000/ ;
 159   
 160   sam(i,j)                 = sam(i,j)/scalesam ;
 161   Abar0(ii,jj)$SAM(ii,jj)  = SAM(ii,jj)/SAM("TOTAL",jj) ;
 162   
 163   T0(ii,jj)                = SAM(ii,jj);
 164   T0("TOTAL",jj)           = sum(ii, SAM(ii,jj));
 165   T0(ii,"TOTAL")           = sum(jj, SAM(ii,jj));
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:05:51 Page 5
Cross Entropy SAM Estimation (CESAM,SEQ=228)
C o m p i l a t i o n


 166   
 167   epsilon                  = .00001;
 168   
 169   Display T0, Abar0 ;
 170  *########################  CROSS ENTROPY  ##############################
 171   
 172   
 173  *########################  RED ALERT!!!   ##############################
 174   
 175  * The ENTROPY DIFFERENCE procedure uses LOGARITHMS: negative flows in
 176  * the SAM are NOT GOOD!!!
 177  *
 178  * The option used here is to detect any negative flows and net them out
 179  * of their respective symmetric cells, e.g.
 180  *     negative flow column to row is set to zero
 181  *     and added to corresponding row to column as a positive number.
 182  * The entropy difference method can then be implemented.
 183  * After balancing, the negative SAM values are returned to their
 184  * original cells for printing.
 185   
 186  SET
 187   red(i,j)           Set of negative SAM flows
 188  ;
 189   
 190  Parameter
 191   redsam(i,j)        Negative SAM values only
 192   rtot(i)            Row total
 193   ctot(i)            Column total
 194  ;
 195   
 196   rtot(ii)                            = sum(jj, T0(ii,jj));
 197   ctot(jj)                            = sum(ii, T0(ii,jj));
 198   
 199   red(ii,jj)$(T0(ii,jj) LT 0)         = yes ;
 200   redsam(ii,jj)                       = 0;
 201   redsam(ii,jj)$red(ii,jj)            = T0(ii,jj);
 202   redsam(jj,ii)$red(ii,jj)            = T0(ii,jj);
 203   
 204  *Note that redsam includes each entry twice, in corresponding row
 205  *and column. So, redsam need only be subtracted from T0.
 206   T1(ii,jj)                           = T0(ii,jj) - redsam(ii,jj);
 207   T1("Total",jj)                      = sum(ii, T1(ii,jj));
 208   T1(ii,"Total")                      = sum(jj, T1(ii,jj));
 209   
 210   redsam("total",jj)                  = sum(ii, redsam(ii,jj));
 211   redsam(ii,"total")                  = sum(jj, redsam(ii,jj));
 212   
 213   sam(ii,"total")                     = sum(jj, T1(ii,jj));
 214   sam("total",jj)                     = sum(ii, T1(ii,jj));
 215   
 216   rtot(ii)                            = sum(jj, T1(ii,jj));
 217   ctot(jj)                            = sum(ii, T1(ii,jj));
 218   
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:05:51 Page 6
Cross Entropy SAM Estimation (CESAM,SEQ=228)
C o m p i l a t i o n


 219   Abar1(ii,jj)                        = T1(ii,jj)/sam("total",jj);
 220   
 221   display "NON-NEGATIVE SAM" ;
 222   display redsam, T1, Abar0, Abar1, rtot, ctot ;
 223   
 224  * Define set of elements of SAM that can be nonzero. In this case, only
 225  * elements which are nonzero in initial SAM.
 226   SET NONZERO(i,j)  SAM elements that can be nonzero ;
 227   
 228   NONZERO(ii,jj)$(Abar1(ii,jj)) = yes ;
 229   
 230  *#### Initializing Parameters after accounting for negative values #####
 231  *   Note that target column sums are being set to average of initial
 232  *   row and column sums. Initial column sums or other values
 233  *   could have been used instead, depending on knowledge of data quality
 234  *   and any other prior information.
 235   
 236   target0(ii)         = (sam(ii,"total") +  sam("total",ii))/2 ;
 237   gdpfc0              = T1("fac","act");
 238   gdp0                = T1("fac","act") + T1("gre","act")
 239                          - T1("act","gre") + T1("gre","com") ;
 240  Display gdpfc0, gdp0;
 241   
 242  *############### Define variable bounds on errors #####################
 243  * Start from assumed prior knowledge of the standard error (perhaps due
 244  * to measurement error) of the column sums. Below, we assume that all
 245  * column sums have a standard error of 5%. This is a Bayesian prior,
 246  * not a maintained hypothesis.
 247  * The estimated error is weighted sum of elements in an error support
 248  * set:
 249  *   ERR(ii) = SUM(jwt, W(ii,jwt)*VBAR(ii,jwt))
 250  * where the W's are estimated in the CE procedure.
 251  * The prior variance of these errors is given by:
 252  *   (sigmay(ii))**2 = SUM(jwt, WBAR(ii,jwt)*(VBAR(ii,jwt))**2 )
 253  * where the WBAR's are the prior on the weights.
 254  * The VBARs are chosen to define a domain for the support set of +/- 3
 255  * standard errors. The prior on the weights, WBAR, are then calculated
 256  * to yield the specified prior on the standard error, sigmay.
 257  * In Robinson, Cattaneo, and El-Said (2001), we specify prior weights
 258  * (WBAR) that are uniform and set the prior standard error by the
 259  * choice of support set, VBAR. In that paper, we use a three-weight
 260  * specification (jwt /1*3/);
 261  *
 262  * We define two sets of errors with separate weights, W1 and W2. The
 263  * first is for specifying errors on column sums, the second for errors
 264  * on macro aggregates (defined in the set macro).
 265   
 266  * First, define standard error for errors on column sums.
 267   
 268    sigmay1(ii)    = 0.05 * target0(ii) ;
 269   
 270  * This code assumes a prior mean of zero and a two-parameter
 271  * distribution with specified prior standard error. There are three
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:05:51 Page 7
Cross Entropy SAM Estimation (CESAM,SEQ=228)
C o m p i l a t i o n


 272  * weights, W(ii,jwt), to be estimated. The actual moments are estimated
 273  * as part of the estimation procedure.
      * Set constants for 3-weight error distribution
        vbar1(ii,"1")  = -3 * sigmay1(ii);
        vbar1(ii,"2")  =  0             ;
        vbar1(ii,"3")  = -3 * sigmay1(ii);
       
        wbar1(ii,"1")  =  1/18  ;
        wbar1(ii,"2")  = 16/18  ;
        wbar1(ii,"3")  =  1/18  ;
 284   
 285  * This code assumes a prior mean of zero and a prior value of kurtosis
 286  * consistent with a prior normal distribution with mean zero, variance
 287  * sigmay**2, and kurtosis equal to 3*sigmay**4. The addition of a prior
 288  * on kurtosis requires estimation of 5 weights (jwt = 5);
 289  * The prior weights wbar are specified so that:
 290  * SUM(jwt, wbar(ii,jwt)*vbar(ii,jwt)**4) = 3*sigmay(ii,jwt)**4
 291  * as well as defining the variance as above.
 292  * The prior weights and support set are also symmetric, so the prior
 293  * on all odd moments is zero. The choice of +/- 1 standard error
 294  * for vbar(ii,"2") and vbar(ii,"4") is arbitrary.
 295  * The actual moments are estimated as part of the estimation procedure.
 296   
 297  * Set constants for 5-weight error distribution
 298    vbar1(ii,"1")  = -3 * sigmay1(ii) ;
 299    vbar1(ii,"2")  = -1 * sigmay1(ii) ;
 300    vbar1(ii,"3")  =  0              ;
 301    vbar1(ii,"4")  = +1 * sigmay1(ii) ;
 302    vbar1(ii,"5")  = +3 * sigmay1(ii) ;
 303   
 304    wbar1(ii,"1")  =   1/72        ;
 305    wbar1(ii,"2")  =  27/72        ;
 306    wbar1(ii,"3")  =  16/72        ;
 307    wbar1(ii,"4")  =  27/72        ;
 308    wbar1(ii,"5")  =   1/72        ;
 309   
 310  * Second, define standard errors for errors on macro aggregates
 311   
 312    sigmay2("gdpfc2")  = 0.05*gdpfc0  ;
 313    sigmay2("gdp2")    = 0.05*gdp0 ;
 314   
      * Set constants for 3-weight error distribution
        vbar2(ii,"1")  = -3 * sigmay2(ii);
        vbar2(ii,"2")  =  0             ;
        vbar2(ii,"3")  = -3 * sigmay2(ii);
       
        wbar2(ii,"1")  =  1/18  ;
        wbar2(ii,"2")  = 16/18  ;
        wbar2(ii,"3")  =  1/18  ;
 325   
 326  * Set constants for 5-weight error distribution
 327    vbar2(macro,"1")  = -3 * sigmay2(macro) ;
 328    vbar2(macro,"2")  = -1 * sigmay2(macro) ;
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:05:51 Page 8
Cross Entropy SAM Estimation (CESAM,SEQ=228)
C o m p i l a t i o n


 329    vbar2(macro,"3")  =  0                  ;
 330    vbar2(macro,"4")  = +1 * sigmay2(macro) ;
 331    vbar2(macro,"5")  = +3 * sigmay2(macro) ;
 332   
 333    wbar2(macro,"1")  =   1/72        ;
 334    wbar2(macro,"2")  =  27/72        ;
 335    wbar2(macro,"3")  =  16/72        ;
 336    wbar2(macro,"4")  =  27/72        ;
 337    wbar2(macro,"5")  =   1/72        ;
 338   
 339   Display vbar1, vbar2, sigmay1, sigmay2 ;
 340   
 341  *###################### VARIABLES #################################
 342   VARIABLES
 343   A(ii,jj)       Post SAM coefficient matrix
 344   TSAM(ii,jj)    Post matrix of SAM transactions
 345   Y(ii)          row sum of SAM
 346   X(ii)          column sum of SAM
 347   ERR1(ii)       Error value on column sums
 348   ERR2(macro)    Error value for macro aggregates
 349   W1(ii,jwt)     Error weights
 350   W2(macro,jwt)  Error weights
 351   DENTROPY       Entropy difference (objective)
 352   GDPFC          GDP at factor cost
 353   GDP            GDP at market prices
 354    ;
 355   
 356  *########################## INITIALIZE VARIABLES ##################
 357   
 358   A.L(ii,jj)          = Abar1(ii,jj) ;
 359   TSAM.L(ii,jj)       = T1(ii,jj)    ;
 360   Y.L(ii)             = target0(ii)  ;
 361   X.L(ii)             = target0(ii)  ;
 362   ERR1.L(ii)          = 0.0          ;
 363   ERR2.L(macro)       = 0.0          ;
 364   W1.L(ii,jwt)        = wbar1(ii,jwt) ;
 365   W2.L(macro,jwt)     = wbar2(macro,jwt) ;
 366   DENTROPY.L          = 0            ;
 367   GDPFC.L             = gdpfc0       ;
 368   GDP.L               = gdp0         ;
 369   
 370  *############ CORE EQUATIONS
 371   EQUATIONS
 372   
 373   SAMEQ(i)        row and column sum constraint
 374   SAMMAKE(i,j)    make SAM flows
 375   ERROR1EQ(i)     definition of error term 1
 376   ERROR2EQ(macro) definition of error term 2
 377   SUMW1(i)        Sum of weights 1
 378   SUMW2(macro)    Sum of weights 2
 379   ENTROPY         Entropy difference definition
 380   ROWSUM(i)       row target
 381   COLSUM(j)       column target
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:05:51 Page 9
Cross Entropy SAM Estimation (CESAM,SEQ=228)
C o m p i l a t i o n


 382   GDPFCDEF        define GDP at factor cost
 383   GDPDEF          define GDP
 384   ;
 385   
 386  *CORE EQUATIONS====================================================
 387   
 388   SAMEQ(ii)..   Y(ii)       =E= X(ii) + ERR1(ii) ;
 389   
 390   SAMMAKE(ii,jj)$nonzero(ii,jj)..
 391                    TSAM(ii,jj) =E= A(ii,jj) * (X(jj) + ERR1(jj)) ;
 392   
 393   ERROR1EQ(ii).. ERR1(ii)    =E= SUM(jwt, W1(ii,jwt)*vbar1(ii,jwt)) ;
 394   
 395   SUMW1(ii)..   SUM(jwt, W1(ii,jwt)) =E= 1 ;
 396   
 397   ENTROPY..     DENTROPY    =E= SUM((ii,jj)$nonzero(ii,jj),
 398                                 A(ii,jj)*(LOG(A(ii,jj) + epsilon)
 399                               - LOG(Abar1(ii,jj) + epsilon)))
 400                               +
 401                                 SUM((ii,jwt), W1(ii,jwt)
 402                               * (LOG(W1(ii,jwt) + epsilon)
 403                               - LOG(wbar1(ii,jwt) + epsilon)))
 404                               +
 405                                 SUM((macro,jwt), W2(macro,jwt)
 406                               * (LOG(W2(macro,jwt) + epsilon)
 407                               - LOG(wbar2(macro,jwt) + epsilon))) ;
 408   
 409  * Note that we exclude one rowsum equation since if all but one column
 410  * and rowsum are equal, the last one must also be equal. Walras' Law
 411  * at work.
 412   
 413   ROWSUM(ii)$(NOT SAMEAS(ii,"ROW"))..   SUM(jj, TSAM(ii,jj)) =E= Y(ii) ;
 414   
 415   COLSUM(jj)..     SUM(ii, TSAM(ii,jj)) =E= (X(jj) + ERR1(jj)) ;
 416   
 417  *ADDITIONAL MACRO CONTROL-TOTAL EQUATIONS===========================
 418   
 419   GDPFCDEF..         GDPFC =E= TSAM("fac","act") + ERR2("gdpfc2") ;
 420   
 421   GDPDEF..           GDP   =E= TSAM("fac","act") + TSAM("gre","act")
 422                               - TSAM("act","gre") + TSAM("gre","com")
 423                               + ERR2("gdp2") ;
 424   
 425   ERROR2EQ(macro)..  ERR2(macro)
 426                            =E= SUM(jwt, W2(macro,jwt)*vbar2(macro,jwt)) ;
 427   
 428   SUMW2(macro)..     SUM(jwt, W2(macro,jwt)) =E= 1 ;
 429   
 430  *###############  Define bounds for cell values  ####################
 431   
 432  * Defining equation SAMMAKE over non-zero elements of A ($Abar1(ii,jj))
 433  * guarantees that the zero structure of the original SAM is maintained
 434  * in the estimated SAM. Fixing all the zero entries to zero greatly
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:05:51 Page 10
Cross Entropy SAM Estimation (CESAM,SEQ=228)
C o m p i l a t i o n


 435  * reduces the size of the estimation problem. If it is desired to
 436  * allow a zero entry to become nonzero in the estimated SAM, then
 437  * the condition $ABAR1(ii,jj) must be replaced with a new set that
 438  * does not include cells which are currently zero but may be nonzero.
 439   
 440   A.LO(ii,jj)$nonzero(ii,jj)          = 0 ;
 441   A.UP(ii,jj)$nonzero(ii,jj)          = 1 ;
 442   A.FX(ii,jj)$(NOT nonzero(ii,jj))    = 0;
 443   
 444   TSAM.lo(ii,jj)                      = 0.0 ;
 445   TSAM.up(ii,jj)                      = +inf ;
 446   TSAM.FX(ii,jj)$(NOT nonzero(ii,jj)) = 0 ;
 447   
 448  * Upper and lower bounds on the error weights
 449   W1.LO(ii,jwt)                       = 0   ;
 450   W1.UP(ii,jwt)                       = 1   ;
 451   W2.LO(macro,jwt)                    = 0   ;
 452   W2.UP(macro,jwt)                    = 1   ;
 453   
 454  * Set target column sums, X. If these are not fixed, then the column sum
 455  * constraints will not be binding and the solution values or ERR1 will
 456  * be 0.
 457   
 458    X.FX(ii)                            = TARGET0(ii) ;
 459   
 460  * Fix Macro aggregates.
 461  * If these are not fixed, then the macro constraints will not be binding
 462  * and the solution values of ERR2 will be zero.
 463    GDP.FX                = GDP0 ;
 464    GDPFC.FX              = GDPFC0 ;
 465   
 466  *######################## DEFINE MODEL ############################
 467   
 468   MODEL SAMENTROP / ALL /
 469   
 470  *######################## SOLVE MODEL #############################
 471   
 472   OPTION ITERLIM       = 5000;
 473   OPTION LIMROW        = 0,   LIMCOL    = 0;
 474   OPTION SOLPRINT      = ON;
 475   
 476   
 477  * SAMENTROP.optfile   = 1 ;
 478    SAMENTROP.HOLDFIXED = 1 ;
 479  * OPTION NLP          = CONOPT;
 480  * SAMENTROP.WORKSPACE = 25.0;
 481   
 482  *########################### Solve statenment ######################
 483   
 484    SOLVE SAMENTROP using NLP minimizing dentropy ;
 485   
 486  *###################################################################
 487   
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:05:51 Page 11
Cross Entropy SAM Estimation (CESAM,SEQ=228)
C o m p i l a t i o n


 488   
 489   
 490  *##(alternative formulation)#### MCP Formulation ##################
 491   
 492  * Add code restating the nonlinear-programming (NLP) minimization
 493  * problem as an MCP problem solved using the MCP solver.
 494  *
 495  * The code below is a translation of the NLP problem into a
 496  * mixed complementarity problem (MCP), which can be solved
 497  * using an MCP solver in GAMS. The translation was done using
 498  * a preliminary version of a program called NLP2MCP written
 499  * by Michael Ferris and Jeffrey Horn (1998) at the University
 500  * of Wisconsin. The translation adds "shadow price" or
 501  * complementarity variables for all constraint equations and
 502  * also provides equations for all the first-order conditions
 503  * for minimizing the objective function. The resulting model
 504  * is square with as many variables as equations.
 505   
 506  alias(macro,a_macro);
 507  alias(ii,a_ii);
 508  alias(jj,a_jj);
 509  alias(jwt,a_jwt);
 510   
 511   
 512  *#####  "SHADOW PRICE" OR COMPLEMENTARITY VARIABLES OR   ##########
 513  *##### LAGRANGE MULTIPLIERS FOR ALL CONSTRAINT EQUATIONS ##########
 514   
 515  variables
 516    m_SAMEQ(i)         Multiplier for row and column sum constraint
 517    m_SAMMAKE(i,j)     Multiplier for make SAM flows constraint
 518    m_ERROR1EQ(i)      Multiplier for definition of error term 1
 519    m_ERROR2EQ(macro)  Multiplier for definition of error term 2
 520    m_SUMW1(i)         Multiplier for Sum of weights 1 constraint
 521    m_SUMW2(macro)     Multiplier for Sum of weights 1 constraint
 522    m_ROWSUM(i)        Multiplier for row target constraint
 523    m_COLSUM(j)        Multiplier for column target constraint
 524    m_GDPFCDEF         Multiplier for GDP at factor cost constraint
 525    m_GDPDEF           Multiplier for GDP at market pricesconstraint
 526  ;
 527   
 528  *############# EQUATIONS FOR THE FIRST ORDER CONDITIONS ############
 529  *############# FOR MINIMIZING THE OBJECTIVE FUNCTION    ############
 530   
 531  EQUATIONS
 532    d_A(a_ii,a_jj)        FOC wrt the choice variable A
 533    d_TSAM(a_ii,a_jj)     FOC wrt the variable TSAM
 534    d_Y(a_ii)             FOC wrt the variable Y
 535    d_X(a_ii)             FOC wrt the variable X
 536    d_ERR1(a_ii)          FOC wrt the variable ERR1
 537    d_ERR2(a_macro)       FOC wrt the variable ERR2
 538    d_W1(a_ii,a_jwt)      FOC wrt the choice variable W1
 539    d_W2(a_macro,a_jwt)   FOC wrt the choice variable W2
 540    d_GDPFC               FOC wrt the macro control variable GDPFC
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:05:51 Page 12
Cross Entropy SAM Estimation (CESAM,SEQ=228)
C o m p i l a t i o n


 541    d_GDP                 FOC wrt the macro control variable GDP
 542  ;
 543   
 544   
 545  *##### EQUATION: FOC wrt the choice variable A  #################
 546  d_A(a_ii,a_jj) ..
 547   
 548   ((log(a(a_ii,a_jj)+epsilon)-log(abar1(a_ii,a_jj)+epsilon))
 549   $(nonzero(a_ii,a_jj)) + a(a_ii,a_jj)*(1/(a(a_ii,a_jj)+epsilon))
 550   $(nonzero(a_ii,a_jj)))-
 551   
 552   SUM((ii,jj)$(nonzero(ii,jj)),m_sammake(ii,jj)*(-(1$((sameas
 553   (a_ii,ii) and sameas(a_jj,jj))))*(x(jj)+err1(jj)))) =e= 0;
 554   
 555   
 556  *##### EQUATION: FOC wrt the variable TSAM ######################
 557  d_TSAM(a_ii,a_jj) .. -
 558   
 559   m_gdpfcdef*(-(1$((sameas(a_ii,"fac") and sameas(a_jj,"act"
 560   )))))-
 561   
 562   m_colsum(a_jj)-
 563   
 564   m_gdpdef*(-(1$((sameas(a_ii,"fac") and sameas(a_jj,"act"))
 565   )+1$((sameas(a_ii,"gre") and sameas(a_jj,"act")))-(1$((sameas
 566   (a_ii,"act") and sameas(a_jj,"gre"))))+1$((sameas(a_ii,"gre"
 567   ) and sameas(a_jj,"com")))))-
 568   
 569   m_rowsum(a_ii)$((not sameas(a_ii,"ROW")))-
 570   
 571   m_sammake(a_ii,a_jj)$(nonzero(a_ii,a_jj)) =e= 0;
 572   
 573   
 574  *##### EQUATION: FOC wrt the variable Y #########################
 575  d_Y(a_ii) .. -
 576   
 577   m_sameq(a_ii)-
 578   
 579   SUM((ii)$((not sameas(ii,"ROW"))),m_rowsum(ii)*(-(1$((sameas
 580   (a_ii,ii))))))
 581   
 582   =e= 0;
 583   
 584  *##### EQUATION FOC wrt the variable X ##########################
 585  d_X(a_ii) .. -
 586   
 587   SUM(jj,m_colsum(jj)*(-(1$((sameas(a_ii,jj))))))-
 588   
 589   SUM(ii,m_sameq(ii)*(-(1$((sameas(a_ii,ii))))))-
 590   
 591   SUM((ii,jj)$(nonzero(ii,jj)),m_sammake(ii,jj)*(-a(ii,jj)*(1
 592   $((sameas(a_ii,jj)))))) =e= 0;
 593   
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:05:51 Page 13
Cross Entropy SAM Estimation (CESAM,SEQ=228)
C o m p i l a t i o n


 594  *##### EQUATION: FOC wrt the variable ERR1 ######################
 595  d_ERR1(a_ii) .. -
 596   
 597   m_error1eq(a_ii)-
 598   
 599   SUM(jj,m_colsum(jj)*(-(1$((sameas(a_ii,jj))))))-
 600   
 601   SUM(ii,m_sameq(ii)*(-(1$((sameas(a_ii,ii))))))-
 602   
 603   SUM((ii,jj)$(nonzero(ii,jj)),m_sammake(ii,jj)*(-a(ii,jj)*(1
 604   $((sameas(a_ii,jj))))))
 605   
 606   =e= 0;
 607   
 608  *##### EQUATION: FOC wrt the variable ERR2 ######################
 609  d_ERR2(a_macro) .. -
 610   
 611   m_error2eq(a_macro)-
 612   
 613   m_gdpfcdef*(-(1$((sameas(a_macro,"gdpfc2")))))-
 614   
 615   m_gdpdef*(-(1$((sameas(a_macro,"gdp2")))))
 616   
 617   =e= 0;
 618   
 619  *##### EQUATION: FOC wrt the choice variable W1 #################
 620  d_W1(a_ii,a_jwt) .. ((log(w1(a_ii,a_jwt)+epsilon)-log(wbar1(a_ii
 621   ,a_jwt)+epsilon))+w1(a_ii,a_jwt)*(1/(w1(a_ii,a_jwt)+epsilon)))-
 622   
 623   SUM(ii,m_error1eq(ii)*(-(vbar1(ii,a_jwt)$(sameas(a_ii,ii))
 624   )))-
 625   
 626   m_sumw1(a_ii)
 627   
 628   =e= 0;
 629   
 630  *##### EQUATION: FOC wrt the choice variable W2 #################
 631  d_W2(a_macro,a_jwt) .. ((log(w2(a_macro,a_jwt)+epsilon)-log(wbar2
 632   (a_macro,a_jwt)+epsilon))+w2(a_macro,a_jwt)*(1/(w2(a_macro,a_jwt
 633   )+epsilon)))-
 634   
 635   SUM(macro,m_error2eq(macro)*(-(vbar2(macro,a_jwt)$(sameas(a_macro
 636   ,macro)))))-
 637   
 638   m_sumw2(a_macro)
 639   
 640   =e= 0;
 641   
 642  *##### EQUATION: FOC wrt the macro control variable GDPFC #######
 643  d_GDPFC .. -
 644   
 645   m_gdpfcdef =e= 0;
 646   
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:05:51 Page 14
Cross Entropy SAM Estimation (CESAM,SEQ=228)
C o m p i l a t i o n


 647  *##### EQUATION: FOC wrt the macro control variable GDP #########
 648  d_GDP .. -
 649   
 650   m_gdpdef =e= 0;
 651   
 652  *######################## DEFINE MODEL ############################
 653  * In GAMS the "." is used for pairing the complementarity variables
 654  * and equations for the MCP solver. For example the equation
 655  * defined by d_A is complementary to the variable A and must be
 656  * defined over the same sets.
 657   
 658   MODEL m_SAMENTROP /
 659      d_A.A
 660      d_TSAM.TSAM
 661      d_Y.Y
 662      d_X.X
 663      d_ERR1.ERR1
 664      d_ERR2.ERR2
 665      d_W1.W1
 666      d_W2.W2
 667      d_GDPFC.GDPFC
 668      d_GDP.GDP
 669      ERROR1EQ.m_ERROR1EQ
 670      ERROR2EQ.m_ERROR2EQ
 671      GDPFCDEF.m_GDPFCDEF
 672      COLSUM.m_COLSUM
 673      SAMEQ.m_SAMEQ
 674      GDPDEF.m_GDPDEF
 675      SUMW1.m_SUMW1
 676      ROWSUM.m_ROWSUM
 677      SUMW2.m_SUMW2
 678      SAMMAKE.m_SAMMAKE
 679                      /
 680   ;
 681   
 682  *############################ SOLVE MODEL #########################
 683   
 684  *Shock the NLP solution
 685   A.L(ii,jj) = 0.9*A.l(ii,jj) ;
 686   
 687  *########################### Solve statenment #####################
 688   
 689    SOLVE m_SAMENTROP using mcp;
 690   
 691  **#################################################################
 692   
 693  *Compare NLP and MCP results.
 694   Scalar savedent ;
 695   savedent = dentropy.l ;
 696   
 697  DENTROPY.l   = SUM((ii,jj)$nonzero(ii,jj),
 698                                A.l(ii,jj)*(LOG(A.l(ii,jj) + epsilon)
 699                               - LOG(Abar1(ii,jj) + epsilon)))
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:05:51 Page 15
Cross Entropy SAM Estimation (CESAM,SEQ=228)
C o m p i l a t i o n


 700                               +
 701                                 SUM((ii,jwt), W1.l(ii,jwt)
 702                               * (LOG(W1.l(ii,jwt) + epsilon)
 703                               - LOG(wbar1(ii,jwt) + epsilon)))
 704                               +
 705                                 SUM((macro,jwt), W2.l(macro,jwt)
 706                               * (LOG(W2.l(macro,jwt) + epsilon)
 707                               - LOG(wbar2(macro,jwt) + epsilon))) ;
 708   
 709   option decimals=8 ;
 710   display dentropy.l, savedent ;
 711   option decimals=3 ;
 712   
 713  *###################### END MCP INCLUDE FILE ######################
 714   
 715   
 716   
 717   
 718  *###### NOTE ON THE USE OF "SAMEAS" GAMS COMMAND ##################
 719  *######   Undocumented Feature IN GAMS Manual    ##################
      Matching Set Elements
       
      New features in GAMS allow one to introduce conditional statements
      controlling execution in cases where certain items match up . The
      syntax involves using the commands
       
        SAMEAS(setelement1,setelement2)
                    or
        DIAG(setelement,setelement)
       
      the SAMEAS command returns a true false indicator which is true
      if the text string defining the name of set element 1 equals that
      for setelement 2 and false otherwise. DIAG returns a 1 under
      equality and a zero otherwise.
       
      For example
        x=sum((i,j)$(not SAMEAS(i,j)),z(i)*z(j));
                         or
        x=sum((i,j)$(DIAG(i,j) eq 0),z(i)*z(j));
       
      would exclude the cases where i=j from the sum
       
      while
        x=sum((i,j)$(SAME AS(i,"case1") or SAME AS(j,"case2")),z(i)+z(j));
       
      would only include cases where the text for i equaled the string
      "case1" or the text for j corresponded to "case2."
       
      If interested check the following web address Undocumented Features
      and Usage Tips
       
       http://agrinet.tamu.edu/mccarl/gamstip.htm
       
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:05:51 Page 16
Cross Entropy SAM Estimation (CESAM,SEQ=228)
C o m p i l a t i o n


 755   
 756  *############### END Note on "SAMEAS" GAMS command ################
 757  *###################################################################
 758   
 759   
 760  *---------------- Parameters for reporting results
 761  Parameters
 762   Macsam1(i,j)       Assigned new balanced SAM flows from CE
 763   Macsam2(i,j)       Balanced SAM flows from entropy diff x scalesam
 764   SEM                Squared Error Measure
 765   percent1(i,j)      percent change of new SAM from original SAM
 766   PosUnbal(i,j)      Positive unbalanced SAM
 767   PosBalan(i,j)      Positive balanced SAM
 768   Diffrnce(i,j)      Differnce btw original SAM and Final SAM in values
 769   NormEntrop         Normalized Entropy a measure of total uncertainty
 770   ;
 771   
 772   macsam1(ii,jj)         = TSAM.l(ii,jj);
 773   macsam1("total",jj)    = SUM(ii, macsam1(ii,jj)) ;
 774   macsam1(ii,"total")    = SUM(jj, macsam1(ii,jj)) ;
 775   macsam2(i,j)           = macsam1(i,j) * scalesam ;
 776   SEM                    = Sum((ii,jj), SQR(A.L(ii,jj)
 777                                        - Abar1(ii,jj)))/SQR(card(ii));
 778   percent1(i,j)$(T1(i,j))= 100*(macsam1(i,j)-T1(i,j))/T1(i,j);
 779   PosUnbal(i,j)          = T1(i,j) * scalesam;
 780   PosBalan(i,j)          = macsam2(i,j);
 781   Diffrnce(i,j)          = PosBalan(i,j) - PosUnbal(i,j);
 782   NormEntrop             = SUM((ii,jj)$(Abar1(ii,jj)), A.L(ii,jj)*
 783                            LOG (A.L(ii,jj))) / SUM((ii,jj)$(Abar1(ii,jj)),
 784                            Abar1(ii,jj)* LOG (Abar1(ii,jj)))
 785   ;
 786   display macsam1, macsam2, percent1, sem, dentropy.l, PosUnbal,
 787           PosBalan, NormEntrop, Diffrnce ;
 788   
 789  *########### Return negative flows to initial cell position ############
 790   
 791   macsam1(ii,jj)         = macsam1(ii,jj) + redsam(ii,jj) ;
 792   macsam1("total",jj)    = SUM(ii, macsam1(ii,jj)) ;
 793   macsam1(ii,"total")    = SUM(jj, macsam1(ii,jj)) ;
 794   macsam2(i,j)           = macsam1(i,j) * scalesam ;
 795   
 796   gdp00                  = macsam1("fac","act") + macsam1("gre","act")
 797                            - macsam1("act","gre") + macsam1("gre","com") ;
 798   
 799   display macsam1, macsam2 ;
 800   display gdp0, gdp00, gdp.l, gdpfc0, gdpfc.l ;
 801   
 802  *#######
 803   Parameter ANEW(i,j) ;
 804  * print some stuff
 805   ANEW("total",jj)   = SUM(ii, A.L(ii,jj)) ;
 806   ANEW(ii,"total")   = SUM(jj, A.L(ii,jj)) ;
 807   
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:05:51 Page 17
Cross Entropy SAM Estimation (CESAM,SEQ=228)
C o m p i l a t i o n


 808   ABAR1("total",jj) = SUM(ii, ABAR1(ii,jj)) ;
 809   ABAR1(ii,"total") = SUM(jj, ABAR1(ii,jj)) ;
 810   
 811   Display ANEW, ABAR1 ;
 812   
 813   scalar meanerr1, meanerr2 ;
 814   meanerr1 = SUM(ii, abs(err1.l(ii)))/card(ii) ;
 815   meanerr2 = SUM(macro, abs(err2.l(macro)))/card(macro) ;
 816   display meanerr1, meanerr2 ;
 817   
 818  * Use the following code to specify that the column sums are known
 819  * exactly. The errors are thus fixed to zero and two equations are
 820  * dropped from the estimation procedure. The computational gains are
 821  * that the constraints are all linear and the estimation problem is
 822  * considerably smaller.
 823   
 824  *######
      *######
       
       ERR1.FX(ii)       = 0.0 ;
       W1.FX(ii,jwt)     = WBAR1(ii,jwt) ;
       
       MODEL SAMENTROP2 /SAMEQ
                        SAMMAKE
      *                 ERROR1EQ
      *                 SUMW1
                        ERROR2EQ
                        SUMW2
                        ENTROPY
                        ROWSUM
                        COLSUM
                        GDPFCDEF
                        GDPDEF
                                 /
      ;
       SAMENTROP2.holdfixed = 1 ;
       
      *######################### Solve statenment ###################
       
       SOLVE SAMENTROP2 using nlp minimizing dentropy ;
       
      *##############################################################
       
      *#######
 854  *#######
 855   
 856  *#*#*#*#*#*#*#*#*#*#*#*#* THE END *#*#*#*#*#*#*#*#*#*#*#*#*#*#*


COMPILATION TIME     =        0.005 SECONDS      3 MB  24.7.4 r58773 LEX-LEG
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:05:51 Page 18
Cross Entropy SAM Estimation (CESAM,SEQ=228)
E x e c u t i o n


----    169 PARAMETER T0  Matrix of SAM transactions (flow matrix)

              ACT         COM         FAC         ENT         HOU         GRE         GIN         CAP         ROW       TOTAL

ACT                    14.827                               2.101 -3.27000E-4                               1.488      18.416
COM         7.918                                           6.953       1.564       2.519       2.598                  21.552
FAC         9.805                                                                                                       9.805
ENT                                 3.700                               0.033                                           3.733
HOU                                 6.031       3.418                   0.030                               0.210       9.688
GRE         0.734       0.357       0.074       0.165       0.140                                                       1.470
GIN                                                                                                         1.712       1.712
CAP                                             0.150       0.649      -0.357      -0.406                   2.164       2.200
ROW                     5.574                                                                                           5.574
TOTAL      18.457      20.759       9.805       3.733       9.843       1.270       2.112       2.598       5.574


----    169 PARAMETER Abar0  Prior SAM coefficient matrix

            ACT         COM         FAC         ENT         HOU         GRE         GIN         CAP         ROW

ACT                   0.714                               0.213 -2.57460E-4                               0.267
COM       0.429                                           0.706       1.232       1.192       1.000
FAC       0.531
ENT                               0.377                               0.026
HOU                               0.615       0.916                   0.023                               0.038
GRE       0.040       0.017       0.008       0.044       0.014
GIN                                                                                                       0.307
CAP                                           0.040       0.066      -0.281      -0.192                   0.388
ROW                   0.269


----    221 NON-NEGATIVE SAM

----    222 PARAMETER redsam  Negative SAM values only

              ACT         GRE         GIN         CAP       TOTAL

ACT               -3.27000E-4                         -3.27000E-4
GRE   -3.27000E-4                              -0.357      -0.357
GIN                                            -0.406      -0.406
CAP                    -0.357      -0.406                  -0.763
TOTAL -3.27000E-4      -0.357      -0.406      -0.763


----    222 PARAMETER T1  SAM transactions Adjusted to eliminate negative entries

              ACT         COM         FAC         ENT         HOU         GRE         GIN         CAP         ROW       TOTAL

ACT                    14.827                               2.101                                           1.488      18.417
COM         7.918                                           6.953       1.564       2.519       2.598                  21.552
FAC         9.805                                                                                                       9.805
ENT                                 3.700                               0.033                                           3.733
HOU                                 6.031       3.418                   0.030                               0.210       9.688
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:05:51 Page 19
Cross Entropy SAM Estimation (CESAM,SEQ=228)
E x e c u t i o n


        222 PARAMETER T1  SAM transactions Adjusted to eliminate negative entries

              ACT         COM         FAC         ENT         HOU         GRE         GIN         CAP         ROW       TOTAL

GRE         0.734       0.357       0.074       0.165       0.140                               0.357                   1.827
GIN                                                                                             0.406       1.712       2.119
CAP                                             0.150       0.649                                           2.164       2.963
ROW                     5.574                                                                                           5.574
TOTAL      18.457      20.759       9.805       3.733       9.843       1.627       2.519       3.361       5.574


----    222 PARAMETER Abar0  Prior SAM coefficient matrix

            ACT         COM         FAC         ENT         HOU         GRE         GIN         CAP         ROW

ACT                   0.714                               0.213 -2.57460E-4                               0.267
COM       0.429                                           0.706       1.232       1.192       1.000
FAC       0.531
ENT                               0.377                               0.026
HOU                               0.615       0.916                   0.023                               0.038
GRE       0.040       0.017       0.008       0.044       0.014
GIN                                                                                                       0.307
CAP                                           0.040       0.066      -0.281      -0.192                   0.388
ROW                   0.269


----    222 PARAMETER Abar1  Prior SAM adjusted to eliminate negative coefficients

            ACT         COM         FAC         ENT         HOU         GRE         GIN         CAP         ROW

ACT                   0.714                               0.213                                           0.267
COM       0.429                                           0.706       0.962       1.000       0.773
FAC       0.531
ENT                               0.377                               0.020
HOU                               0.615       0.916                   0.018                               0.038
GRE       0.040       0.017       0.008       0.044       0.014                               0.106
GIN                                                                                           0.121       0.307
CAP                                           0.040       0.066                                           0.388
ROW                   0.269


----    222 PARAMETER rtot  Row total

ACT 18.417,    COM 21.552,    FAC  9.805,    ENT  3.733,    HOU  9.688,    GRE  1.827,    GIN  2.119,    CAP  2.963,    ROW  5.574


----    222 PARAMETER ctot  Column total

ACT 18.457,    COM 20.759,    FAC  9.805,    ENT  3.733,    HOU  9.843,    GRE  1.627,    GIN  2.519,    CAP  3.361,    ROW  5.574


----    240 PARAMETER gdpfc0               =        9.805  GDP at factor cost
            PARAMETER gdp0                 =       10.897  base GDP
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:05:51 Page 20
Cross Entropy SAM Estimation (CESAM,SEQ=228)
E x e c u t i o n


----    339 PARAMETER vbar1  Error support set 1

              1           2           4           5

ACT      -2.766      -0.922       0.922       2.766
COM      -3.173      -1.058       1.058       3.173
FAC      -1.471      -0.490       0.490       1.471
ENT      -0.560      -0.187       0.187       0.560
HOU      -1.465      -0.488       0.488       1.465
GRE      -0.259      -0.086       0.086       0.259
GIN      -0.348      -0.116       0.116       0.348
CAP      -0.474      -0.158       0.158       0.474
ROW      -0.836      -0.279       0.279       0.836


----    339 PARAMETER vbar2  Error support set 2

                 1           2           4           5

gdpfc2      -1.471      -0.490       0.490       1.471
gdp2        -1.635      -0.545       0.545       1.635


----    339 PARAMETER sigmay1  Prior standard error of column sums

ACT 0.922,    COM 1.058,    FAC 0.490,    ENT 0.187,    HOU 0.488,    GRE 0.086,    GIN 0.116,    CAP 0.158,    ROW 0.279


----    339 PARAMETER sigmay2  Prior standard error of macro aggregates

gdpfc2 0.490,    gdp2   0.545

GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:05:51 Page 21
Cross Entropy SAM Estimation (CESAM,SEQ=228)
Model Statistics    SOLVE SAMENTROP Using NLP From line 484


MODEL STATISTICS

BLOCKS OF EQUATIONS          11     SINGLE EQUATIONS           78
BLOCKS OF VARIABLES           8     SINGLE VARIABLES          130
NON ZERO ELEMENTS           368     NON LINEAR N-Z            136
DERIVATIVE POOL              20     CONSTANT POOL              56
CODE LENGTH                 683


GENERATION TIME      =        0.002 SECONDS      4 MB  24.7.4 r58773 LEX-LEG


EXECUTION TIME       =        0.004 SECONDS      4 MB  24.7.4 r58773 LEX-LEG
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:05:51 Page 22
Cross Entropy SAM Estimation (CESAM,SEQ=228)
Solution Report     SOLVE SAMENTROP Using NLP From line 484


               S O L V E      S U M M A R Y

     MODEL   SAMENTROP           OBJECTIVE  DENTROPY
     TYPE    NLP                 DIRECTION  MINIMIZE
     SOLVER  BARON               FROM LINE  484

**** SOLVER STATUS     3 Resource Interrupt        
**** MODEL STATUS      7 Feasible Solution         
**** OBJECTIVE VALUE                0.0096

 RESOURCE USAGE, LIMIT       1000.000      1000.000
 ITERATION COUNT, LIMIT         0          5000
 EVALUATION ERRORS              0             0

GAMS/BARON       24.7.4 r58773 Released Sep 19, 2016 LEG x86 64bit/Linux      

BARON is a product of The Optimization Firm, LLC. http://www.minlp.com/
Parts of the BARON software were created at the
University of Illinois at Urbana-Champaign.

--- Using Option File
*** Error Cannot open parameter file "/home/renigijus/gams/opt-mod-lib/gamslib/cesam/baron.opt"
*** Error Error code = 2; No such file or directory

===========================================================================
 BARON version 16.8.24. Built: LNX-64 Wed Aug 24 08:52:24 EDT 2016

 If you use this software, please cite:
 Tawarmalani, M. and N. V. Sahinidis, A polyhedral
 branch-and-cut approach to global optimization,
 Mathematical Programming, 103(2), 225-249, 2005.

 BARON is a product of The Optimization Firm, LLC. http://www.minlp.com/
 Parts of the BARON software were created at the
 University of Illinois at Urbana-Champaign.
===========================================================================
 This BARON run may utilize the following subsolver(s)
 For LP/MIP: ILOG CPLEX                                      
 For NLP: MINOS, SNOPT, GAMS external NLP, IPOPT, FILTERSD
===========================================================================

Solution      = 0.00958557821289189  found at node 136262
Best possible = -143.295806196
Absolute gap  = 143.305391774213  optca = 1E-9
Relative gap  = NA  optcr = 0.1
  (Note that BARON uses a different formula to compute the relative gap as
   was used for the above reported value.)

GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:05:51 Page 23
Cross Entropy SAM Estimation (CESAM,SEQ=228)
Solution Report     SOLVE SAMENTROP Using NLP From line 484


---- EQU SAMEQ  row and column sum constraint

           LOWER          LEVEL          UPPER

ACT        18.4367        18.4367        18.4367      
COM        21.1551        21.1551        21.1551      
FAC         9.8054         9.8054         9.8054      
ENT         3.7327         3.7327         3.7327      
HOU         9.7655         9.7655         9.7655      
GRE         1.7271         1.7271         1.7271      
GIN         2.3185         2.3185         2.3185      
CAP         3.1618         3.1618         3.1618      
ROW         5.5738         5.5738         5.5738      

---- EQU SAMMAKE  make SAM flows

               LOWER          LEVEL          UPPER

ACT.COM          .              .              .          
ACT.HOU          .              .              .          
ACT.ROW          .              .              .          
COM.ACT          .              .              .          
COM.HOU          .              .              .          
COM.GRE          .              .              .          
COM.GIN          .              .              .          
COM.CAP          .              .              .          
FAC.ACT          .              .              .          
ENT.FAC          .              .              .          
ENT.GRE          .              .              .          
HOU.FAC          .              .              .          
HOU.ENT          .              .              .          
HOU.GRE          .              .              .          
HOU.ROW          .              .              .          
GRE.ACT          .              .              .          
GRE.COM          .              .              .          
GRE.FAC          .              .              .          
GRE.ENT          .              .              .          
GRE.HOU          .              .              .          
GRE.CAP          .              .              .          
GIN.CAP          .              .              .          
GIN.ROW          .              .              .          
CAP.ENT          .              .              .          
CAP.HOU          .              .              .          
CAP.ROW          .              .              .          
ROW.COM          .              .              .          

---- EQU ERROR1EQ  definition of error term 1

           LOWER          LEVEL          UPPER

ACT          .              .              .          
COM          .              .              .          
FAC          .              .              .          
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:05:51 Page 24
Cross Entropy SAM Estimation (CESAM,SEQ=228)
Solution Report     SOLVE SAMENTROP Using NLP From line 484


     EQU ERROR1EQ  definition of error term 1

           LOWER          LEVEL          UPPER

ENT          .              .              .          
HOU          .              .              .          
GRE          .              .              .          
GIN          .              .              .          
CAP          .              .              .          
ROW          .              .              .          

---- EQU ERROR2EQ  definition of error term 2

              LOWER          LEVEL          UPPER

gdpfc2          .              .              .          
gdp2            .              .              .          

---- EQU SUMW1  Sum of weights 1

           LOWER          LEVEL          UPPER

ACT         1.0000         1.0000         1.0000      
COM         1.0000         1.0000         1.0000      
FAC         1.0000         1.0000         1.0000      
ENT         1.0000         1.0000         1.0000      
HOU         1.0000         1.0000         1.0000      
GRE         1.0000         1.0000         1.0000      
GIN         1.0000         1.0000         1.0000      
CAP         1.0000         1.0000         1.0000      
ROW         1.0000         1.0000         1.0000      

---- EQU SUMW2  Sum of weights 2

              LOWER          LEVEL          UPPER

gdpfc2         1.0000         1.0000         1.0000      
gdp2           1.0000         1.0000         1.0000      

                           LOWER          LEVEL          UPPER

---- EQU ENTROPY             .              .              .          

  ENTROPY  Entropy difference definition

---- EQU ROWSUM  row target

           LOWER          LEVEL          UPPER

ACT          .              .              .          
COM          .              .              .          
FAC          .              .              .          
ENT          .              .              .          
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:05:51 Page 25
Cross Entropy SAM Estimation (CESAM,SEQ=228)
Solution Report     SOLVE SAMENTROP Using NLP From line 484


     EQU ROWSUM  row target

           LOWER          LEVEL          UPPER

HOU          .              .              .          
GRE          .              .              .          
GIN          .              .              .          
CAP          .              .              .          

---- EQU COLSUM  column target

           LOWER          LEVEL          UPPER

ACT        18.4367        18.4367        18.4367      
COM        21.1551        21.1551        21.1551      
FAC         9.8054         9.8054         9.8054      
ENT         3.7327         3.7327         3.7327      
HOU         9.7655         9.7655         9.7655      
GRE         1.7271         1.7271         1.7271      
GIN         2.3185         2.3185         2.3185      
CAP         3.1618         3.1618         3.1618      
ROW         5.5738         5.5738         5.5738      

                           LOWER          LEVEL          UPPER

---- EQU GDPFCDEF          -9.8054        -9.8054        -9.8054      
---- EQU GDPDEF           -10.8967       -10.8967       -10.8967      

  GDPFCDEF  define GDP at factor cost
  GDPDEF  define GDP

---- VAR A  Post SAM coefficient matrix

               LOWER          LEVEL          UPPER

ACT.COM          .             0.7182         1.0000      
ACT.HOU          .             0.2025         1.0000      
ACT.ROW          .             0.2285         1.0000      
COM.ACT          .             0.4299         1.0000      
COM.HOU          .             0.7005         1.0000      
COM.GRE          .             0.9595         1.0000      
COM.GIN          .             1.0000         1.0000      
COM.CAP          .             0.7624         1.0000      
FAC.ACT          .             0.5320         1.0000      
ENT.FAC          .             0.3767         1.0000      
ENT.GRE          .             0.0214         1.0000      
HOU.FAC          .             0.6181         1.0000      
HOU.ENT          .             0.9221         1.0000      
HOU.GRE          .             0.0192         1.0000      
HOU.ROW          .             0.0394         1.0000      
GRE.ACT          .             0.0381         1.0000      
GRE.COM          .             0.0181         1.0000      
GRE.FAC          .             0.0051         1.0000      
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:05:51 Page 26
Cross Entropy SAM Estimation (CESAM,SEQ=228)
Solution Report     SOLVE SAMENTROP Using NLP From line 484


     VAR A  Post SAM coefficient matrix

               LOWER          LEVEL          UPPER

GRE.ENT          .             0.0384         1.0000      
GRE.HOU          .             0.0129         1.0000      
GRE.CAP          .             0.1019         1.0000      
GIN.CAP          .             0.1357         1.0000      
GIN.ROW          .             0.3388         1.0000      
CAP.ENT          .             0.0396         1.0000      
CAP.HOU          .             0.0841         1.0000      
CAP.ROW          .             0.3933         1.0000      
ROW.COM          .             0.2637         1.0000      

---- VAR TSAM  Post matrix of SAM transactions

               LOWER          LEVEL          UPPER

ACT.COM          .            15.1907        +INF         
ACT.HOU          .             1.9756        +INF         
ACT.ROW          .             1.2741        +INF         
COM.ACT          .             7.9284        +INF         
COM.HOU          .             6.8360        +INF         
COM.GRE          .             1.6571        +INF         
COM.GIN          .             2.3180        +INF         
COM.CAP          .             2.4102        +INF         
FAC.ACT          .             9.8099        +INF         
ENT.FAC          .             3.6958        +INF         
ENT.GRE          .             0.0369        +INF         
HOU.FAC          .             6.0637        +INF         
HOU.ENT          .             3.4417        +INF         
HOU.GRE          .             0.0331        +INF         
HOU.ROW          .             0.2197        +INF         
GRE.ACT          .             0.7022        +INF         
GRE.COM          .             0.3829        +INF         
GRE.FAC          .             0.0505        +INF         
GRE.ENT          .             0.1432        +INF         
GRE.HOU          .             0.1263        +INF         
GRE.CAP          .             0.3222        +INF         
GIN.CAP          .             0.4289        +INF         
GIN.ROW          .             1.8890        +INF         
CAP.ENT          .             0.1477        +INF         
CAP.HOU          .             0.8203        +INF         
CAP.ROW          .             2.1933        +INF         
ROW.COM          .             5.5761        +INF         

---- VAR Y  row sum of SAM

           LOWER          LEVEL          UPPER

ACT        -INF           18.4405        +INF         
COM        -INF           21.1497        +INF         
FAC        -INF            9.8099        +INF         
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:05:51 Page 27
Cross Entropy SAM Estimation (CESAM,SEQ=228)
Solution Report     SOLVE SAMENTROP Using NLP From line 484


     VAR Y  row sum of SAM

           LOWER          LEVEL          UPPER

ENT        -INF            3.7327        +INF         
HOU        -INF            9.7582        +INF         
GRE        -INF            1.7272        +INF         
GIN        -INF            2.3180        +INF         
CAP        -INF            3.1613        +INF         
ROW        -INF            5.5761        +INF         

---- VAR ERR1  Error value on column sums

           LOWER          LEVEL          UPPER

ACT        -INF            0.0038        +INF         
COM        -INF           -0.0054        +INF         
FAC        -INF            0.0045        +INF         
ENT        -INF      -3.925794E-5        +INF         
HOU        -INF           -0.0073        +INF         
GRE        -INF      7.2995664E-5        +INF         
GIN        -INF           -0.0005        +INF         
CAP        -INF           -0.0005        +INF         
ROW        -INF            0.0023        +INF         

---- VAR ERR2  Error value for macro aggregates

              LOWER          LEVEL          UPPER

gdpfc2        -INF           -0.0045        +INF         
gdp2          -INF            0.0018        +INF         

---- VAR W1  Error weights

             LOWER          LEVEL          UPPER

ACT.1          .             0.0137         1.0000      
ACT.2          .             0.3735         1.0000      
ACT.3          .             0.2222         1.0000      
ACT.4          .             0.3765         1.0000      
ACT.5          .             0.0141         1.0000      
COM.1          .             0.0141         1.0000      
COM.2          .             0.3769         1.0000      
COM.3          .             0.2222         1.0000      
COM.4          .             0.3731         1.0000      
COM.5          .             0.0137         1.0000      
FAC.1          .             0.0135         1.0000      
FAC.2          .             0.3716         1.0000      
FAC.3          .             0.2222         1.0000      
FAC.4          .             0.3784         1.0000      
FAC.5          .             0.0143         1.0000      
ENT.1          .             0.0139         1.0000      
ENT.2          .             0.3751         1.0000      
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:05:51 Page 28
Cross Entropy SAM Estimation (CESAM,SEQ=228)
Solution Report     SOLVE SAMENTROP Using NLP From line 484


     VAR W1  Error weights

             LOWER          LEVEL          UPPER

ENT.3          .             0.2222         1.0000      
ENT.4          .             0.3749         1.0000      
ENT.5          .             0.0139         1.0000      
HOU.1          .             0.0145         1.0000      
HOU.2          .             0.3806         1.0000      
HOU.3          .             0.2222         1.0000      
HOU.4          .             0.3694         1.0000      
HOU.5          .             0.0133         1.0000      
GRE.1          .             0.0139         1.0000      
GRE.2          .             0.3747         1.0000      
GRE.3          .             0.2222         1.0000      
GRE.4          .             0.3753         1.0000      
GRE.5          .             0.0139         1.0000      
GIN.1          .             0.0141         1.0000      
GIN.2          .             0.3768         1.0000      
GIN.3          .             0.2222         1.0000      
GIN.4          .             0.3732         1.0000      
GIN.5          .             0.0137         1.0000      
CAP.1          .             0.0140         1.0000      
CAP.2          .             0.3762         1.0000      
CAP.3          .             0.2222         1.0000      
CAP.4          .             0.3737         1.0000      
CAP.5          .             0.0138         1.0000      
ROW.1          .             0.0136         1.0000      
ROW.2          .             0.3719         1.0000      
ROW.3          .             0.2222         1.0000      
ROW.4          .             0.3781         1.0000      
ROW.5          .             0.0142         1.0000      

---- VAR W2  Error weights

                LOWER          LEVEL          UPPER

gdpfc2.1          .             0.0143         1.0000      
gdpfc2.2          .             0.3784         1.0000      
gdpfc2.3          .             0.2222         1.0000      
gdpfc2.4          .             0.3716         1.0000      
gdpfc2.5          .             0.0135         1.0000      
gdp2  .1          .             0.0138         1.0000      
gdp2  .2          .             0.3738         1.0000      
gdp2  .3          .             0.2222         1.0000      
gdp2  .4          .             0.3762         1.0000      
gdp2  .5          .             0.0140         1.0000      

                           LOWER          LEVEL          UPPER

---- VAR DENTROPY          -INF            0.0096        +INF         

  DENTROPY  Entropy difference (objective)
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:05:51 Page 29
Cross Entropy SAM Estimation (CESAM,SEQ=228)
Solution Report     SOLVE SAMENTROP Using NLP From line 484


**** REPORT SUMMARY :        0     NONOPT
                             0 INFEASIBLE
                             0  UNBOUNDED
                             0     ERRORS
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:05:51 Page 30
Cross Entropy SAM Estimation (CESAM,SEQ=228)
Model Statistics    SOLVE m_SAMENTROP Using MCP From line 689


MODEL STATISTICS

BLOCKS OF EQUATIONS          20     SINGLE EQUATIONS          271
BLOCKS OF VARIABLES          20     SINGLE VARIABLES          271
NON ZERO ELEMENTS         1,056     NON LINEAR N-Z            352
DERIVATIVE POOL              20     CONSTANT POOL              17
CODE LENGTH               1,479


GENERATION TIME      =        0.004 SECONDS      3 MB  24.7.4 r58773 LEX-LEG


EXECUTION TIME       =        0.006 SECONDS      3 MB  24.7.4 r58773 LEX-LEG
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:05:51 Page 31
Cross Entropy SAM Estimation (CESAM,SEQ=228)
Solution Report     SOLVE m_SAMENTROP Using MCP From line 689


               S O L V E      S U M M A R Y

     MODEL   m_SAMENTROP         
     TYPE    MCP                 
     SOLVER  CONVERT             FROM LINE  689

**** SOLVER STATUS     1 Normal Completion         
**** MODEL STATUS      14 No Solution Returned     

 RESOURCE USAGE, LIMIT          0.000      1000.000
 ITERATION COUNT, LIMIT         0          5000
 EVALUATION ERRORS              0             0

Convert 2.0      24.7.4 r58773 Released Sep 19, 2016 LEG x86 64bit/Linux      

--- Using Option File
Reading parameter(s) from "/home/renigijus/gams/opt-mod-lib/gamslib/cesam/convert.opt"
>>  pyomo cesam-scalar.py
Finished reading from "/home/renigijus/gams/opt-mod-lib/gamslib/cesam/convert.opt"
Pyomo     : cesam-scalar.py


No solution returned
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:05:51 Page 32
Cross Entropy SAM Estimation (CESAM,SEQ=228)
E x e c u t i o n


----    710 VARIABLE DENTROPY.L            =  -0.84473876  Entropy difference (objective)
            PARAMETER savedent             =   0.00958558  

----    786 PARAMETER Macsam1  Assigned new balanced SAM flows from CE

              ACT         COM         FAC         ENT         HOU         GRE         GIN         CAP         ROW       TOTAL

ACT                    15.191                               1.976                                           1.274      18.441
COM         7.928                                           6.836       1.657       2.318       2.410                  21.150
FAC         9.810                                                                                                       9.810
ENT                                 3.696                               0.037                                           3.733
HOU                                 6.064       3.442                   0.033                               0.220       9.758
GRE         0.702       0.383       0.050       0.143       0.126                               0.322                   1.727
GIN                                                                                             0.429       1.889       2.318
CAP                                             0.148       0.820                                           2.193       3.161
ROW                     5.576                                                                                           5.576
TOTAL      18.441      21.150       9.810       3.733       9.758       1.727       2.318       3.161       5.576


----    786 PARAMETER Macsam2  Balanced SAM flows from entropy diff x scalesam

              ACT         COM         FAC         ENT         HOU         GRE         GIN         CAP         ROW       TOTAL

ACT                 15190.744                            1975.633                                        1274.139   18440.516
COM      7928.423                                        6835.984    1657.138    2317.950    2410.241               21149.737
FAC      9809.903                                                                                                    9809.903
ENT                              3695.768                              36.899                                        3732.667
HOU                              6063.666    3441.725                  33.136                             219.653    9758.180
GRE       702.189     382.858      50.470     143.199     126.298                             322.159                1727.173
GIN                                                                                           428.916    1889.034    2317.950
CAP                                           147.742     820.265                                        2193.309    3161.316
ROW                  5576.135                                                                                        5576.135
TOTAL   18440.516   21149.737    9809.903    3732.667    9758.180    1727.173    2317.950    3161.316    5576.135


----    786 PARAMETER percent1  percent change of new SAM from original SAM

              ACT         COM         FAC         ENT         HOU         GRE         GIN         CAP         ROW       TOTAL

ACT                     2.450                              -5.969                                         -14.381       0.130
COM         0.138                                          -1.688       5.921      -7.963      -7.220                  -1.865
FAC         0.046                                                                                                       0.046
ENT                                -0.106                              11.814                                          -0.001
HOU                                 0.536       0.709                  11.947                               4.846       0.725
GRE        -4.324       7.123     -32.165     -13.318      -9.464                              -9.677                  -5.469
GIN                                                                                             5.592      10.321       9.415
CAP                                            -1.505      26.359                                           1.361       6.693
ROW                     0.042                                                                                           0.042
TOTAL      -0.088       1.884       0.046      -0.001      -0.862       6.150      -7.963      -5.932       0.042


----    786 PARAMETER SEM                  =  7.612872E-4  Squared Error Measure
            VARIABLE DENTROPY.L            =       -0.845  Entropy difference (objective)
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:05:51 Page 33
Cross Entropy SAM Estimation (CESAM,SEQ=228)
E x e c u t i o n


----    786 PARAMETER PosUnbal  Positive unbalanced SAM

              ACT         COM         FAC         ENT         HOU         GRE         GIN         CAP         ROW       TOTAL

ACT                 14827.424                            2101.049                                        1488.157   18416.630
COM      7917.504                                        6953.332    1564.500    2518.500    2597.798               21551.634
FAC      9805.414                                                                                                    9805.414
ENT                              3699.706                              33.000                                        3732.706
HOU                              6031.308    3417.506                  29.600                             209.501    9687.915
GRE       733.927     357.400      74.400     165.200     139.500                             356.673                1827.100
GIN                                                                                           406.200    1712.300    2118.500
CAP                                           150.000     649.156                                        2163.857    2963.013
ROW                  5573.815                                                                                        5573.815
TOTAL   18456.845   20758.639    9805.414    3732.706    9843.037    1627.100    2518.500    3360.671    5573.815


----    786 PARAMETER PosBalan  Positive balanced SAM

              ACT         COM         FAC         ENT         HOU         GRE         GIN         CAP         ROW       TOTAL

ACT                 15190.744                            1975.633                                        1274.139   18440.516
COM      7928.423                                        6835.984    1657.138    2317.950    2410.241               21149.737
FAC      9809.903                                                                                                    9809.903
ENT                              3695.768                              36.899                                        3732.667
HOU                              6063.666    3441.725                  33.136                             219.653    9758.180
GRE       702.189     382.858      50.470     143.199     126.298                             322.159                1727.173
GIN                                                                                           428.916    1889.034    2317.950
CAP                                           147.742     820.265                                        2193.309    3161.316
ROW                  5576.135                                                                                        5576.135
TOTAL   18440.516   21149.737    9809.903    3732.667    9758.180    1727.173    2317.950    3161.316    5576.135


----    786 PARAMETER NormEntrop           =        1.057  Normalized Entropy a measure of total uncertainty

----    786 PARAMETER Diffrnce  Differnce btw original SAM and Final SAM in values

              ACT         COM         FAC         ENT         HOU         GRE         GIN         CAP         ROW       TOTAL

ACT                   363.320                            -125.416                                        -214.018      23.886
COM        10.919                                        -117.348      92.638    -200.550    -187.557                -401.897
FAC         4.489                                                                                                       4.489
ENT                                -3.938                               3.899                                          -0.039
HOU                                32.358      24.219                   3.536                              10.152      70.265
GRE       -31.738      25.458     -23.930     -22.001     -13.202                             -34.514                 -99.927
GIN                                                                                            22.716     176.734     199.450
CAP                                            -2.258     171.109                                          29.452     198.303
ROW                     2.320                                                                                           2.320
TOTAL     -16.329     391.098       4.489      -0.039     -84.857     100.073    -200.550    -199.355       2.320

GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:05:51 Page 34
Cross Entropy SAM Estimation (CESAM,SEQ=228)
E x e c u t i o n


----    799 PARAMETER Macsam1  Assigned new balanced SAM flows from CE

              ACT         COM         FAC         ENT         HOU         GRE         GIN         CAP         ROW       TOTAL

ACT                    15.191                               1.976 -3.27000E-4                               1.274      18.440
COM         7.928                                           6.836       1.657       2.318       2.410                  21.150
FAC         9.810                                                                                                       9.810
ENT                                 3.696                               0.037                                           3.733
HOU                                 6.064       3.442                   0.033                               0.220       9.758
GRE         0.702       0.383       0.050       0.143       0.126                              -0.035                   1.370
GIN                                                                                             0.023       1.889       1.912
CAP                                             0.148       0.820      -0.357      -0.406                   2.193       2.398
ROW                     5.576                                                                                           5.576
TOTAL      18.440      21.150       9.810       3.733       9.758       1.370       1.912       2.398       5.576


----    799 PARAMETER Macsam2  Balanced SAM flows from entropy diff x scalesam

              ACT         COM         FAC         ENT         HOU         GRE         GIN         CAP         ROW       TOTAL

ACT                 15190.744                            1975.633      -0.327                            1274.139   18440.189
COM      7928.423                                        6835.984    1657.138    2317.950    2410.241               21149.737
FAC      9809.903                                                                                                    9809.903
ENT                              3695.768                              36.899                                        3732.667
HOU                              6063.666    3441.725                  33.136                             219.653    9758.180
GRE       701.862     382.858      50.470     143.199     126.298                             -34.514                1370.173
GIN                                                                                            22.716    1889.034    1911.750
CAP                                           147.742     820.265    -356.673    -406.200                2193.309    2398.443
ROW                  5576.135                                                                                        5576.135
TOTAL   18440.189   21149.737    9809.903    3732.667    9758.180    1370.173    1911.750    2398.443    5576.135


----    800 PARAMETER gdp0                 =       10.897  base GDP
            PARAMETER gdp00                =       10.895  GDP from final SAM
            VARIABLE GDP.L                 =       10.897  GDP at market prices
            PARAMETER gdpfc0               =        9.805  GDP at factor cost
            VARIABLE GDPFC.L               =        9.805  GDP at factor cost

----    811 PARAMETER ANEW  

              ACT         COM         FAC         ENT         HOU         GRE         GIN         CAP         ROW       TOTAL

ACT                                                                                                                     1.034
COM                                                                                                                     3.467
FAC                                                                                                                     0.479
ENT                                                                                                                     0.358
HOU                                                                                                                     1.439
GRE                                                                                                                     0.193
GIN                                                                                                                     0.427
CAP                                                                                                                     0.465
ROW                                                                                                                     0.237
TOTAL       0.900       0.900       0.900       0.900       0.900       0.900       0.900       0.900       0.900

GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:05:51 Page 35
Cross Entropy SAM Estimation (CESAM,SEQ=228)
E x e c u t i o n


----    811 PARAMETER Abar1  Prior SAM adjusted to eliminate negative coefficients

              ACT         COM         FAC         ENT         HOU         GRE         GIN         CAP         ROW       TOTAL

ACT                     0.714                               0.213                                           0.267       1.195
COM         0.429                                           0.706       0.962       1.000       0.773                   3.870
FAC         0.531                                                                                                       0.531
ENT                                 0.377                               0.020                                           0.398
HOU                                 0.615       0.916                   0.018                               0.038       1.586
GRE         0.040       0.017       0.008       0.044       0.014                               0.106                   0.229
GIN                                                                                             0.121       0.307       0.428
CAP                                             0.040       0.066                                           0.388       0.494
ROW                     0.269                                                                                           0.269
TOTAL       1.000       1.000       1.000       1.000       1.000       1.000       1.000       1.000       1.000


----    816 PARAMETER meanerr1             =        0.003  
            PARAMETER meanerr2             =        0.003  


EXECUTION TIME       =        0.003 SECONDS      3 MB  24.7.4 r58773 LEX-LEG


USER: Remigijus Paulavicius, Single User License     S170731:0859AO-LNX
      Imperial College London, Dept. of Chemical Engineering    DC13449
      License for teaching and research at degree granting institutions


**** FILE SUMMARY

Input      /home/renigijus/gams/opt-mod-lib/gamslib/cesam/cesam.gms
Output     /home/renigijus/gams/opt-mod-lib/gamslib/cesam/cesam-scalar.py.lst
