GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:49:10 Page 1
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


   1  option MCP=convert;
   2  option MCP=convert;
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:49:10 Page 2
Cross Entropy SAM Estimation (CESAM,SEQ=228)
C o m p i l a t i o n


       CESAM illustrates a cross entropy technique for estimating the cells
       of a consistent SAM assuming that the initial data are inconsistent
       and measured with error. The method is applied to a stylized macro
       SAM for Mozambique. Some macro control totals are assumed known with
       error, and also all the row and column totals are assumed
       known only with error. We assume that the user can specify
       a prior estimate of the standard error of the estimates of the row
       and column sums and of the macro control totals.
       
       
      Robinson, S, Cattaneo, A, and El-Said, M, Updating and Estimating
      a Social Accounting Matrix Using Cross Enthropy Methods. Economic
      System Research 13, 1 (2001).
       
      Golan, G, Judge, G, and Miller, D, Maximum Enthropy Econometrics.
      John Wiley and Sons, 1996.
       
       Programmed by Sherman Robinson and Moataz El-Said, November 2000.
       Trade and Macroeconomics Division
       International Food Policy Research Institute (IFPRI)
       2033 K Street, N.W.
       Washington, DC 20006 USA
       Email: S.Robinson@CGIAR.ORG
              M.El-Said@CGIAR.ORG
       
       Data set is based on a SAM developed by C. Arndt, A. S. Cruz, H. T.
       Jensen, S. Robinson, and F. Tarp, "Social Accounting Matrices
       for Mozambique - 1994 and 1995." TMD Discussion Paper No. 28, IFPRI,
       July 1998.
       
       Original version programmed by Sherman Robinson and Andrea Cattaneo.
       
  38   
  39   
  40  SETS
  41   
  42   i      sam accounts   / ACT     Activities
  43                           COM     Commodities
  44                           FAC     Factors
  45                           ENT     Enterprises
  46                           HOU     Households
  47                           GRE     Govt recurrent expenditures
  48                           GIN     Govt investment
  49                           CAP     Capital account
  50                           ROW     Rest of world
  51                           TOTAL /
  52   
  53   ii(i)  all accounts in i except TOTAL
  54                         / ACT     Activities
  55                           COM     Commodities
  56                           FAC     Factors
  57                           ENT     Enterprises
  58                           HOU     Households
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:49:10 Page 3
Cross Entropy SAM Estimation (CESAM,SEQ=228)
C o m p i l a t i o n


  59                           GRE     Govt recurrent expenditures
  60                           GIN     Govt investment
  61                           CAP     Capital account
  62                           ROW     Rest of world /
  63   
  64   macro  macro controls  /gdpfc2, gdp2 /
  65   
  66  * The set jwt defines the dimension of the support set for the error
  67  * distribution and the number of weights that must be estimated for each
  68  * error. In this case, we specify a five parameter error distribution.
  69  * For a three parameter distribution, jwt is set to /1*3/.
  70   
  71   jwt    set of weights for errors in variables
  72                         / 1*5 /
  73  ;
  74   
  75  * ii(i)       = YES;
  76  * ii("Total") = NO;
  77   
  78  ALIAS (i,j), (ii,jj);
  79   
  80  *########################    SAM DATABASE       ########################
  81  TABLE SAM(i,j)  social accounting matrix
  82                         ACT            COM            FAC            ENT
  83  ACT                    0.0     14827.4240            0.0            0.0
  84  COM              7917.5040            0.0            0.0            0.0
  85  FAC              9805.4140            0.0            0.0            0.0
  86  ENT                    0.0            0.0      3699.7060            0.0
  87  HOU                    0.0            0.0      6031.3080      3417.5060
  88  GRE               733.6000       357.4000        74.4000       165.2000
  89  GIN                    0.0            0.0            0.0            0.0
  90  CAP                    0.0            0.0            0.0       150.0000
  91  ROW                    0.0      5573.8150            0.0            0.0
  92  Total           18456.5180      20758.639       9805.414       3732.706
  93   
  94    +                    HOU            GRE            GIN            CAP
  95  ACT              2101.0490        -0.3270            0.0            0.0
  96  *COM             6753.3320      1764.5000      2118.5000      2197.7980
  97  COM              6953.3320      1564.5000      2518.5000      2597.7980
  98  FAC                    0.0            0.0            0.0            0.0
  99  ENT                    0.0        33.0000            0.0            0.0
 100  HOU                    0.0        29.6000            0.0            0.0
 101  GRE               139.5000            0.0            0.0            0.0
 102  GIN                    0.0            0.0            0.0            0.0
 103  CAP               649.1560      -356.6730      -406.2000            0.0
 104  ROW                    0.0            0.0            0.0            0.0
 105  Total             9643.037         1470.1         1712.3       2197.798
 106   
 107    +                    ROW      Total
 108  ACT              1488.1570      18416.303
 109  COM                    0.0      20751.634
 110  FAC                    0.0       9805.414
 111  ENT                    0.0       3732.706
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:49:10 Page 4
Cross Entropy SAM Estimation (CESAM,SEQ=228)
C o m p i l a t i o n


 112  HOU               209.5010       9687.915
 113  GRE                    0.0         1470.1
 114  GIN              1712.3000         1712.3
 115  CAP              2163.8570        2200.14
 116  ROW                    0.0       5573.815
 117  Total             5573.815
 118       ;
 119   
 120  *#########################  Parameters and Scalars #####################
 121  PARAMETER
 122   
 123   SAM0(i,j)        Base SAM transactions matrix
 124   T0(i,j)          Matrix of SAM transactions (flow matrix)
 125   T1(i,j)          SAM transactions Adjusted to eliminate negative entries
 126   Abar0(i,j)       Prior SAM coefficient matrix
 127   Abar1(i,j)       Prior SAM adjusted to eliminate negative coefficients
 128   Target0(i)       Targets for macro SAM column totals
 129   vbar1(i,jwt)     Error support set 1
 130   vbar2(macro,jwt) Error support set 2
 131   wbar1(i,jwt)     Weights on error support set 1
 132   wbar2(macro,jwt) Weights on error support set 2
 133   sigmay1(i)       Prior standard error of column sums
 134   sigmay2(macro)   Prior standard error of macro aggregates
 135   epsilon          Tolerance to allow zero entries in SAM
 136  ;
 137   
 138  SCALARS
 139   
 140   gdp0          base GDP
 141   gdp00         GDP from final SAM
 142   gdpfc0        GDP at factor cost
 143  ;
 144   
 145  *################# Initializing Parameters
 146   SAM("TOTAL",jj)      = sum(ii, SAM(ii,jj));
 147   SAM(ii,"TOTAL")      = sum(jj, SAM(ii,jj));
 148   sam0(i,j)            = sam(i,j);
 149   
 150  *#################
 151  * Divide SAM entries by 1000 for better scaling.
 152  * The SAM is scaled to enhance solver efficiency. Nonlinear solvers are
 153  * more efficient if variables are scaled similarly. In this case,
 154  * coefficients to be estimated range between 0 and 1, so SAM values
 155  * are also scaled.
 156   
 157   Scalar scalesam Scaling value  /1000/ ;
 158   
 159   sam(i,j)                 = sam(i,j)/scalesam ;
 160   Abar0(ii,jj)$SAM(ii,jj)  = SAM(ii,jj)/SAM("TOTAL",jj) ;
 161   
 162   T0(ii,jj)                = SAM(ii,jj);
 163   T0("TOTAL",jj)           = sum(ii, SAM(ii,jj));
 164   T0(ii,"TOTAL")           = sum(jj, SAM(ii,jj));
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:49:10 Page 5
Cross Entropy SAM Estimation (CESAM,SEQ=228)
C o m p i l a t i o n


 165   
 166   epsilon                  = .00001;
 167   
 168   Display T0, Abar0 ;
 169  *########################  CROSS ENTROPY  ##############################
 170   
 171   
 172  *########################  RED ALERT!!!   ##############################
 173   
 174  * The ENTROPY DIFFERENCE procedure uses LOGARITHMS: negative flows in
 175  * the SAM are NOT GOOD!!!
 176  *
 177  * The option used here is to detect any negative flows and net them out
 178  * of their respective symmetric cells, e.g.
 179  *     negative flow column to row is set to zero
 180  *     and added to corresponding row to column as a positive number.
 181  * The entropy difference method can then be implemented.
 182  * After balancing, the negative SAM values are returned to their
 183  * original cells for printing.
 184   
 185  SET
 186   red(i,j)           Set of negative SAM flows
 187  ;
 188   
 189  Parameter
 190   redsam(i,j)        Negative SAM values only
 191   rtot(i)            Row total
 192   ctot(i)            Column total
 193  ;
 194   
 195   rtot(ii)                            = sum(jj, T0(ii,jj));
 196   ctot(jj)                            = sum(ii, T0(ii,jj));
 197   
 198   red(ii,jj)$(T0(ii,jj) LT 0)         = yes ;
 199   redsam(ii,jj)                       = 0;
 200   redsam(ii,jj)$red(ii,jj)            = T0(ii,jj);
 201   redsam(jj,ii)$red(ii,jj)            = T0(ii,jj);
 202   
 203  *Note that redsam includes each entry twice, in corresponding row
 204  *and column. So, redsam need only be subtracted from T0.
 205   T1(ii,jj)                           = T0(ii,jj) - redsam(ii,jj);
 206   T1("Total",jj)                      = sum(ii, T1(ii,jj));
 207   T1(ii,"Total")                      = sum(jj, T1(ii,jj));
 208   
 209   redsam("total",jj)                  = sum(ii, redsam(ii,jj));
 210   redsam(ii,"total")                  = sum(jj, redsam(ii,jj));
 211   
 212   sam(ii,"total")                     = sum(jj, T1(ii,jj));
 213   sam("total",jj)                     = sum(ii, T1(ii,jj));
 214   
 215   rtot(ii)                            = sum(jj, T1(ii,jj));
 216   ctot(jj)                            = sum(ii, T1(ii,jj));
 217   
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:49:10 Page 6
Cross Entropy SAM Estimation (CESAM,SEQ=228)
C o m p i l a t i o n


 218   Abar1(ii,jj)                        = T1(ii,jj)/sam("total",jj);
 219   
 220   display "NON-NEGATIVE SAM" ;
 221   display redsam, T1, Abar0, Abar1, rtot, ctot ;
 222   
 223  * Define set of elements of SAM that can be nonzero. In this case, only
 224  * elements which are nonzero in initial SAM.
 225   SET NONZERO(i,j)  SAM elements that can be nonzero ;
 226   
 227   NONZERO(ii,jj)$(Abar1(ii,jj)) = yes ;
 228   
 229  *#### Initializing Parameters after accounting for negative values #####
 230  *   Note that target column sums are being set to average of initial
 231  *   row and column sums. Initial column sums or other values
 232  *   could have been used instead, depending on knowledge of data quality
 233  *   and any other prior information.
 234   
 235   target0(ii)         = (sam(ii,"total") +  sam("total",ii))/2 ;
 236   gdpfc0              = T1("fac","act");
 237   gdp0                = T1("fac","act") + T1("gre","act")
 238                          - T1("act","gre") + T1("gre","com") ;
 239  Display gdpfc0, gdp0;
 240   
 241  *############### Define variable bounds on errors #####################
 242  * Start from assumed prior knowledge of the standard error (perhaps due
 243  * to measurement error) of the column sums. Below, we assume that all
 244  * column sums have a standard error of 5%. This is a Bayesian prior,
 245  * not a maintained hypothesis.
 246  * The estimated error is weighted sum of elements in an error support
 247  * set:
 248  *   ERR(ii) = SUM(jwt, W(ii,jwt)*VBAR(ii,jwt))
 249  * where the W's are estimated in the CE procedure.
 250  * The prior variance of these errors is given by:
 251  *   (sigmay(ii))**2 = SUM(jwt, WBAR(ii,jwt)*(VBAR(ii,jwt))**2 )
 252  * where the WBAR's are the prior on the weights.
 253  * The VBARs are chosen to define a domain for the support set of +/- 3
 254  * standard errors. The prior on the weights, WBAR, are then calculated
 255  * to yield the specified prior on the standard error, sigmay.
 256  * In Robinson, Cattaneo, and El-Said (2001), we specify prior weights
 257  * (WBAR) that are uniform and set the prior standard error by the
 258  * choice of support set, VBAR. In that paper, we use a three-weight
 259  * specification (jwt /1*3/);
 260  *
 261  * We define two sets of errors with separate weights, W1 and W2. The
 262  * first is for specifying errors on column sums, the second for errors
 263  * on macro aggregates (defined in the set macro).
 264   
 265  * First, define standard error for errors on column sums.
 266   
 267    sigmay1(ii)    = 0.05 * target0(ii) ;
 268   
 269  * This code assumes a prior mean of zero and a two-parameter
 270  * distribution with specified prior standard error. There are three
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:49:10 Page 7
Cross Entropy SAM Estimation (CESAM,SEQ=228)
C o m p i l a t i o n


 271  * weights, W(ii,jwt), to be estimated. The actual moments are estimated
 272  * as part of the estimation procedure.
      * Set constants for 3-weight error distribution
        vbar1(ii,"1")  = -3 * sigmay1(ii);
        vbar1(ii,"2")  =  0             ;
        vbar1(ii,"3")  = -3 * sigmay1(ii);
       
        wbar1(ii,"1")  =  1/18  ;
        wbar1(ii,"2")  = 16/18  ;
        wbar1(ii,"3")  =  1/18  ;
 283   
 284  * This code assumes a prior mean of zero and a prior value of kurtosis
 285  * consistent with a prior normal distribution with mean zero, variance
 286  * sigmay**2, and kurtosis equal to 3*sigmay**4. The addition of a prior
 287  * on kurtosis requires estimation of 5 weights (jwt = 5);
 288  * The prior weights wbar are specified so that:
 289  * SUM(jwt, wbar(ii,jwt)*vbar(ii,jwt)**4) = 3*sigmay(ii,jwt)**4
 290  * as well as defining the variance as above.
 291  * The prior weights and support set are also symmetric, so the prior
 292  * on all odd moments is zero. The choice of +/- 1 standard error
 293  * for vbar(ii,"2") and vbar(ii,"4") is arbitrary.
 294  * The actual moments are estimated as part of the estimation procedure.
 295   
 296  * Set constants for 5-weight error distribution
 297    vbar1(ii,"1")  = -3 * sigmay1(ii) ;
 298    vbar1(ii,"2")  = -1 * sigmay1(ii) ;
 299    vbar1(ii,"3")  =  0              ;
 300    vbar1(ii,"4")  = +1 * sigmay1(ii) ;
 301    vbar1(ii,"5")  = +3 * sigmay1(ii) ;
 302   
 303    wbar1(ii,"1")  =   1/72        ;
 304    wbar1(ii,"2")  =  27/72        ;
 305    wbar1(ii,"3")  =  16/72        ;
 306    wbar1(ii,"4")  =  27/72        ;
 307    wbar1(ii,"5")  =   1/72        ;
 308   
 309  * Second, define standard errors for errors on macro aggregates
 310   
 311    sigmay2("gdpfc2")  = 0.05*gdpfc0  ;
 312    sigmay2("gdp2")    = 0.05*gdp0 ;
 313   
      * Set constants for 3-weight error distribution
        vbar2(ii,"1")  = -3 * sigmay2(ii);
        vbar2(ii,"2")  =  0             ;
        vbar2(ii,"3")  = -3 * sigmay2(ii);
       
        wbar2(ii,"1")  =  1/18  ;
        wbar2(ii,"2")  = 16/18  ;
        wbar2(ii,"3")  =  1/18  ;
 324   
 325  * Set constants for 5-weight error distribution
 326    vbar2(macro,"1")  = -3 * sigmay2(macro) ;
 327    vbar2(macro,"2")  = -1 * sigmay2(macro) ;
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:49:10 Page 8
Cross Entropy SAM Estimation (CESAM,SEQ=228)
C o m p i l a t i o n


 328    vbar2(macro,"3")  =  0                  ;
 329    vbar2(macro,"4")  = +1 * sigmay2(macro) ;
 330    vbar2(macro,"5")  = +3 * sigmay2(macro) ;
 331   
 332    wbar2(macro,"1")  =   1/72        ;
 333    wbar2(macro,"2")  =  27/72        ;
 334    wbar2(macro,"3")  =  16/72        ;
 335    wbar2(macro,"4")  =  27/72        ;
 336    wbar2(macro,"5")  =   1/72        ;
 337   
 338   Display vbar1, vbar2, sigmay1, sigmay2 ;
 339   
 340  *###################### VARIABLES #################################
 341   VARIABLES
 342   A(ii,jj)       Post SAM coefficient matrix
 343   TSAM(ii,jj)    Post matrix of SAM transactions
 344   Y(ii)          row sum of SAM
 345   X(ii)          column sum of SAM
 346   ERR1(ii)       Error value on column sums
 347   ERR2(macro)    Error value for macro aggregates
 348   W1(ii,jwt)     Error weights
 349   W2(macro,jwt)  Error weights
 350   DENTROPY       Entropy difference (objective)
 351   GDPFC          GDP at factor cost
 352   GDP            GDP at market prices
 353    ;
 354   
 355  *########################## INITIALIZE VARIABLES ##################
 356   
 357   A.L(ii,jj)          = Abar1(ii,jj) ;
 358   TSAM.L(ii,jj)       = T1(ii,jj)    ;
 359   Y.L(ii)             = target0(ii)  ;
 360   X.L(ii)             = target0(ii)  ;
 361   ERR1.L(ii)          = 0.0          ;
 362   ERR2.L(macro)       = 0.0          ;
 363   W1.L(ii,jwt)        = wbar1(ii,jwt) ;
 364   W2.L(macro,jwt)     = wbar2(macro,jwt) ;
 365   DENTROPY.L          = 0            ;
 366   GDPFC.L             = gdpfc0       ;
 367   GDP.L               = gdp0         ;
 368   
 369  *############ CORE EQUATIONS
 370   EQUATIONS
 371   
 372   SAMEQ(i)        row and column sum constraint
 373   SAMMAKE(i,j)    make SAM flows
 374   ERROR1EQ(i)     definition of error term 1
 375   ERROR2EQ(macro) definition of error term 2
 376   SUMW1(i)        Sum of weights 1
 377   SUMW2(macro)    Sum of weights 2
 378   ENTROPY         Entropy difference definition
 379   ROWSUM(i)       row target
 380   COLSUM(j)       column target
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:49:10 Page 9
Cross Entropy SAM Estimation (CESAM,SEQ=228)
C o m p i l a t i o n


 381   GDPFCDEF        define GDP at factor cost
 382   GDPDEF          define GDP
 383   ;
 384   
 385  *CORE EQUATIONS====================================================
 386   
 387   SAMEQ(ii)..   Y(ii)       =E= X(ii) + ERR1(ii) ;
 388   
 389   SAMMAKE(ii,jj)$nonzero(ii,jj)..
 390                    TSAM(ii,jj) =E= A(ii,jj) * (X(jj) + ERR1(jj)) ;
 391   
 392   ERROR1EQ(ii).. ERR1(ii)    =E= SUM(jwt, W1(ii,jwt)*vbar1(ii,jwt)) ;
 393   
 394   SUMW1(ii)..   SUM(jwt, W1(ii,jwt)) =E= 1 ;
 395   
 396   ENTROPY..     DENTROPY    =E= SUM((ii,jj)$nonzero(ii,jj),
 397                                 A(ii,jj)*(LOG(A(ii,jj) + epsilon)
 398                               - LOG(Abar1(ii,jj) + epsilon)))
 399                               +
 400                                 SUM((ii,jwt), W1(ii,jwt)
 401                               * (LOG(W1(ii,jwt) + epsilon)
 402                               - LOG(wbar1(ii,jwt) + epsilon)))
 403                               +
 404                                 SUM((macro,jwt), W2(macro,jwt)
 405                               * (LOG(W2(macro,jwt) + epsilon)
 406                               - LOG(wbar2(macro,jwt) + epsilon))) ;
 407   
 408  * Note that we exclude one rowsum equation since if all but one column
 409  * and rowsum are equal, the last one must also be equal. Walras' Law
 410  * at work.
 411   
 412   ROWSUM(ii)$(NOT SAMEAS(ii,"ROW"))..   SUM(jj, TSAM(ii,jj)) =E= Y(ii) ;
 413   
 414   COLSUM(jj)..     SUM(ii, TSAM(ii,jj)) =E= (X(jj) + ERR1(jj)) ;
 415   
 416  *ADDITIONAL MACRO CONTROL-TOTAL EQUATIONS===========================
 417   
 418   GDPFCDEF..         GDPFC =E= TSAM("fac","act") + ERR2("gdpfc2") ;
 419   
 420   GDPDEF..           GDP   =E= TSAM("fac","act") + TSAM("gre","act")
 421                               - TSAM("act","gre") + TSAM("gre","com")
 422                               + ERR2("gdp2") ;
 423   
 424   ERROR2EQ(macro)..  ERR2(macro)
 425                            =E= SUM(jwt, W2(macro,jwt)*vbar2(macro,jwt)) ;
 426   
 427   SUMW2(macro)..     SUM(jwt, W2(macro,jwt)) =E= 1 ;
 428   
 429  *###############  Define bounds for cell values  ####################
 430   
 431  * Defining equation SAMMAKE over non-zero elements of A ($Abar1(ii,jj))
 432  * guarantees that the zero structure of the original SAM is maintained
 433  * in the estimated SAM. Fixing all the zero entries to zero greatly
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 10:49:10 Page 10
Cross Entropy SAM Estimation (CESAM,SEQ=228)
C o m p i l a t i o n


 434  * reduces the size of the estimation problem. If it is desired to
 435  * allow a zero entry to become nonzero in the estimated SAM, then
 436  * the condition $ABAR1(ii,jj) must be replaced with a new set that
 437  * does not include cells which are currently zero but may be nonzero.
 438   
 439   A.LO(ii,jj)$nonzero(ii,jj)          = 0 ;
 440   A.UP(ii,jj)$nonzero(ii,jj)          = 1 ;
 441   A.FX(ii,jj)$(NOT nonzero(ii,jj))    = 0;
 442   
 443   TSAM.lo(ii,jj)                      = 0.0 ;
 444   TSAM.up(ii,jj)                      = +inf ;
 445   TSAM.FX(ii,jj)$(NOT nonzero(ii,jj)) = 0 ;
 446   
 447  * Upper and lower bounds on the error weights
 448   W1.LO(ii,jwt)                       = 0   ;
 449   W1.UP(ii,jwt)                       = 1   ;
 450   W2.LO(macro,jwt)                    = 0   ;
 451   W2.UP(macro,jwt)                    = 1   ;
 452   
 453  * Set target column sums, X. If these are not fixed, then the column sum
 454  * constraints will not be binding and the solution values or ERR1 will
 455  * be 0.
 456   
 457    X.FX(ii)                            = TARGET0(ii) ;
 458   
 459  * Fix Macro aggregates.
 460  * If these are not fixed, then the macro constraints will not be binding
 461  * and the solution values of ERR2 will be zero.
 462    GDP.FX                = GDP0 ;
 463    GDPFC.FX              = GDPFC0 ;
 464   
 465  *######################## DEFINE MODEL ############################
 466   
 467   MODEL SAMENTROP / ALL /
 468   
 469  *######################## SOLVE MODEL #############################
 470   
 471   OPTION ITERLIM       = 5000;
 472   OPTION LIMROW        = 0,   LIMCOL    = 0;
 473   OPTION SOLPRINT      = ON;
 474   
 475   
 476  * SAMENTROP.optfile   = 1 ;
 477    SAMENTROP.HOLDFIXED = 1 ;
 478  * OPTION NLP          = CONOPT;
 479  * SAMENTROP.WORKSPACE = 25.0;
 480   
 481  *########################### Solve statenment ######################
 482   
 483    SOLVE SAMENTROP using NLP minimizing dentropy ;
 484   
 485  *###################################################################
 486   
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 10:49:10 Page 11
Cross Entropy SAM Estimation (CESAM,SEQ=228)
C o m p i l a t i o n


 487   
 488   
 489  *##(alternative formulation)#### MCP Formulation ##################
 490   
 491  * Add code restating the nonlinear-programming (NLP) minimization
 492  * problem as an MCP problem solved using the MCP solver.
 493  *
 494  * The code below is a translation of the NLP problem into a
 495  * mixed complementarity problem (MCP), which can be solved
 496  * using an MCP solver in GAMS. The translation was done using
 497  * a preliminary version of a program called NLP2MCP written
 498  * by Michael Ferris and Jeffrey Horn (1998) at the University
 499  * of Wisconsin. The translation adds "shadow price" or
 500  * complementarity variables for all constraint equations and
 501  * also provides equations for all the first-order conditions
 502  * for minimizing the objective function. The resulting model
 503  * is square with as many variables as equations.
 504   
 505  alias(macro,a_macro);
 506  alias(ii,a_ii);
 507  alias(jj,a_jj);
 508  alias(jwt,a_jwt);
 509   
 510   
 511  *#####  "SHADOW PRICE" OR COMPLEMENTARITY VARIABLES OR   ##########
 512  *##### LAGRANGE MULTIPLIERS FOR ALL CONSTRAINT EQUATIONS ##########
 513   
 514  variables
 515    m_SAMEQ(i)         Multiplier for row and column sum constraint
 516    m_SAMMAKE(i,j)     Multiplier for make SAM flows constraint
 517    m_ERROR1EQ(i)      Multiplier for definition of error term 1
 518    m_ERROR2EQ(macro)  Multiplier for definition of error term 2
 519    m_SUMW1(i)         Multiplier for Sum of weights 1 constraint
 520    m_SUMW2(macro)     Multiplier for Sum of weights 1 constraint
 521    m_ROWSUM(i)        Multiplier for row target constraint
 522    m_COLSUM(j)        Multiplier for column target constraint
 523    m_GDPFCDEF         Multiplier for GDP at factor cost constraint
 524    m_GDPDEF           Multiplier for GDP at market pricesconstraint
 525  ;
 526   
 527  *############# EQUATIONS FOR THE FIRST ORDER CONDITIONS ############
 528  *############# FOR MINIMIZING THE OBJECTIVE FUNCTION    ############
 529   
 530  EQUATIONS
 531    d_A(a_ii,a_jj)        FOC wrt the choice variable A
 532    d_TSAM(a_ii,a_jj)     FOC wrt the variable TSAM
 533    d_Y(a_ii)             FOC wrt the variable Y
 534    d_X(a_ii)             FOC wrt the variable X
 535    d_ERR1(a_ii)          FOC wrt the variable ERR1
 536    d_ERR2(a_macro)       FOC wrt the variable ERR2
 537    d_W1(a_ii,a_jwt)      FOC wrt the choice variable W1
 538    d_W2(a_macro,a_jwt)   FOC wrt the choice variable W2
 539    d_GDPFC               FOC wrt the macro control variable GDPFC
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 10:49:10 Page 12
Cross Entropy SAM Estimation (CESAM,SEQ=228)
C o m p i l a t i o n


 540    d_GDP                 FOC wrt the macro control variable GDP
 541  ;
 542   
 543   
 544  *##### EQUATION: FOC wrt the choice variable A  #################
 545  d_A(a_ii,a_jj) ..
 546   
 547   ((log(a(a_ii,a_jj)+epsilon)-log(abar1(a_ii,a_jj)+epsilon))
 548   $(nonzero(a_ii,a_jj)) + a(a_ii,a_jj)*(1/(a(a_ii,a_jj)+epsilon))
 549   $(nonzero(a_ii,a_jj)))-
 550   
 551   SUM((ii,jj)$(nonzero(ii,jj)),m_sammake(ii,jj)*(-(1$((sameas
 552   (a_ii,ii) and sameas(a_jj,jj))))*(x(jj)+err1(jj)))) =e= 0;
 553   
 554   
 555  *##### EQUATION: FOC wrt the variable TSAM ######################
 556  d_TSAM(a_ii,a_jj) .. -
 557   
 558   m_gdpfcdef*(-(1$((sameas(a_ii,"fac") and sameas(a_jj,"act"
 559   )))))-
 560   
 561   m_colsum(a_jj)-
 562   
 563   m_gdpdef*(-(1$((sameas(a_ii,"fac") and sameas(a_jj,"act"))
 564   )+1$((sameas(a_ii,"gre") and sameas(a_jj,"act")))-(1$((sameas
 565   (a_ii,"act") and sameas(a_jj,"gre"))))+1$((sameas(a_ii,"gre"
 566   ) and sameas(a_jj,"com")))))-
 567   
 568   m_rowsum(a_ii)$((not sameas(a_ii,"ROW")))-
 569   
 570   m_sammake(a_ii,a_jj)$(nonzero(a_ii,a_jj)) =e= 0;
 571   
 572   
 573  *##### EQUATION: FOC wrt the variable Y #########################
 574  d_Y(a_ii) .. -
 575   
 576   m_sameq(a_ii)-
 577   
 578   SUM((ii)$((not sameas(ii,"ROW"))),m_rowsum(ii)*(-(1$((sameas
 579   (a_ii,ii))))))
 580   
 581   =e= 0;
 582   
 583  *##### EQUATION FOC wrt the variable X ##########################
 584  d_X(a_ii) .. -
 585   
 586   SUM(jj,m_colsum(jj)*(-(1$((sameas(a_ii,jj))))))-
 587   
 588   SUM(ii,m_sameq(ii)*(-(1$((sameas(a_ii,ii))))))-
 589   
 590   SUM((ii,jj)$(nonzero(ii,jj)),m_sammake(ii,jj)*(-a(ii,jj)*(1
 591   $((sameas(a_ii,jj)))))) =e= 0;
 592   
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 10:49:10 Page 13
Cross Entropy SAM Estimation (CESAM,SEQ=228)
C o m p i l a t i o n


 593  *##### EQUATION: FOC wrt the variable ERR1 ######################
 594  d_ERR1(a_ii) .. -
 595   
 596   m_error1eq(a_ii)-
 597   
 598   SUM(jj,m_colsum(jj)*(-(1$((sameas(a_ii,jj))))))-
 599   
 600   SUM(ii,m_sameq(ii)*(-(1$((sameas(a_ii,ii))))))-
 601   
 602   SUM((ii,jj)$(nonzero(ii,jj)),m_sammake(ii,jj)*(-a(ii,jj)*(1
 603   $((sameas(a_ii,jj))))))
 604   
 605   =e= 0;
 606   
 607  *##### EQUATION: FOC wrt the variable ERR2 ######################
 608  d_ERR2(a_macro) .. -
 609   
 610   m_error2eq(a_macro)-
 611   
 612   m_gdpfcdef*(-(1$((sameas(a_macro,"gdpfc2")))))-
 613   
 614   m_gdpdef*(-(1$((sameas(a_macro,"gdp2")))))
 615   
 616   =e= 0;
 617   
 618  *##### EQUATION: FOC wrt the choice variable W1 #################
 619  d_W1(a_ii,a_jwt) .. ((log(w1(a_ii,a_jwt)+epsilon)-log(wbar1(a_ii
 620   ,a_jwt)+epsilon))+w1(a_ii,a_jwt)*(1/(w1(a_ii,a_jwt)+epsilon)))-
 621   
 622   SUM(ii,m_error1eq(ii)*(-(vbar1(ii,a_jwt)$(sameas(a_ii,ii))
 623   )))-
 624   
 625   m_sumw1(a_ii)
 626   
 627   =e= 0;
 628   
 629  *##### EQUATION: FOC wrt the choice variable W2 #################
 630  d_W2(a_macro,a_jwt) .. ((log(w2(a_macro,a_jwt)+epsilon)-log(wbar2
 631   (a_macro,a_jwt)+epsilon))+w2(a_macro,a_jwt)*(1/(w2(a_macro,a_jwt
 632   )+epsilon)))-
 633   
 634   SUM(macro,m_error2eq(macro)*(-(vbar2(macro,a_jwt)$(sameas(a_macro
 635   ,macro)))))-
 636   
 637   m_sumw2(a_macro)
 638   
 639   =e= 0;
 640   
 641  *##### EQUATION: FOC wrt the macro control variable GDPFC #######
 642  d_GDPFC .. -
 643   
 644   m_gdpfcdef =e= 0;
 645   
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 10:49:10 Page 14
Cross Entropy SAM Estimation (CESAM,SEQ=228)
C o m p i l a t i o n


 646  *##### EQUATION: FOC wrt the macro control variable GDP #########
 647  d_GDP .. -
 648   
 649   m_gdpdef =e= 0;
 650   
 651  *######################## DEFINE MODEL ############################
 652  * In GAMS the "." is used for pairing the complementarity variables
 653  * and equations for the MCP solver. For example the equation
 654  * defined by d_A is complementary to the variable A and must be
 655  * defined over the same sets.
 656   
 657   MODEL m_SAMENTROP /
 658      d_A.A
 659      d_TSAM.TSAM
 660      d_Y.Y
 661      d_X.X
 662      d_ERR1.ERR1
 663      d_ERR2.ERR2
 664      d_W1.W1
 665      d_W2.W2
 666      d_GDPFC.GDPFC
 667      d_GDP.GDP
 668      ERROR1EQ.m_ERROR1EQ
 669      ERROR2EQ.m_ERROR2EQ
 670      GDPFCDEF.m_GDPFCDEF
 671      COLSUM.m_COLSUM
 672      SAMEQ.m_SAMEQ
 673      GDPDEF.m_GDPDEF
 674      SUMW1.m_SUMW1
 675      ROWSUM.m_ROWSUM
 676      SUMW2.m_SUMW2
 677      SAMMAKE.m_SAMMAKE
 678                      /
 679   ;
 680   
 681  *############################ SOLVE MODEL #########################
 682   
 683  *Shock the NLP solution
 684   A.L(ii,jj) = 0.9*A.l(ii,jj) ;
 685   
 686  *########################### Solve statenment #####################
 687   
 688    SOLVE m_SAMENTROP using mcp;
 689   
 690  **#################################################################
 691   
 692  *Compare NLP and MCP results.
 693   Scalar savedent ;
 694   savedent = dentropy.l ;
 695   
 696  DENTROPY.l   = SUM((ii,jj)$nonzero(ii,jj),
 697                                A.l(ii,jj)*(LOG(A.l(ii,jj) + epsilon)
 698                               - LOG(Abar1(ii,jj) + epsilon)))
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 10:49:10 Page 15
Cross Entropy SAM Estimation (CESAM,SEQ=228)
C o m p i l a t i o n


 699                               +
 700                                 SUM((ii,jwt), W1.l(ii,jwt)
 701                               * (LOG(W1.l(ii,jwt) + epsilon)
 702                               - LOG(wbar1(ii,jwt) + epsilon)))
 703                               +
 704                                 SUM((macro,jwt), W2.l(macro,jwt)
 705                               * (LOG(W2.l(macro,jwt) + epsilon)
 706                               - LOG(wbar2(macro,jwt) + epsilon))) ;
 707   
 708   option decimals=8 ;
 709   display dentropy.l, savedent ;
 710   option decimals=3 ;
 711   
 712  *###################### END MCP INCLUDE FILE ######################
 713   
 714   
 715   
 716   
 717  *###### NOTE ON THE USE OF "SAMEAS" GAMS COMMAND ##################
 718  *######   Undocumented Feature IN GAMS Manual    ##################
      Matching Set Elements
       
      New features in GAMS allow one to introduce conditional statements
      controlling execution in cases where certain items match up . The
      syntax involves using the commands
       
        SAMEAS(setelement1,setelement2)
                    or
        DIAG(setelement,setelement)
       
      the SAMEAS command returns a true false indicator which is true
      if the text string defining the name of set element 1 equals that
      for setelement 2 and false otherwise. DIAG returns a 1 under
      equality and a zero otherwise.
       
      For example
        x=sum((i,j)$(not SAMEAS(i,j)),z(i)*z(j));
                         or
        x=sum((i,j)$(DIAG(i,j) eq 0),z(i)*z(j));
       
      would exclude the cases where i=j from the sum
       
      while
        x=sum((i,j)$(SAME AS(i,"case1") or SAME AS(j,"case2")),z(i)+z(j));
       
      would only include cases where the text for i equaled the string
      "case1" or the text for j corresponded to "case2."
       
      If interested check the following web address Undocumented Features
      and Usage Tips
       
       http://agrinet.tamu.edu/mccarl/gamstip.htm
       
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 10:49:10 Page 16
Cross Entropy SAM Estimation (CESAM,SEQ=228)
C o m p i l a t i o n


 754   
 755  *############### END Note on "SAMEAS" GAMS command ################
 756  *###################################################################
 757   
 758   
 759  *---------------- Parameters for reporting results
 760  Parameters
 761   Macsam1(i,j)       Assigned new balanced SAM flows from CE
 762   Macsam2(i,j)       Balanced SAM flows from entropy diff x scalesam
 763   SEM                Squared Error Measure
 764   percent1(i,j)      percent change of new SAM from original SAM
 765   PosUnbal(i,j)      Positive unbalanced SAM
 766   PosBalan(i,j)      Positive balanced SAM
 767   Diffrnce(i,j)      Differnce btw original SAM and Final SAM in values
 768   NormEntrop         Normalized Entropy a measure of total uncertainty
 769   ;
 770   
 771   macsam1(ii,jj)         = TSAM.l(ii,jj);
 772   macsam1("total",jj)    = SUM(ii, macsam1(ii,jj)) ;
 773   macsam1(ii,"total")    = SUM(jj, macsam1(ii,jj)) ;
 774   macsam2(i,j)           = macsam1(i,j) * scalesam ;
 775   SEM                    = Sum((ii,jj), SQR(A.L(ii,jj)
 776                                        - Abar1(ii,jj)))/SQR(card(ii));
 777   percent1(i,j)$(T1(i,j))= 100*(macsam1(i,j)-T1(i,j))/T1(i,j);
 778   PosUnbal(i,j)          = T1(i,j) * scalesam;
 779   PosBalan(i,j)          = macsam2(i,j);
 780   Diffrnce(i,j)          = PosBalan(i,j) - PosUnbal(i,j);
 781   NormEntrop             = SUM((ii,jj)$(Abar1(ii,jj)), A.L(ii,jj)*
 782                            LOG (A.L(ii,jj))) / SUM((ii,jj)$(Abar1(ii,jj)),
 783                            Abar1(ii,jj)* LOG (Abar1(ii,jj)))
 784   ;
 785   display macsam1, macsam2, percent1, sem, dentropy.l, PosUnbal,
 786           PosBalan, NormEntrop, Diffrnce ;
 787   
 788  *########### Return negative flows to initial cell position ############
 789   
 790   macsam1(ii,jj)         = macsam1(ii,jj) + redsam(ii,jj) ;
 791   macsam1("total",jj)    = SUM(ii, macsam1(ii,jj)) ;
 792   macsam1(ii,"total")    = SUM(jj, macsam1(ii,jj)) ;
 793   macsam2(i,j)           = macsam1(i,j) * scalesam ;
 794   
 795   gdp00                  = macsam1("fac","act") + macsam1("gre","act")
 796                            - macsam1("act","gre") + macsam1("gre","com") ;
 797   
 798   display macsam1, macsam2 ;
 799   display gdp0, gdp00, gdp.l, gdpfc0, gdpfc.l ;
 800   
 801  *#######
 802   Parameter ANEW(i,j) ;
 803  * print some stuff
 804   ANEW("total",jj)   = SUM(ii, A.L(ii,jj)) ;
 805   ANEW(ii,"total")   = SUM(jj, A.L(ii,jj)) ;
 806   
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 10:49:10 Page 17
Cross Entropy SAM Estimation (CESAM,SEQ=228)
C o m p i l a t i o n


 807   ABAR1("total",jj) = SUM(ii, ABAR1(ii,jj)) ;
 808   ABAR1(ii,"total") = SUM(jj, ABAR1(ii,jj)) ;
 809   
 810   Display ANEW, ABAR1 ;
 811   
 812   scalar meanerr1, meanerr2 ;
 813   meanerr1 = SUM(ii, abs(err1.l(ii)))/card(ii) ;
 814   meanerr2 = SUM(macro, abs(err2.l(macro)))/card(macro) ;
 815   display meanerr1, meanerr2 ;
 816   
 817  * Use the following code to specify that the column sums are known
 818  * exactly. The errors are thus fixed to zero and two equations are
 819  * dropped from the estimation procedure. The computational gains are
 820  * that the constraints are all linear and the estimation problem is
 821  * considerably smaller.
 822   
 823  *######
      *######
       
       ERR1.FX(ii)       = 0.0 ;
       W1.FX(ii,jwt)     = WBAR1(ii,jwt) ;
       
       MODEL SAMENTROP2 /SAMEQ
                        SAMMAKE
      *                 ERROR1EQ
      *                 SUMW1
                        ERROR2EQ
                        SUMW2
                        ENTROPY
                        ROWSUM
                        COLSUM
                        GDPFCDEF
                        GDPDEF
                                 /
      ;
       SAMENTROP2.holdfixed = 1 ;
       
      *######################### Solve statenment ###################
       
       SOLVE SAMENTROP2 using nlp minimizing dentropy ;
       
      *##############################################################
       
      *#######
 853  *#######
 854   
 855  *#*#*#*#*#*#*#*#*#*#*#*#* THE END *#*#*#*#*#*#*#*#*#*#*#*#*#*#*


COMPILATION TIME     =        0.005 SECONDS      3 MB  24.7.4 r58773 LEX-LEG
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 10:49:10 Page 18
Cross Entropy SAM Estimation (CESAM,SEQ=228)
E x e c u t i o n


----    168 PARAMETER T0  Matrix of SAM transactions (flow matrix)

              ACT         COM         FAC         ENT         HOU         GRE         GIN         CAP         ROW       TOTAL

ACT                    14.827                               2.101 -3.27000E-4                               1.488      18.416
COM         7.918                                           6.953       1.564       2.519       2.598                  21.552
FAC         9.805                                                                                                       9.805
ENT                                 3.700                               0.033                                           3.733
HOU                                 6.031       3.418                   0.030                               0.210       9.688
GRE         0.734       0.357       0.074       0.165       0.140                                                       1.470
GIN                                                                                                         1.712       1.712
CAP                                             0.150       0.649      -0.357      -0.406                   2.164       2.200
ROW                     5.574                                                                                           5.574
TOTAL      18.457      20.759       9.805       3.733       9.843       1.270       2.112       2.598       5.574


----    168 PARAMETER Abar0  Prior SAM coefficient matrix

            ACT         COM         FAC         ENT         HOU         GRE         GIN         CAP         ROW

ACT                   0.714                               0.213 -2.57460E-4                               0.267
COM       0.429                                           0.706       1.232       1.192       1.000
FAC       0.531
ENT                               0.377                               0.026
HOU                               0.615       0.916                   0.023                               0.038
GRE       0.040       0.017       0.008       0.044       0.014
GIN                                                                                                       0.307
CAP                                           0.040       0.066      -0.281      -0.192                   0.388
ROW                   0.269


----    220 NON-NEGATIVE SAM

----    221 PARAMETER redsam  Negative SAM values only

              ACT         GRE         GIN         CAP       TOTAL

ACT               -3.27000E-4                         -3.27000E-4
GRE   -3.27000E-4                              -0.357      -0.357
GIN                                            -0.406      -0.406
CAP                    -0.357      -0.406                  -0.763
TOTAL -3.27000E-4      -0.357      -0.406      -0.763


----    221 PARAMETER T1  SAM transactions Adjusted to eliminate negative entries

              ACT         COM         FAC         ENT         HOU         GRE         GIN         CAP         ROW       TOTAL

ACT                    14.827                               2.101                                           1.488      18.417
COM         7.918                                           6.953       1.564       2.519       2.598                  21.552
FAC         9.805                                                                                                       9.805
ENT                                 3.700                               0.033                                           3.733
HOU                                 6.031       3.418                   0.030                               0.210       9.688
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 10:49:10 Page 19
Cross Entropy SAM Estimation (CESAM,SEQ=228)
E x e c u t i o n


        221 PARAMETER T1  SAM transactions Adjusted to eliminate negative entries

              ACT         COM         FAC         ENT         HOU         GRE         GIN         CAP         ROW       TOTAL

GRE         0.734       0.357       0.074       0.165       0.140                               0.357                   1.827
GIN                                                                                             0.406       1.712       2.119
CAP                                             0.150       0.649                                           2.164       2.963
ROW                     5.574                                                                                           5.574
TOTAL      18.457      20.759       9.805       3.733       9.843       1.627       2.519       3.361       5.574


----    221 PARAMETER Abar0  Prior SAM coefficient matrix

            ACT         COM         FAC         ENT         HOU         GRE         GIN         CAP         ROW

ACT                   0.714                               0.213 -2.57460E-4                               0.267
COM       0.429                                           0.706       1.232       1.192       1.000
FAC       0.531
ENT                               0.377                               0.026
HOU                               0.615       0.916                   0.023                               0.038
GRE       0.040       0.017       0.008       0.044       0.014
GIN                                                                                                       0.307
CAP                                           0.040       0.066      -0.281      -0.192                   0.388
ROW                   0.269


----    221 PARAMETER Abar1  Prior SAM adjusted to eliminate negative coefficients

            ACT         COM         FAC         ENT         HOU         GRE         GIN         CAP         ROW

ACT                   0.714                               0.213                                           0.267
COM       0.429                                           0.706       0.962       1.000       0.773
FAC       0.531
ENT                               0.377                               0.020
HOU                               0.615       0.916                   0.018                               0.038
GRE       0.040       0.017       0.008       0.044       0.014                               0.106
GIN                                                                                           0.121       0.307
CAP                                           0.040       0.066                                           0.388
ROW                   0.269


----    221 PARAMETER rtot  Row total

ACT 18.417,    COM 21.552,    FAC  9.805,    ENT  3.733,    HOU  9.688,    GRE  1.827,    GIN  2.119,    CAP  2.963,    ROW  5.574


----    221 PARAMETER ctot  Column total

ACT 18.457,    COM 20.759,    FAC  9.805,    ENT  3.733,    HOU  9.843,    GRE  1.627,    GIN  2.519,    CAP  3.361,    ROW  5.574


----    239 PARAMETER gdpfc0               =        9.805  GDP at factor cost
            PARAMETER gdp0                 =       10.897  base GDP
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 10:49:10 Page 20
Cross Entropy SAM Estimation (CESAM,SEQ=228)
E x e c u t i o n


----    338 PARAMETER vbar1  Error support set 1

              1           2           4           5

ACT      -2.766      -0.922       0.922       2.766
COM      -3.173      -1.058       1.058       3.173
FAC      -1.471      -0.490       0.490       1.471
ENT      -0.560      -0.187       0.187       0.560
HOU      -1.465      -0.488       0.488       1.465
GRE      -0.259      -0.086       0.086       0.259
GIN      -0.348      -0.116       0.116       0.348
CAP      -0.474      -0.158       0.158       0.474
ROW      -0.836      -0.279       0.279       0.836


----    338 PARAMETER vbar2  Error support set 2

                 1           2           4           5

gdpfc2      -1.471      -0.490       0.490       1.471
gdp2        -1.635      -0.545       0.545       1.635


----    338 PARAMETER sigmay1  Prior standard error of column sums

ACT 0.922,    COM 1.058,    FAC 0.490,    ENT 0.187,    HOU 0.488,    GRE 0.086,    GIN 0.116,    CAP 0.158,    ROW 0.279


----    338 PARAMETER sigmay2  Prior standard error of macro aggregates

gdpfc2 0.490,    gdp2   0.545

GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 10:49:10 Page 21
Cross Entropy SAM Estimation (CESAM,SEQ=228)
Model Statistics    SOLVE SAMENTROP Using NLP From line 483


MODEL STATISTICS

BLOCKS OF EQUATIONS          11     SINGLE EQUATIONS           78
BLOCKS OF VARIABLES           8     SINGLE VARIABLES          130
NON ZERO ELEMENTS           368     NON LINEAR N-Z            136
DERIVATIVE POOL              20     CONSTANT POOL              56
CODE LENGTH                 683


GENERATION TIME      =        0.003 SECONDS      4 MB  24.7.4 r58773 LEX-LEG


EXECUTION TIME       =        0.005 SECONDS      4 MB  24.7.4 r58773 LEX-LEG
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 10:49:10 Page 22
Cross Entropy SAM Estimation (CESAM,SEQ=228)
Solution Report     SOLVE SAMENTROP Using NLP From line 483


               S O L V E      S U M M A R Y

     MODEL   SAMENTROP           OBJECTIVE  DENTROPY
     TYPE    NLP                 DIRECTION  MINIMIZE
     SOLVER  BARON               FROM LINE  483

**** SOLVER STATUS     3 Resource Interrupt        
**** MODEL STATUS      7 Feasible Solution         
**** OBJECTIVE VALUE                0.0096

 RESOURCE USAGE, LIMIT       1000.000      1000.000
 ITERATION COUNT, LIMIT         0          5000
 EVALUATION ERRORS              0             0

GAMS/BARON       24.7.4 r58773 Released Sep 19, 2016 LEG x86 64bit/Linux      

BARON is a product of The Optimization Firm, LLC. http://www.minlp.com/
Parts of the BARON software were created at the
University of Illinois at Urbana-Champaign.

--- Using Option File
*** Error Cannot open parameter file "/home/renigijus/gams/opt-mod-lib/gamslib/cesam/baron.opt"
*** Error Error code = 2; No such file or directory

===========================================================================
 BARON version 16.8.24. Built: LNX-64 Wed Aug 24 08:52:24 EDT 2016

 If you use this software, please cite:
 Tawarmalani, M. and N. V. Sahinidis, A polyhedral
 branch-and-cut approach to global optimization,
 Mathematical Programming, 103(2), 225-249, 2005.

 BARON is a product of The Optimization Firm, LLC. http://www.minlp.com/
 Parts of the BARON software were created at the
 University of Illinois at Urbana-Champaign.
===========================================================================
 This BARON run may utilize the following subsolver(s)
 For LP/MIP: ILOG CPLEX                                      
 For NLP: MINOS, SNOPT, GAMS external NLP, IPOPT, FILTERSD
===========================================================================

Solution      = 0.00958557821289189  found at node 136262
Best possible = -143.367739096
Absolute gap  = 143.377324674213  optca = 1E-9
Relative gap  = NA  optcr = 0.1
  (Note that BARON uses a different formula to compute the relative gap as
   was used for the above reported value.)

GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 10:49:10 Page 23
Cross Entropy SAM Estimation (CESAM,SEQ=228)
Solution Report     SOLVE SAMENTROP Using NLP From line 483


---- EQU SAMEQ  row and column sum constraint

           LOWER          LEVEL          UPPER

ACT        18.4367        18.4367        18.4367      
COM        21.1551        21.1551        21.1551      
FAC         9.8054         9.8054         9.8054      
ENT         3.7327         3.7327         3.7327      
HOU         9.7655         9.7655         9.7655      
GRE         1.7271         1.7271         1.7271      
GIN         2.3185         2.3185         2.3185      
CAP         3.1618         3.1618         3.1618      
ROW         5.5738         5.5738         5.5738      

---- EQU SAMMAKE  make SAM flows

               LOWER          LEVEL          UPPER

ACT.COM          .              .              .          
ACT.HOU          .              .              .          
ACT.ROW          .              .              .          
COM.ACT          .              .              .          
COM.HOU          .              .              .          
COM.GRE          .              .              .          
COM.GIN          .              .              .          
COM.CAP          .              .              .          
FAC.ACT          .              .              .          
ENT.FAC          .              .              .          
ENT.GRE          .              .              .          
HOU.FAC          .              .              .          
HOU.ENT          .              .              .          
HOU.GRE          .              .              .          
HOU.ROW          .              .              .          
GRE.ACT          .              .              .          
GRE.COM          .              .              .          
GRE.FAC          .              .              .          
GRE.ENT          .              .              .          
GRE.HOU          .              .              .          
GRE.CAP          .              .              .          
GIN.CAP          .              .              .          
GIN.ROW          .              .              .          
CAP.ENT          .              .              .          
CAP.HOU          .              .              .          
CAP.ROW          .              .              .          
ROW.COM          .              .              .          

---- EQU ERROR1EQ  definition of error term 1

           LOWER          LEVEL          UPPER

ACT          .              .              .          
COM          .              .              .          
FAC          .              .              .          
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 10:49:10 Page 24
Cross Entropy SAM Estimation (CESAM,SEQ=228)
Solution Report     SOLVE SAMENTROP Using NLP From line 483


     EQU ERROR1EQ  definition of error term 1

           LOWER          LEVEL          UPPER

ENT          .              .              .          
HOU          .              .              .          
GRE          .              .              .          
GIN          .              .              .          
CAP          .              .              .          
ROW          .              .              .          

---- EQU ERROR2EQ  definition of error term 2

              LOWER          LEVEL          UPPER

gdpfc2          .              .              .          
gdp2            .              .              .          

---- EQU SUMW1  Sum of weights 1

           LOWER          LEVEL          UPPER

ACT         1.0000         1.0000         1.0000      
COM         1.0000         1.0000         1.0000      
FAC         1.0000         1.0000         1.0000      
ENT         1.0000         1.0000         1.0000      
HOU         1.0000         1.0000         1.0000      
GRE         1.0000         1.0000         1.0000      
GIN         1.0000         1.0000         1.0000      
CAP         1.0000         1.0000         1.0000      
ROW         1.0000         1.0000         1.0000      

---- EQU SUMW2  Sum of weights 2

              LOWER          LEVEL          UPPER

gdpfc2         1.0000         1.0000         1.0000      
gdp2           1.0000         1.0000         1.0000      

                           LOWER          LEVEL          UPPER

---- EQU ENTROPY             .              .              .          

  ENTROPY  Entropy difference definition

---- EQU ROWSUM  row target

           LOWER          LEVEL          UPPER

ACT          .              .              .          
COM          .              .              .          
FAC          .              .              .          
ENT          .              .              .          
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 10:49:10 Page 25
Cross Entropy SAM Estimation (CESAM,SEQ=228)
Solution Report     SOLVE SAMENTROP Using NLP From line 483


     EQU ROWSUM  row target

           LOWER          LEVEL          UPPER

HOU          .              .              .          
GRE          .              .              .          
GIN          .              .              .          
CAP          .              .              .          

---- EQU COLSUM  column target

           LOWER          LEVEL          UPPER

ACT        18.4367        18.4367        18.4367      
COM        21.1551        21.1551        21.1551      
FAC         9.8054         9.8054         9.8054      
ENT         3.7327         3.7327         3.7327      
HOU         9.7655         9.7655         9.7655      
GRE         1.7271         1.7271         1.7271      
GIN         2.3185         2.3185         2.3185      
CAP         3.1618         3.1618         3.1618      
ROW         5.5738         5.5738         5.5738      

                           LOWER          LEVEL          UPPER

---- EQU GDPFCDEF          -9.8054        -9.8054        -9.8054      
---- EQU GDPDEF           -10.8967       -10.8967       -10.8967      

  GDPFCDEF  define GDP at factor cost
  GDPDEF  define GDP

---- VAR A  Post SAM coefficient matrix

               LOWER          LEVEL          UPPER

ACT.COM          .             0.7182         1.0000      
ACT.HOU          .             0.2025         1.0000      
ACT.ROW          .             0.2285         1.0000      
COM.ACT          .             0.4299         1.0000      
COM.HOU          .             0.7005         1.0000      
COM.GRE          .             0.9595         1.0000      
COM.GIN          .             1.0000         1.0000      
COM.CAP          .             0.7624         1.0000      
FAC.ACT          .             0.5320         1.0000      
ENT.FAC          .             0.3767         1.0000      
ENT.GRE          .             0.0214         1.0000      
HOU.FAC          .             0.6181         1.0000      
HOU.ENT          .             0.9221         1.0000      
HOU.GRE          .             0.0192         1.0000      
HOU.ROW          .             0.0394         1.0000      
GRE.ACT          .             0.0381         1.0000      
GRE.COM          .             0.0181         1.0000      
GRE.FAC          .             0.0051         1.0000      
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 10:49:10 Page 26
Cross Entropy SAM Estimation (CESAM,SEQ=228)
Solution Report     SOLVE SAMENTROP Using NLP From line 483


     VAR A  Post SAM coefficient matrix

               LOWER          LEVEL          UPPER

GRE.ENT          .             0.0384         1.0000      
GRE.HOU          .             0.0129         1.0000      
GRE.CAP          .             0.1019         1.0000      
GIN.CAP          .             0.1357         1.0000      
GIN.ROW          .             0.3388         1.0000      
CAP.ENT          .             0.0396         1.0000      
CAP.HOU          .             0.0841         1.0000      
CAP.ROW          .             0.3933         1.0000      
ROW.COM          .             0.2637         1.0000      

---- VAR TSAM  Post matrix of SAM transactions

               LOWER          LEVEL          UPPER

ACT.COM          .            15.1907        +INF         
ACT.HOU          .             1.9756        +INF         
ACT.ROW          .             1.2741        +INF         
COM.ACT          .             7.9284        +INF         
COM.HOU          .             6.8360        +INF         
COM.GRE          .             1.6571        +INF         
COM.GIN          .             2.3180        +INF         
COM.CAP          .             2.4102        +INF         
FAC.ACT          .             9.8099        +INF         
ENT.FAC          .             3.6958        +INF         
ENT.GRE          .             0.0369        +INF         
HOU.FAC          .             6.0637        +INF         
HOU.ENT          .             3.4417        +INF         
HOU.GRE          .             0.0331        +INF         
HOU.ROW          .             0.2197        +INF         
GRE.ACT          .             0.7022        +INF         
GRE.COM          .             0.3829        +INF         
GRE.FAC          .             0.0505        +INF         
GRE.ENT          .             0.1432        +INF         
GRE.HOU          .             0.1263        +INF         
GRE.CAP          .             0.3222        +INF         
GIN.CAP          .             0.4289        +INF         
GIN.ROW          .             1.8890        +INF         
CAP.ENT          .             0.1477        +INF         
CAP.HOU          .             0.8203        +INF         
CAP.ROW          .             2.1933        +INF         
ROW.COM          .             5.5761        +INF         

---- VAR Y  row sum of SAM

           LOWER          LEVEL          UPPER

ACT        -INF           18.4405        +INF         
COM        -INF           21.1497        +INF         
FAC        -INF            9.8099        +INF         
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 10:49:10 Page 27
Cross Entropy SAM Estimation (CESAM,SEQ=228)
Solution Report     SOLVE SAMENTROP Using NLP From line 483


     VAR Y  row sum of SAM

           LOWER          LEVEL          UPPER

ENT        -INF            3.7327        +INF         
HOU        -INF            9.7582        +INF         
GRE        -INF            1.7272        +INF         
GIN        -INF            2.3180        +INF         
CAP        -INF            3.1613        +INF         
ROW        -INF            5.5761        +INF         

---- VAR ERR1  Error value on column sums

           LOWER          LEVEL          UPPER

ACT        -INF            0.0038        +INF         
COM        -INF           -0.0054        +INF         
FAC        -INF            0.0045        +INF         
ENT        -INF      -3.925794E-5        +INF         
HOU        -INF           -0.0073        +INF         
GRE        -INF      7.2995664E-5        +INF         
GIN        -INF           -0.0005        +INF         
CAP        -INF           -0.0005        +INF         
ROW        -INF            0.0023        +INF         

---- VAR ERR2  Error value for macro aggregates

              LOWER          LEVEL          UPPER

gdpfc2        -INF           -0.0045        +INF         
gdp2          -INF            0.0018        +INF         

---- VAR W1  Error weights

             LOWER          LEVEL          UPPER

ACT.1          .             0.0137         1.0000      
ACT.2          .             0.3735         1.0000      
ACT.3          .             0.2222         1.0000      
ACT.4          .             0.3765         1.0000      
ACT.5          .             0.0141         1.0000      
COM.1          .             0.0141         1.0000      
COM.2          .             0.3769         1.0000      
COM.3          .             0.2222         1.0000      
COM.4          .             0.3731         1.0000      
COM.5          .             0.0137         1.0000      
FAC.1          .             0.0135         1.0000      
FAC.2          .             0.3716         1.0000      
FAC.3          .             0.2222         1.0000      
FAC.4          .             0.3784         1.0000      
FAC.5          .             0.0143         1.0000      
ENT.1          .             0.0139         1.0000      
ENT.2          .             0.3751         1.0000      
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 10:49:10 Page 28
Cross Entropy SAM Estimation (CESAM,SEQ=228)
Solution Report     SOLVE SAMENTROP Using NLP From line 483


     VAR W1  Error weights

             LOWER          LEVEL          UPPER

ENT.3          .             0.2222         1.0000      
ENT.4          .             0.3749         1.0000      
ENT.5          .             0.0139         1.0000      
HOU.1          .             0.0145         1.0000      
HOU.2          .             0.3806         1.0000      
HOU.3          .             0.2222         1.0000      
HOU.4          .             0.3694         1.0000      
HOU.5          .             0.0133         1.0000      
GRE.1          .             0.0139         1.0000      
GRE.2          .             0.3747         1.0000      
GRE.3          .             0.2222         1.0000      
GRE.4          .             0.3753         1.0000      
GRE.5          .             0.0139         1.0000      
GIN.1          .             0.0141         1.0000      
GIN.2          .             0.3768         1.0000      
GIN.3          .             0.2222         1.0000      
GIN.4          .             0.3732         1.0000      
GIN.5          .             0.0137         1.0000      
CAP.1          .             0.0140         1.0000      
CAP.2          .             0.3762         1.0000      
CAP.3          .             0.2222         1.0000      
CAP.4          .             0.3737         1.0000      
CAP.5          .             0.0138         1.0000      
ROW.1          .             0.0136         1.0000      
ROW.2          .             0.3719         1.0000      
ROW.3          .             0.2222         1.0000      
ROW.4          .             0.3781         1.0000      
ROW.5          .             0.0142         1.0000      

---- VAR W2  Error weights

                LOWER          LEVEL          UPPER

gdpfc2.1          .             0.0143         1.0000      
gdpfc2.2          .             0.3784         1.0000      
gdpfc2.3          .             0.2222         1.0000      
gdpfc2.4          .             0.3716         1.0000      
gdpfc2.5          .             0.0135         1.0000      
gdp2  .1          .             0.0138         1.0000      
gdp2  .2          .             0.3738         1.0000      
gdp2  .3          .             0.2222         1.0000      
gdp2  .4          .             0.3762         1.0000      
gdp2  .5          .             0.0140         1.0000      

                           LOWER          LEVEL          UPPER

---- VAR DENTROPY          -INF            0.0096        +INF         

  DENTROPY  Entropy difference (objective)
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 10:49:10 Page 29
Cross Entropy SAM Estimation (CESAM,SEQ=228)
Solution Report     SOLVE SAMENTROP Using NLP From line 483


**** REPORT SUMMARY :        0     NONOPT
                             0 INFEASIBLE
                             0  UNBOUNDED
                             0     ERRORS
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 10:49:10 Page 30
Cross Entropy SAM Estimation (CESAM,SEQ=228)
Model Statistics    SOLVE m_SAMENTROP Using MCP From line 688


MODEL STATISTICS

BLOCKS OF EQUATIONS          20     SINGLE EQUATIONS          271
BLOCKS OF VARIABLES          20     SINGLE VARIABLES          271
NON ZERO ELEMENTS         1,056     NON LINEAR N-Z            352
DERIVATIVE POOL              20     CONSTANT POOL              17
CODE LENGTH               1,479


GENERATION TIME      =        0.003 SECONDS      3 MB  24.7.4 r58773 LEX-LEG


EXECUTION TIME       =        0.005 SECONDS      3 MB  24.7.4 r58773 LEX-LEG
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 10:49:10 Page 31
Cross Entropy SAM Estimation (CESAM,SEQ=228)
Solution Report     SOLVE m_SAMENTROP Using MCP From line 688


               S O L V E      S U M M A R Y

     MODEL   m_SAMENTROP         
     TYPE    MCP                 
     SOLVER  CONVERT             FROM LINE  688

**** SOLVER STATUS     1 Normal Completion         
**** MODEL STATUS      14 No Solution Returned     

 RESOURCE USAGE, LIMIT          0.000      1000.000
 ITERATION COUNT, LIMIT         0          5000
 EVALUATION ERRORS              0             0

Convert 2.0      24.7.4 r58773 Released Sep 19, 2016 LEG x86 64bit/Linux      

--- Using Option File
Reading parameter(s) from "/home/renigijus/gams/opt-mod-lib/gamslib/cesam/convert.opt"
>>  gams cesam-scalar.gms
Finished reading from "/home/renigijus/gams/opt-mod-lib/gamslib/cesam/convert.opt"
Gams      : cesam-scalar.gms


No solution returned
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 10:49:10 Page 32
Cross Entropy SAM Estimation (CESAM,SEQ=228)
E x e c u t i o n


----    709 VARIABLE DENTROPY.L            =  -0.84473876  Entropy difference (objective)
            PARAMETER savedent             =   0.00958558  

----    785 PARAMETER Macsam1  Assigned new balanced SAM flows from CE

              ACT         COM         FAC         ENT         HOU         GRE         GIN         CAP         ROW       TOTAL

ACT                    15.191                               1.976                                           1.274      18.441
COM         7.928                                           6.836       1.657       2.318       2.410                  21.150
FAC         9.810                                                                                                       9.810
ENT                                 3.696                               0.037                                           3.733
HOU                                 6.064       3.442                   0.033                               0.220       9.758
GRE         0.702       0.383       0.050       0.143       0.126                               0.322                   1.727
GIN                                                                                             0.429       1.889       2.318
CAP                                             0.148       0.820                                           2.193       3.161
ROW                     5.576                                                                                           5.576
TOTAL      18.441      21.150       9.810       3.733       9.758       1.727       2.318       3.161       5.576


----    785 PARAMETER Macsam2  Balanced SAM flows from entropy diff x scalesam

              ACT         COM         FAC         ENT         HOU         GRE         GIN         CAP         ROW       TOTAL

ACT                 15190.744                            1975.633                                        1274.139   18440.516
COM      7928.423                                        6835.984    1657.138    2317.950    2410.241               21149.737
FAC      9809.903                                                                                                    9809.903
ENT                              3695.768                              36.899                                        3732.667
HOU                              6063.666    3441.725                  33.136                             219.653    9758.180
GRE       702.189     382.858      50.470     143.199     126.298                             322.159                1727.173
GIN                                                                                           428.916    1889.034    2317.950
CAP                                           147.742     820.265                                        2193.309    3161.316
ROW                  5576.135                                                                                        5576.135
TOTAL   18440.516   21149.737    9809.903    3732.667    9758.180    1727.173    2317.950    3161.316    5576.135


----    785 PARAMETER percent1  percent change of new SAM from original SAM

              ACT         COM         FAC         ENT         HOU         GRE         GIN         CAP         ROW       TOTAL

ACT                     2.450                              -5.969                                         -14.381       0.130
COM         0.138                                          -1.688       5.921      -7.963      -7.220                  -1.865
FAC         0.046                                                                                                       0.046
ENT                                -0.106                              11.814                                          -0.001
HOU                                 0.536       0.709                  11.947                               4.846       0.725
GRE        -4.324       7.123     -32.165     -13.318      -9.464                              -9.677                  -5.469
GIN                                                                                             5.592      10.321       9.415
CAP                                            -1.505      26.359                                           1.361       6.693
ROW                     0.042                                                                                           0.042
TOTAL      -0.088       1.884       0.046      -0.001      -0.862       6.150      -7.963      -5.932       0.042


----    785 PARAMETER SEM                  =  7.612872E-4  Squared Error Measure
            VARIABLE DENTROPY.L            =       -0.845  Entropy difference (objective)
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 10:49:10 Page 33
Cross Entropy SAM Estimation (CESAM,SEQ=228)
E x e c u t i o n


----    785 PARAMETER PosUnbal  Positive unbalanced SAM

              ACT         COM         FAC         ENT         HOU         GRE         GIN         CAP         ROW       TOTAL

ACT                 14827.424                            2101.049                                        1488.157   18416.630
COM      7917.504                                        6953.332    1564.500    2518.500    2597.798               21551.634
FAC      9805.414                                                                                                    9805.414
ENT                              3699.706                              33.000                                        3732.706
HOU                              6031.308    3417.506                  29.600                             209.501    9687.915
GRE       733.927     357.400      74.400     165.200     139.500                             356.673                1827.100
GIN                                                                                           406.200    1712.300    2118.500
CAP                                           150.000     649.156                                        2163.857    2963.013
ROW                  5573.815                                                                                        5573.815
TOTAL   18456.845   20758.639    9805.414    3732.706    9843.037    1627.100    2518.500    3360.671    5573.815


----    785 PARAMETER PosBalan  Positive balanced SAM

              ACT         COM         FAC         ENT         HOU         GRE         GIN         CAP         ROW       TOTAL

ACT                 15190.744                            1975.633                                        1274.139   18440.516
COM      7928.423                                        6835.984    1657.138    2317.950    2410.241               21149.737
FAC      9809.903                                                                                                    9809.903
ENT                              3695.768                              36.899                                        3732.667
HOU                              6063.666    3441.725                  33.136                             219.653    9758.180
GRE       702.189     382.858      50.470     143.199     126.298                             322.159                1727.173
GIN                                                                                           428.916    1889.034    2317.950
CAP                                           147.742     820.265                                        2193.309    3161.316
ROW                  5576.135                                                                                        5576.135
TOTAL   18440.516   21149.737    9809.903    3732.667    9758.180    1727.173    2317.950    3161.316    5576.135


----    785 PARAMETER NormEntrop           =        1.057  Normalized Entropy a measure of total uncertainty

----    785 PARAMETER Diffrnce  Differnce btw original SAM and Final SAM in values

              ACT         COM         FAC         ENT         HOU         GRE         GIN         CAP         ROW       TOTAL

ACT                   363.320                            -125.416                                        -214.018      23.886
COM        10.919                                        -117.348      92.638    -200.550    -187.557                -401.897
FAC         4.489                                                                                                       4.489
ENT                                -3.938                               3.899                                          -0.039
HOU                                32.358      24.219                   3.536                              10.152      70.265
GRE       -31.738      25.458     -23.930     -22.001     -13.202                             -34.514                 -99.927
GIN                                                                                            22.716     176.734     199.450
CAP                                            -2.258     171.109                                          29.452     198.303
ROW                     2.320                                                                                           2.320
TOTAL     -16.329     391.098       4.489      -0.039     -84.857     100.073    -200.550    -199.355       2.320

GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 10:49:10 Page 34
Cross Entropy SAM Estimation (CESAM,SEQ=228)
E x e c u t i o n


----    798 PARAMETER Macsam1  Assigned new balanced SAM flows from CE

              ACT         COM         FAC         ENT         HOU         GRE         GIN         CAP         ROW       TOTAL

ACT                    15.191                               1.976 -3.27000E-4                               1.274      18.440
COM         7.928                                           6.836       1.657       2.318       2.410                  21.150
FAC         9.810                                                                                                       9.810
ENT                                 3.696                               0.037                                           3.733
HOU                                 6.064       3.442                   0.033                               0.220       9.758
GRE         0.702       0.383       0.050       0.143       0.126                              -0.035                   1.370
GIN                                                                                             0.023       1.889       1.912
CAP                                             0.148       0.820      -0.357      -0.406                   2.193       2.398
ROW                     5.576                                                                                           5.576
TOTAL      18.440      21.150       9.810       3.733       9.758       1.370       1.912       2.398       5.576


----    798 PARAMETER Macsam2  Balanced SAM flows from entropy diff x scalesam

              ACT         COM         FAC         ENT         HOU         GRE         GIN         CAP         ROW       TOTAL

ACT                 15190.744                            1975.633      -0.327                            1274.139   18440.189
COM      7928.423                                        6835.984    1657.138    2317.950    2410.241               21149.737
FAC      9809.903                                                                                                    9809.903
ENT                              3695.768                              36.899                                        3732.667
HOU                              6063.666    3441.725                  33.136                             219.653    9758.180
GRE       701.862     382.858      50.470     143.199     126.298                             -34.514                1370.173
GIN                                                                                            22.716    1889.034    1911.750
CAP                                           147.742     820.265    -356.673    -406.200                2193.309    2398.443
ROW                  5576.135                                                                                        5576.135
TOTAL   18440.189   21149.737    9809.903    3732.667    9758.180    1370.173    1911.750    2398.443    5576.135


----    799 PARAMETER gdp0                 =       10.897  base GDP
            PARAMETER gdp00                =       10.895  GDP from final SAM
            VARIABLE GDP.L                 =       10.897  GDP at market prices
            PARAMETER gdpfc0               =        9.805  GDP at factor cost
            VARIABLE GDPFC.L               =        9.805  GDP at factor cost

----    810 PARAMETER ANEW  

              ACT         COM         FAC         ENT         HOU         GRE         GIN         CAP         ROW       TOTAL

ACT                                                                                                                     1.034
COM                                                                                                                     3.467
FAC                                                                                                                     0.479
ENT                                                                                                                     0.358
HOU                                                                                                                     1.439
GRE                                                                                                                     0.193
GIN                                                                                                                     0.427
CAP                                                                                                                     0.465
ROW                                                                                                                     0.237
TOTAL       0.900       0.900       0.900       0.900       0.900       0.900       0.900       0.900       0.900

GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 10:49:10 Page 35
Cross Entropy SAM Estimation (CESAM,SEQ=228)
E x e c u t i o n


----    810 PARAMETER Abar1  Prior SAM adjusted to eliminate negative coefficients

              ACT         COM         FAC         ENT         HOU         GRE         GIN         CAP         ROW       TOTAL

ACT                     0.714                               0.213                                           0.267       1.195
COM         0.429                                           0.706       0.962       1.000       0.773                   3.870
FAC         0.531                                                                                                       0.531
ENT                                 0.377                               0.020                                           0.398
HOU                                 0.615       0.916                   0.018                               0.038       1.586
GRE         0.040       0.017       0.008       0.044       0.014                               0.106                   0.229
GIN                                                                                             0.121       0.307       0.428
CAP                                             0.040       0.066                                           0.388       0.494
ROW                     0.269                                                                                           0.269
TOTAL       1.000       1.000       1.000       1.000       1.000       1.000       1.000       1.000       1.000


----    815 PARAMETER meanerr1             =        0.003  
            PARAMETER meanerr2             =        0.003  


EXECUTION TIME       =        0.002 SECONDS      3 MB  24.7.4 r58773 LEX-LEG


USER: Remigijus Paulavicius, Single User License     S170731:0859AO-LNX
      Imperial College London, Dept. of Chemical Engineering    DC13449
      License for teaching and research at degree granting institutions


**** FILE SUMMARY

Input      /home/renigijus/gams/opt-mod-lib/gamslib/cesam/cesam.gms
Output     /home/renigijus/gams/opt-mod-lib/gamslib/cesam/cesam-scalar.gms.lst
