GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:22:35 Page 1
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


   1  option NLP=convert;
   2  option NLP=convert;
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:22:35 Page 2
Standard QP Model with GDX data input (QP1X,SEQ=246)
C o m p i l a t i o n


       The first in a series of variations on the standard
       QP formulation. The subsequent models exploit data
       and problem structures to arrive at formulations that
       have sensational computational advantages. Additional
       information can be found at:
       
       http://www.gams.com/modlib/adddocs/qp1doc.htm
       
       
      Kalvelagen, E, Model Building with GAMS. forthcoming
       
      de Wetering, A V, private communication.
       
  19   
  20  * From StockMaster at MIT
  21   
  22  sets       days    100 days from 95-11-27 to 96-04-29
  23             stocks  170 selected stocks
  24             upper(stocks,stocks)
  25             lower(stocks,stocks);
  26  alias (stocks,sstocks);
  27   
  28  parameters val(stocks,days)    closing value
  29             return(stocks,days) daily returns - derived;
  30   
  31  * We use the (hopefully Posix-compliant) utility test to check if
  32  * qpdata.gdx is more recent than qpdata.inc. If that's the case we can
  33  * skip the processing of qpdata.inc. test can do more checks. Run test
  34  * --help for a brief overview.
  35  *
  36  * WINDOWS ONLY: From within a GAMS program test and
  37  * other Posix utilities are automatically available. From other
  38  * environments, you need to add the gbin subdirectory of the GAMS
  39  * system directory to your PATH (Windows only).
  40   
  41  * test on AIX and AXU do not have flag -nt so we always regenerate qpdata.gdx
  45   
GDXIN   /home/renigijus/gams/opt-mod-lib/gamslib/qp1x/qpdata.gdx
--- LOAD  days = 1:days
--- LOAD  stocks = 2:stocks
  51   
  52  * Execution time load of closing value
  53  execute_load 'qpdata', val;
  54   
  55  return(stocks,days-1) = val(stocks,days)-val(stocks,days-1);
  56   
  57  upper(stocks,sstocks) = ord(stocks) <= ord(sstocks);
  58  lower(stocks,sstocks) = not upper(stocks,sstocks);
  59   
  60  set d(days)   selected days
  61      s(stocks) selected stocks
  62  alias(s,t);
  63   
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:22:35 Page 3
Standard QP Model with GDX data input (QP1X,SEQ=246)
C o m p i l a t i o n


  64  * setect subset of stocks and periods
  65  d(days)   = ord(days) >1 and ord(days) < 31;
  66  s(stocks) = ord(stocks) < 51;
  67   
  68  parameter mean(stocks)          mean of daily return
  69            dev(stocks,days)      deviations
  70            covar(stocks,sstocks) covariance matrix of returns (upper)
  71            totmean               total mean return;
  72   
  73  mean(s)  = sum(d, return(s,d))/card(d);
  74  dev(s,d) = return(s,d)-mean(s);
  75   
  76  * calculate covariance
  77  * to save memory and time we only compute the uppertriangular
  78  * part as the covariance matrix is symmetric
  79  covar(upper(s,t)) = sum(d, dev(s,d)*dev(t,d))/(card(d)-1);
  80   
  81  totmean = sum(s, mean(s))/(card(s));
  82   
  83  variables z          objective variable
  84            x(stocks)  investments;
  85   
  86  positive variables x;
  87   
  88  equations obj    objective
  89            budget
  90            retcon return constraint
  91            ;
  92   
  93   
  94  obj.. z =e= sum(upper(s,t), x(s)*covar(s,t)*x(t)) +
  95              sum(lower(s,t), x(s)*covar(t,s)*x(t));
  96  budget.. sum(s, x(s)) =e= 1.0;
  97  retcon.. sum(s, mean(s)*x(s)) =g= totmean*1.25;
  98   
  99  model qp1 /all/;
 100   
 101  * Some solvers need more memory
 102  qp1.workfactor = 10;
 103  solve qp1 using nlp minimizing z;
 104  display x.l;
 105   
 106  * Dump solution into GDX file
 107  execute_unload 'qp1xsol',x=xsol;
 108   
 109  * Lets see if the solution was stored correctly
 110  x.l(s) = 0;
 111  execute_load 'qp1xsol',x=xsol;
 112  qp1.iterlim=20;
 113  solve qp1 using nlp minimizing z;
 114   
 115  * Dump reoptimized solution into GDX file
 116  execute_unload 'qp1xso2',x=xsol;
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:22:35 Page 4
Standard QP Model with GDX data input (QP1X,SEQ=246)
C o m p i l a t i o n


 117   
 118  * Compare both GDX files
 119  execute 'gdxdiff qp1xsol qp1xso2  >> "/home/renigijus/gams/opt-mod-lib/gamslib/qp1x/gams-convert.log"';
 120   
 121  * Dump the diff GDX file
 122  execute 'gdxdump diffile  >> "/home/renigijus/gams/opt-mod-lib/gamslib/qp1x/gams-convert.log"';
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:22:35 Page 5
Standard QP Model with GDX data input (QP1X,SEQ=246)
Include File Summary


   SEQ   GLOBAL TYPE      PARENT   LOCAL  FILENAME

     1        1 INPUT          0       0  /home/renigijus/gams/opt-mod-lib/gamslib/qp1x/qp1x.gms
     2       46 CALL           1      46  =test qpdata.gdx -nt qpdata.inc
     3       49 GDXIN          1      49  /home/renigijus/gams/opt-mod-lib/gamslib/qp1x/qpdata.gdx


COMPILATION TIME     =        0.003 SECONDS      3 MB  24.7.4 r58773 LEX-LEG
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:22:35 Page 6
Standard QP Model with GDX data input (QP1X,SEQ=246)
Equation Listing    SOLVE qp1 Using NLP From line 103


---- obj  =E=  objective

obj..  z + (0)*x(GAB) + (0)*x(GAP) + (0)*x(GDW) + (0)*x(GE) + (0)*x(GEN) + (0)*x(GENZ) + (0)*x(GGUY) + (0)*x(GIS) + (0)*x(GM) + (0)*x(GME) + (0)*x(GNE) + (0)*x(GNTX) + (0)*x(GPS) + (0)*x(GPTA) + (0)*x(GSTRF) + (0)*x(GT) + (0)*x(GTE) + (0)*x(GTR)
     
      + (0)*x(GWF) + (0)*x(GYMB) + (0)*x(AA) + (0)*x(AAA) + (0)*x(AALR) + (0)*x(AAPL) + (0)*x(ABF) + (0)*x(ABX) + (0)*x(ACAD) + (0)*x(ACN) + (0)*x(ACTL) + (0)*x(ADAC) + (0)*x(ADBE) + (0)*x(ADCT) + (0)*x(ADDR) + (0)*x(ADPT) + (0)*x(ADV) + (0)*x(AET)
     
      + (0)*x(AGN) + (0)*x(AHP) + (0)*x(AKLM) + (0)*x(ALD) + (0)*x(ALEX) + (0)*x(ALRT) + (0)*x(ALSC) + (0)*x(ALTR) + (0)*x(ALU) + (0)*x(AM) + (0)*x(AMA) + (0)*x(AMAT) + (0)*x(AMD) + (0)*x(AMER) =E= 0 ; (LHS = 0)
     

---- budget  =E=  

budget..  x(GAB) + x(GAP) + x(GDW) + x(GE) + x(GEN) + x(GENZ) + x(GGUY) + x(GIS) + x(GM) + x(GME) + x(GNE) + x(GNTX) + x(GPS) + x(GPTA) + x(GSTRF) + x(GT) + x(GTE) + x(GTR) + x(GWF) + x(GYMB) + x(AA) + x(AAA) + x(AALR) + x(AAPL) + x(ABF) + x(ABX)
     
      + x(ACAD) + x(ACN) + x(ACTL) + x(ADAC) + x(ADBE) + x(ADCT) + x(ADDR) + x(ADPT) + x(ADV) + x(AET) + x(AGN) + x(AHP) + x(AKLM) + x(ALD) + x(ALEX) + x(ALRT) + x(ALSC) + x(ALTR) + x(ALU) + x(AM) + x(AMA) + x(AMAT) + x(AMD) + x(AMER) =E= 1 ;
     
      (LHS = 0, INFES = 1 ****)
     

---- retcon  =G=  return constraint

retcon..  - 0.0517241379310345*x(GAP) + 0.0558620689655172*x(GDW) + 0.116551724137931*x(GE) - 0.0172413793103448*x(GENZ) - 0.0496551724137931*x(GGUY) - 0.0644827586206896*x(GIS) + 0.00862068965517241*x(GME) + 0.0689655172413793*x(GNE)
     
      - 0.0172413793103448*x(GNTX) - 0.0948275862068965*x(GPS) - 0.0475862068965517*x(GPTA) + 0.344827586206897*x(GSTRF) + 0.0299999999999999*x(GT) + 0.0131034482758622*x(GTE) + 0.0562068965517241*x(GTR) - 0.0644827586206897*x(GWF)
     
      - 0.301724137931034*x(GYMB) - 0.241379310344828*x(AA) - 0.00206896551724138*x(AAA) - 0.0258620689655172*x(AALR) - 0.198275862068966*x(AAPL) - 0.0389655172413793*x(ABF) + 0.0775862068965517*x(ABX) - 0.206896551724138*x(ACAD)
     
      + 0.0562068965517242*x(ACN) - 0.0775862068965517*x(ACTL) + 0.0689655172413793*x(ADAC) - 1.04310344827586*x(ADBE) - 0.327586206896552*x(ADCT) - 0.0217241379310345*x(ADDR) - 0.155172413793103*x(ADPT) - 0.0172413793103448*x(ADV)
     
      - 0.28448275862069*x(AET) + 0.0558620689655173*x(AGN) + 0.163793103448276*x(AHP) - 0.370689655172414*x(AKLM) + 0.0172413793103448*x(ALD) - 0.03*x(ALEX) + 0.0475862068965517*x(ALRT) - 0.517241379310345*x(ALSC) - 0.21551724137931*x(ALTR)
     
      + 0.00655172413793105*x(ALU) - 0.0537931034482758*x(AM) - 0.0148275862068966*x(AMA) - 0.417931034482759*x(AMAT) - 0.103448275862069*x(AMD) - 0.124827586206896*x(AMER) =G= -0.100241379310345 ; (LHS = 0)
     
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:22:35 Page 7
Standard QP Model with GDX data input (QP1X,SEQ=246)
Column Listing      SOLVE qp1 Using NLP From line 103


---- z  objective variable

z
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       obj


---- x  investments

x(GAB)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
       (0)      obj
        1       budget

x(GAP)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
       (0)      obj
        1       budget
       -0.0517  retcon

x(GDW)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
       (0)      obj
        1       budget
        0.0559  retcon

REMAINING 47 ENTRIES SKIPPED
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:22:35 Page 8
Standard QP Model with GDX data input (QP1X,SEQ=246)
Model Statistics    SOLVE qp1 Using NLP From line 103


MODEL STATISTICS

BLOCKS OF EQUATIONS           3     SINGLE EQUATIONS            3
BLOCKS OF VARIABLES           2     SINGLE VARIABLES           51
NON ZERO ELEMENTS           148     NON LINEAR N-Z             50
DERIVATIVE POOL              20     CONSTANT POOL           1,291
CODE LENGTH              10,002


GENERATION TIME      =        0.004 SECONDS      6 MB  24.7.4 r58773 LEX-LEG


EXECUTION TIME       =        0.020 SECONDS      6 MB  24.7.4 r58773 LEX-LEG
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:22:35 Page 9
Standard QP Model with GDX data input (QP1X,SEQ=246)
Solution Report     SOLVE qp1 Using NLP From line 103


               S O L V E      S U M M A R Y

     MODEL   qp1                 OBJECTIVE  z
     TYPE    NLP                 DIRECTION  MINIMIZE
     SOLVER  CONVERT             FROM LINE  103

**** SOLVER STATUS     1 Normal Completion         
**** MODEL STATUS      14 No Solution Returned     
**** OBJECTIVE VALUE                0.0000

 RESOURCE USAGE, LIMIT          0.000      1000.000
 ITERATION COUNT, LIMIT         0    2000000000
 EVALUATION ERRORS              0             0

Convert 2.0      24.7.4 r58773 Released Sep 19, 2016 LEG x86 64bit/Linux      

--- Using Option File
Reading parameter(s) from "/home/renigijus/gams/opt-mod-lib/gamslib/qp1x/convert.opt"
>>  gams qp1x-scalar.gms
Finished reading from "/home/renigijus/gams/opt-mod-lib/gamslib/qp1x/convert.opt"
Gams      : qp1x-scalar.gms


No solution returned
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:22:35 Page 10
Standard QP Model with GDX data input (QP1X,SEQ=246)
E x e c u t i o n


----    104 VARIABLE x.L  investments

                      ( ALL       0.000 )

GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:22:35 Page 11
Standard QP Model with GDX data input (QP1X,SEQ=246)
Equation Listing    SOLVE qp1 Using NLP From line 113


---- obj  =E=  objective

obj..  z + (0)*x(GAB) + (0)*x(GAP) + (0)*x(GDW) + (0)*x(GE) + (0)*x(GEN) + (0)*x(GENZ) + (0)*x(GGUY) + (0)*x(GIS) + (0)*x(GM) + (0)*x(GME) + (0)*x(GNE) + (0)*x(GNTX) + (0)*x(GPS) + (0)*x(GPTA) + (0)*x(GSTRF) + (0)*x(GT) + (0)*x(GTE) + (0)*x(GTR)
     
      + (0)*x(GWF) + (0)*x(GYMB) + (0)*x(AA) + (0)*x(AAA) + (0)*x(AALR) + (0)*x(AAPL) + (0)*x(ABF) + (0)*x(ABX) + (0)*x(ACAD) + (0)*x(ACN) + (0)*x(ACTL) + (0)*x(ADAC) + (0)*x(ADBE) + (0)*x(ADCT) + (0)*x(ADDR) + (0)*x(ADPT) + (0)*x(ADV) + (0)*x(AET)
     
      + (0)*x(AGN) + (0)*x(AHP) + (0)*x(AKLM) + (0)*x(ALD) + (0)*x(ALEX) + (0)*x(ALRT) + (0)*x(ALSC) + (0)*x(ALTR) + (0)*x(ALU) + (0)*x(AM) + (0)*x(AMA) + (0)*x(AMAT) + (0)*x(AMD) + (0)*x(AMER) =E= 0 ; (LHS = 0)
     

---- budget  =E=  

budget..  x(GAB) + x(GAP) + x(GDW) + x(GE) + x(GEN) + x(GENZ) + x(GGUY) + x(GIS) + x(GM) + x(GME) + x(GNE) + x(GNTX) + x(GPS) + x(GPTA) + x(GSTRF) + x(GT) + x(GTE) + x(GTR) + x(GWF) + x(GYMB) + x(AA) + x(AAA) + x(AALR) + x(AAPL) + x(ABF) + x(ABX)
     
      + x(ACAD) + x(ACN) + x(ACTL) + x(ADAC) + x(ADBE) + x(ADCT) + x(ADDR) + x(ADPT) + x(ADV) + x(AET) + x(AGN) + x(AHP) + x(AKLM) + x(ALD) + x(ALEX) + x(ALRT) + x(ALSC) + x(ALTR) + x(ALU) + x(AM) + x(AMA) + x(AMAT) + x(AMD) + x(AMER) =E= 1 ;
     
      (LHS = 0, INFES = 1 ****)
     

---- retcon  =G=  return constraint

retcon..  - 0.0517241379310345*x(GAP) + 0.0558620689655172*x(GDW) + 0.116551724137931*x(GE) - 0.0172413793103448*x(GENZ) - 0.0496551724137931*x(GGUY) - 0.0644827586206896*x(GIS) + 0.00862068965517241*x(GME) + 0.0689655172413793*x(GNE)
     
      - 0.0172413793103448*x(GNTX) - 0.0948275862068965*x(GPS) - 0.0475862068965517*x(GPTA) + 0.344827586206897*x(GSTRF) + 0.0299999999999999*x(GT) + 0.0131034482758622*x(GTE) + 0.0562068965517241*x(GTR) - 0.0644827586206897*x(GWF)
     
      - 0.301724137931034*x(GYMB) - 0.241379310344828*x(AA) - 0.00206896551724138*x(AAA) - 0.0258620689655172*x(AALR) - 0.198275862068966*x(AAPL) - 0.0389655172413793*x(ABF) + 0.0775862068965517*x(ABX) - 0.206896551724138*x(ACAD)
     
      + 0.0562068965517242*x(ACN) - 0.0775862068965517*x(ACTL) + 0.0689655172413793*x(ADAC) - 1.04310344827586*x(ADBE) - 0.327586206896552*x(ADCT) - 0.0217241379310345*x(ADDR) - 0.155172413793103*x(ADPT) - 0.0172413793103448*x(ADV)
     
      - 0.28448275862069*x(AET) + 0.0558620689655173*x(AGN) + 0.163793103448276*x(AHP) - 0.370689655172414*x(AKLM) + 0.0172413793103448*x(ALD) - 0.03*x(ALEX) + 0.0475862068965517*x(ALRT) - 0.517241379310345*x(ALSC) - 0.21551724137931*x(ALTR)
     
      + 0.00655172413793105*x(ALU) - 0.0537931034482758*x(AM) - 0.0148275862068966*x(AMA) - 0.417931034482759*x(AMAT) - 0.103448275862069*x(AMD) - 0.124827586206896*x(AMER) =G= -0.100241379310345 ; (LHS = 0)
     
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:22:35 Page 12
Standard QP Model with GDX data input (QP1X,SEQ=246)
Column Listing      SOLVE qp1 Using NLP From line 113


---- z  objective variable

z
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       obj


---- x  investments

x(GAB)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
       (0)      obj
        1       budget

x(GAP)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
       (0)      obj
        1       budget
       -0.0517  retcon

x(GDW)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
       (0)      obj
        1       budget
        0.0559  retcon

REMAINING 47 ENTRIES SKIPPED
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:22:35 Page 13
Standard QP Model with GDX data input (QP1X,SEQ=246)
Model Statistics    SOLVE qp1 Using NLP From line 113


MODEL STATISTICS

BLOCKS OF EQUATIONS           3     SINGLE EQUATIONS            3
BLOCKS OF VARIABLES           2     SINGLE VARIABLES           51
NON ZERO ELEMENTS           148     NON LINEAR N-Z             50
DERIVATIVE POOL              20     CONSTANT POOL           1,291
CODE LENGTH              10,002


GENERATION TIME      =        0.006 SECONDS      5 MB  24.7.4 r58773 LEX-LEG


EXECUTION TIME       =        0.007 SECONDS      5 MB  24.7.4 r58773 LEX-LEG
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:22:35 Page 14
Standard QP Model with GDX data input (QP1X,SEQ=246)
Solution Report     SOLVE qp1 Using NLP From line 113


               S O L V E      S U M M A R Y

     MODEL   qp1                 OBJECTIVE  z
     TYPE    NLP                 DIRECTION  MINIMIZE
     SOLVER  CONVERT             FROM LINE  113

**** SOLVER STATUS     1 Normal Completion         
**** MODEL STATUS      14 No Solution Returned     
**** OBJECTIVE VALUE                0.0000

 RESOURCE USAGE, LIMIT          0.000      1000.000
 ITERATION COUNT, LIMIT         0            20
 EVALUATION ERRORS              0             0

Convert 2.0      24.7.4 r58773 Released Sep 19, 2016 LEG x86 64bit/Linux      

--- Using Option File
Reading parameter(s) from "/home/renigijus/gams/opt-mod-lib/gamslib/qp1x/convert.opt"
>>  gams qp1x-scalar.gms
Finished reading from "/home/renigijus/gams/opt-mod-lib/gamslib/qp1x/convert.opt"
Gams      : qp1x-scalar.gms


No solution returned
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:22:35 Page 15
Standard QP Model with GDX data input (QP1X,SEQ=246)
E x e c u t i o n


EXECUTION TIME       =        0.010 SECONDS      4 MB  24.7.4 r58773 LEX-LEG


USER: Remigijus Paulavicius, Single User License     S170731:0859AO-LNX
      Imperial College London, Dept. of Chemical Engineering    DC13449
      License for teaching and research at degree granting institutions


**** FILE SUMMARY

Input      /home/renigijus/gams/opt-mod-lib/gamslib/qp1x/qp1x.gms
Output     /home/renigijus/gams/opt-mod-lib/gamslib/qp1x/qp1x-scalar.gms.lst
