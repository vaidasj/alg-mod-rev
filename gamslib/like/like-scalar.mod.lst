GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:33 Page 1
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


   1  option NLP=convert;
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:33 Page 2
Maximum Likelihood Estimation  (LIKE,SEQ=25)
C o m p i l a t i o n


       
      This application from the biomedical area tests the hypothesis
      that a population of systolic blood pressure can be separated into
      three distinct groups.
       
       
      Bracken, J, and McCormick, G P, Chapter 8.5. In Selected Applications of
      Nonlinear Programming. John Wiley and Sons, New York, 1968, pp. 90-92.
       
  14   
  15   sets  i  observations  / 1*31 /
  16         g  groups        / one, two, three /
  17   
  18   
  19         table  data(*,i)  systolic blood pressure data
  20   
  21              1   2   3   4   5   6   7   8   9  10  11  12  13  14  15
  22  pressure   95 105 110 115 120 125 130 135 140 145 150 155 160 165 170
  23  frequency   1   1   4   4  15  15  15  13  21  12  17   4  20   8  17
  24   
  25    +        16  17  18  19  20  21  22  23  24  25  26  27  28  29  30  31
  26  pressure  175 180 185 190 195 200 205 210 215 220 225 230 235 240 245 260
  27  frequency   8   6   6   7   4   3   3   8   1   6   0   5   1   7   1   2
  28   
  29    parameters  y(i)   pressure
  30                w(i)   frequency weight
  31                c      constant ;
  32   
  33    y(i) = data("pressure",i);  w(i) = data("frequency",i);
  34    c    = 1/sqrt(2*3.14159); display y, w, c;
  35   
  36    positive variables  p(g)   proportion of population
  37                        m(g)   population mean
  38                        s(g)   population standard deviation
  39             variable   mlf    maximum likelihood value
  40   
  41    equations like, pdef, rank;
  42   
  43   
  44  like.. mlf =e= sum(i, w(i)*log(c*sum(g, p(g)/s(g)*exp(-.5*sqr((y(i)-m(g))/s(g))))));
  45   
  46  pdef.. sum(g, p(g)) =e= 1 ;
  47   
  48  rank(g+1).. m(g+1) =g= m(g);
  49   
  50  model ml1 maximum likelihood - ordered    / like,pdef,rank /
  51        ml2 maximum likelihood - unordered  / like,pdef / ;
  52   
  53  p.l(g) = 1/3; m.l(g) = 100 + 30*ord(g); s.l(g) = 15;
  54   
  55  p.lo(g)=.1;
  56  s.lo(g)=.1;
  57   
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:33 Page 3
Maximum Likelihood Estimation  (LIKE,SEQ=25)
C o m p i l a t i o n


  58  *  reported solution below gives a nonoptimal solution
  59  *  p.fx('one')   = .365;
  60  *  p.fx('two')   = .475;
  61  *  p.fx('three') = .160;
  62   
  63  option domlim  = 1e3;
  64  ml1.workfactor = 1.5;
  65  solve ml1 maximizing mlf using nlp;
  66   


COMPILATION TIME     =        0.000 SECONDS      3 MB  24.7.4 r58773 LEX-LEG
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:33 Page 4
Maximum Likelihood Estimation  (LIKE,SEQ=25)
E x e c u t i o n


----     34 PARAMETER y  pressure

1   95.000,    2  105.000,    3  110.000,    4  115.000,    5  120.000,    6  125.000,    7  130.000,    8  135.000,    9  140.000,    10 145.000,    11 150.000,    12 155.000,    13 160.000,    14 165.000,    15 170.000,    16 175.000,    17 180.000
18 185.000,    19 190.000,    20 195.000,    21 200.000,    22 205.000,    23 210.000,    24 215.000,    25 220.000,    26 225.000,    27 230.000,    28 235.000,    29 240.000,    30 245.000,    31 260.000


----     34 PARAMETER w  frequency weight

1   1.000,    2   1.000,    3   4.000,    4   4.000,    5  15.000,    6  15.000,    7  15.000,    8  13.000,    9  21.000,    10 12.000,    11 17.000,    12  4.000,    13 20.000,    14  8.000,    15 17.000,    16  8.000,    17  6.000,    18  6.000
19  7.000,    20  4.000,    21  3.000,    22  3.000,    23  8.000,    24  1.000,    25  6.000,    27  5.000,    28  1.000,    29  7.000,    30  1.000,    31  2.000


----     34 PARAMETER c                    =        0.399  constant
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:33 Page 5
Maximum Likelihood Estimation  (LIKE,SEQ=25)
Equation Listing    SOLVE ml1 Using NLP From line 65


---- like  =E=  

like..  - (273.357546769956)*p(one) - (223.300166140744)*p(two) - (208.3422870893)*p(three) - (0.432229488230094)*m(one) + (0.98029952185266)*m(two) - (3.88208157498506)*m(three) + (1.59584625568489)*s(one) + (0.135949719276876)*s(two)
     
      - (12.692402396008)*s(three) + mlf =E= 0 ; (LHS = 1204.29932824022, INFES = 1204.29932824022 ****)
     

---- pdef  =E=  

pdef..  p(one) + p(two) + p(three) =E= 1 ; (LHS = 1)
     

---- rank  =G=  

rank(two)..  - m(one) + m(two) =G= 0 ; (LHS = 30)
     
rank(three)..  - m(two) + m(three) =G= 0 ; (LHS = 30)
     
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:33 Page 6
Maximum Likelihood Estimation  (LIKE,SEQ=25)
Column Listing      SOLVE ml1 Using NLP From line 65


---- p  proportion of population

p(one)
                (.LO, .L, .UP, .M = 0.1, 0.333333333333333, +INF, 0)
    (-273.3575) like
        1       pdef

p(two)
                (.LO, .L, .UP, .M = 0.1, 0.333333333333333, +INF, 0)
    (-223.3002) like
        1       pdef

p(three)
                (.LO, .L, .UP, .M = 0.1, 0.333333333333333, +INF, 0)
    (-208.3423) like
        1       pdef


---- m  population mean

m(one)
                (.LO, .L, .UP, .M = 0, 130, +INF, 0)
      (-0.4322) like
       -1       rank(two)

m(two)
                (.LO, .L, .UP, .M = 0, 160, +INF, 0)
       (0.9803) like
        1       rank(two)
       -1       rank(three)

m(three)
                (.LO, .L, .UP, .M = 0, 190, +INF, 0)
      (-3.8821) like
        1       rank(three)


---- s  population standard deviation

s(one)
                (.LO, .L, .UP, .M = 0.1, 15, +INF, 0)
       (1.5958) like

s(two)
                (.LO, .L, .UP, .M = 0.1, 15, +INF, 0)
       (0.1359) like

s(three)
                (.LO, .L, .UP, .M = 0.1, 15, +INF, 0)
     (-12.6924) like

GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:33 Page 7
Maximum Likelihood Estimation  (LIKE,SEQ=25)
Column Listing      SOLVE ml1 Using NLP From line 65


---- mlf  maximum likelihood value

mlf
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       like

GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:33 Page 8
Maximum Likelihood Estimation  (LIKE,SEQ=25)
Model Statistics    SOLVE ml1 Using NLP From line 65


MODEL STATISTICS

BLOCKS OF EQUATIONS           3     SINGLE EQUATIONS            4
BLOCKS OF VARIABLES           4     SINGLE VARIABLES           10
NON ZERO ELEMENTS            17     NON LINEAR N-Z              9
DERIVATIVE POOL              20     CONSTANT POOL              57
CODE LENGTH               1,232


GENERATION TIME      =        0.002 SECONDS      4 MB  24.7.4 r58773 LEX-LEG


EXECUTION TIME       =        0.002 SECONDS      4 MB  24.7.4 r58773 LEX-LEG
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:33 Page 9
Maximum Likelihood Estimation  (LIKE,SEQ=25)
Solution Report     SOLVE ml1 Using NLP From line 65


               S O L V E      S U M M A R Y

     MODEL   ml1                 OBJECTIVE  mlf
     TYPE    NLP                 DIRECTION  MAXIMIZE
     SOLVER  CONVERT             FROM LINE  65

**** SOLVER STATUS     1 Normal Completion         
**** MODEL STATUS      14 No Solution Returned     
**** OBJECTIVE VALUE                0.0000

 RESOURCE USAGE, LIMIT          0.000      1000.000
 ITERATION COUNT, LIMIT         0    2000000000
 EVALUATION ERRORS              0          1000

Convert 2.0      24.7.4 r58773 Released Sep 19, 2016 LEG x86 64bit/Linux      

--- Using Option File
Reading parameter(s) from "/home/renigijus/gams/opt-mod-lib/gamslib/like/convert.opt"
>>  ampl like-scalar.mod
Finished reading from "/home/renigijus/gams/opt-mod-lib/gamslib/like/convert.opt"
Ampl      : like-scalar.mod


No solution returned


EXECUTION TIME       =        0.000 SECONDS      2 MB  24.7.4 r58773 LEX-LEG


USER: Remigijus Paulavicius, Single User License     S170731:0859AO-LNX
      Imperial College London, Dept. of Chemical Engineering    DC13449
      License for teaching and research at degree granting institutions


**** FILE SUMMARY

Input      /home/renigijus/gams/opt-mod-lib/gamslib/like/like.gms
Output     /home/renigijus/gams/opt-mod-lib/gamslib/like/like-scalar.mod.lst
