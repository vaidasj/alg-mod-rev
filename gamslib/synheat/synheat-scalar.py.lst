GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:52 Page 1
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


   1  option MINLP=convert;
   2  option MINLP=convert;
   3  option MINLP=convert;
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:52 Page 2
Simultaneous Optimization for HEN Synthesis (SYNHEAT,SEQ=117)
C o m p i l a t i o n


   5   
       
        This model designs a heat exchanger network which operates at
        minimal annual cost and satisfies heating and cooling require-
        -ments. The superstructure consists of two stages with eight
        possible exchangers
       
       
      Yee, T F, and Grossmann, I E, Simultaneous Optimization of Models for
      Heat Integration - Heat Exchanger Network Synthesis. Computers and
      Chemical Engineering 14, 10 (1990), 1151-1184.
       
  19   
  20   
  21   Sets i hot streams /1*2/
  22        j cold streams /1*2/;
  23   
  24   Scalar nok  number of stages in superstructure / 2 /;
  25   
  26   Set  k          temperature locations  nok + 1 /1*3/
  27        st(k)      stages
  28        first(k)   first temperature location
  29        last(k)    last temperature location ;
  30   
  31   
  32   st(k)    = yes$(ord(k) lt card(k))  ;
  33   first(k) = yes$(ord(k) eq 1)        ;
  34   last(k)  = yes$(ord(k) eq card(k))  ;
  35   
  36   
  37   
  38   Parameters
  39   
  40   fh(i)      heat capacity flowrate of hot stream
  41   fc(j)      heat capacity flowrate of cold stream
  42   thin(i)    supply temp. of hot stream
  43   thout(i)   target temp. of hot stream
  44   tcin(j)    supply temp. of cold stream
  45   tcout(j)   target temp. of cold stream
  46   ech(i)     heat content hot i
  47   ecc(j)     heat content cold j
  48   hh(i)      stream-individual film coefficient hot i,
  49   hc(j)      stream-individual film coefficient cold j,
  50   hucost     cost of heating utility,
  51   cucost     cost of cooling utility,
  52   unitc      fixed charge for exchanger,
  53   acoeff     area cost coefficient for exchangers,
  54   hucoeff    area cost coefficient for heaters,
  55   cucoeff    area cost coefficient for coolers,
  56   aexp       cost exponent for exchangers,
  57   hhu        stream-individual film coefficient hot utility,
  58   hcu        stream-individual film coefficient cold utility,
  59   thuin      inlet temperature hot utility,
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:52 Page 3
Simultaneous Optimization for HEN Synthesis (SYNHEAT,SEQ=117)
C o m p i l a t i o n


  60   thuout     outlet temperature hot utility,
  61   tcuin      inlet temperature cold utility,
  62   tcuout     outlet temperature cold utility,
  63   gamma(i,j) upper bound of driving force,
  64   a(i,j,k)   area for exchanger for match ij in interval k (chen approx.),
  65   al(i,j,k)  area calculated with log mean,
  66   acu(i)     area coolers,
  67   ahu(j)     area heaters,
  68   tmapp      minimum approach temperature
  69   costheat   cost of heating,
  70   costcool   cost of cooling,
  71   invcost    investment cost   ;
  72   
  73   Binary Variables      z(i,j,k), zcu(i), zhu(j)  ;
  74   
  75   Positive Variables
  76     th(i,k)    temperature of  hot stream i as it enters stage k
  77     tc(j,k)    temperature of cold stream j as it leaves stage k
  78     q(i,j,k)   energy exchanged between i and j in stage k
  79     qc(i)      energy exchanged between i and the cold utility
  80     qh(j)      energy exchanged between j and the hot utility
  81     dt(i,j,k)  approach between i and j at location k
  82     dtcu(i)    approach between i and the cold utility
  83     dthu(j)    approach between j and the hot utility    ;
  84   
  85   Variable cost    hen and utility cost       ;
  86   
  87   Equations
  88    eh(i,k)       energy exchanged by hot  stream i in stage k
  89    eqc(i,k)      energy exchanged by hot  stream i with the cold utility
  90    teh(i)        total energy exchanged by hot  stream i
  91    ec(j,k)       energy exchanged by cold stream j in stage k
  92    eqh(j,k)      energy exchanged by cold stream j with the hot utility
  93    tec(j)        total energy exchanged by cold  stream j
  94    month(i,k)    monotonicity of th
  95    montc(j,k)    monotonicity of tc
  96    monthl(i,k)   monotonicity of th k = last
  97    montcf(j,k)   monotonicity of tc for k = 1
  98    tinh(i,k)     supply temperature of hot streams
  99    tinc(j,k)     supply temperature of cold streams
 100    logq(i,j,k)   logical constraints on  q
 101    logqh(j)      logical constraints on qh(j)
 102    logqc(i)      logical constraints on qc(i)
 103    logdth(i,j,k) logical constraints on dt at the  hot end
 104    logdtc(i,j,k) logical constraints on dt at the cold end
 105    logdtcu(i,k)  logical constraints on dtcu
 106    logdthu(j,k)  logical constraints on dthu
 107    obj           objective function         ;
 108   
 109   
 110   teh(i).. (thin(i)-thout(i))*fh(i) =e= sum((j,st), q(i,j,st)) + qc(i) ;
 111   tec(j).. (tcout(j)-tcin(j))*fc(j) =e= sum((i,st), q(i,j,st)) + qh(j) ;
 112   
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:52 Page 4
Simultaneous Optimization for HEN Synthesis (SYNHEAT,SEQ=117)
C o m p i l a t i o n


 113   eh(i,k)$st(k).. fh(i)*(th(i,k) - th(i,k+1)) =e= sum(j, q(i,j,k))  ;
 114   ec(j,k)$st(k).. fc(j)*(tc(j,k) - tc(j,k+1)) =e= sum(i,q(i,j,k)) ;
 115   
 116   eqc(i,k)$last(k)..  fh(i)*(th(i,k) - thout(i)) =e= qc(i) ;
 117   eqh(j,k)$first(k).. fc(j)*(tcout(j) - tc(j,k)) =e= qh(j) ;
 118   
 119   tinh(i,k)$first(k).. thin(i) =e= th(i,k) ;
 120   tinc(j,k)$last(k)..  tcin(j) =e= tc(j,k) ;
 121   
 122   month(i,k)$st(k).. th(i,k) =g= th(i,k+1) ;
 123   montc(j,k)$st(k).. tc(j,k) =g= tc(j,k+1) ;
 124   
 125   monthl(i,k)$last(k).. th(i,k) =g= thout(i) ;
 126   montcf(j,k)$first(k)..tcout(j) =g= tc(j,k) ;
 127   
 128   logq(i,j,k)$st(k)..q(i,j,k) - min(ech(i), ecc(j))*z(i,j,k) =l= 0 ;
 129   
 130   logqc(i)..qc(i) - ech(i)*zcu(i) =l= 0 ;
 131   logqh(j)..qh(j) - ecc(j)*zhu(j) =l= 0 ;
 132   
 133   logdth(i,j,k)$st(k)..dt(i,j,k) =l= th(i,k) - tc(j,k) +
 134                                      gamma(i,j)*(1 - z(i,j,k)) ;
 135   
 136   logdtc(i,j,k)$st(k)..dt(i,j,k+1) =l= th(i,k+1)-tc(j,k+1) +
 137                                        gamma(i,j)*(1 - z(i,j,k)) ;
 138   
 139   logdthu(j,k)$first(k)..dthu(j) =l= (thuout - tc(j,k)) ;
 140   logdtcu(i,k)$last(k)..dtcu(i) =l= th(i,k) - tcuout ;
 141   
 142   obj..cost =e= unitc*(sum((i,j,st),z(i,j,st)) +
 143                 sum(i,zcu(i)) + sum(j,zhu(j))) +
 144   
 145                 acoeff*sum((i,j,k),(q(i,j,k)*((1/hh(i))+(1/hc(j)))/
 146                 (((dt(i,j,k)*dt(i,j,k+1)*(dt(i,j,k) + dt(i,j,k+1))/2 +
 147                 1e-6)**0.33333) + 1e-6) + 1e-6)**aexp) +
 148   
 149                 hucoeff*(sum(j,(qh(j)*((1/hc(j))+1/hhu))/
 150                 (((thuin-tcout(j))*dthu(j)*((thuin-tcout(j)+dthu(j))/2)+
 151                 1e-6)**0.33333) + 1e-6)**aexp) +
 152   
 153                 cucoeff*sum(i,(qc(i)*((1/hh(i))+(1/hcu))/
 154                 (((thout(i)-tcuin)*dtcu(i)*(thout(i)-tcuin+dtcu(i))/2 +
 155                 1e-6)**0.33333) + 1e-6)**aexp) +
 156   
 157                 sum(j,qh(j)*hucost) + sum(i,qc(i)*cucost) ;
 158   
 159   
 160   
 161  * process streams
 162   
 163  * hot
 164   
 165   thin('1')=650;  thout('1')=370;  fh('1')=10; hh('1')=1;
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:52 Page 5
Simultaneous Optimization for HEN Synthesis (SYNHEAT,SEQ=117)
C o m p i l a t i o n


 166   thin('2')=590;  thout('2')=370;  fh('2')=20; hh('2')=1;
 167   
 168  * cold
 169   
 170    tcin('1')=410;  tcout('1')=650;  fc('1')=15;  hc('1')=1;
 171    tcin('2')=350;  tcout('2')=500;  fc('2')=13;  hc('2')=1;
 172   
 173  * costs and coefficients
 174   
 175   hucost =80; hucoeff =150; thuin  =680; thuout =680; hhu   =5;
 176   cucost =15; cucoeff =150; tcuin  =300; tcuout =320; hcu   =1;
 177   
 178   unitc  =5500;   acoeff =150;  aexp   =1;
 179   
 180   
 181   tmapp = 10;
 182   
 183  * bounds
 184   
 185   dt.lo(i,j,k) = tmapp ;
 186   dthu.lo(j) = tmapp ;
 187   dtcu.lo(i) = tmapp ;
 188   
 189   th.up(i,k) = thin(i) ;
 190   th.lo(i,k) = thout(i) ;
 191   tc.up(j,k) = tcout(j) ;
 192   tc.lo(j,k) = tcin(j) ;
 193   
 194  * initialization
 195   
 196   th.l(i,k) = thin(i) ;
 197   tc.l(j,k) = tcin(j) ;
 198   
 199   dthu.l(j) = thuout - tcin(j) ;
 200   dtcu.l(i) = thin(i) - tcuout ;
 201   
 202   ech(i) = fh(i)*(thin(i) - thout(i)) ;
 203   ecc(j) = fc(j)*(tcout(j) - tcin(j)) ;
 204   
 205   gamma(i,j) = max(0,tcin(j) - thin(i), tcin(j) - thout(i),
 206                    tcout(j) - thin(i), tcout(j) - thout(i)) ;
 207   
 208   dt.l(i,j,k) = thin(i) - tcin(j) ;
 209   
 210   q.l(i,j,k)$st(k) = min(ech(i),ecc(j)) ;
 211   
 212   
 213   
 214   Model super/all/ ;
 215   
 216   Option optcr    = 0 ;
 217   Option limrow   = 0 ;
 218   Option limcol   = 0 ;
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:52 Page 6
Simultaneous Optimization for HEN Synthesis (SYNHEAT,SEQ=117)
C o m p i l a t i o n


 219   Option solprint = off ;
 220   Option sysout   = off ;
 221   
 222   
 223   Solve super using minlp minimizing cost ;
 224   
 225  *  areas by chen approximation
 226   
 227   a(i,j,k)$st(k) = q.l(i,j,k)*((1/hh(i))+(1/hc(j)))/
 228                    (2/3*sqrt(dt.l(i,j,k)*dt.l(i,j,k+1)) +
 229                     1/6*(1e-8 + dt.l(i,j,k) + dt.l(i,j,k+1))) ;
 230   
 231  *  areas by log mean temperature
 232   
 233   al(i,j,k)$st(k) = (q.l(i,j,k)*((1/hh(i))+(1/hc(j))))/
 234                     (dt.l(i,j,k)*dt.l(i,j,k+1)*
 235                     (dt.l(i,j,k)+dt.l(i,j,k+1))/2)**0.33333  ;
 236   
 237   
 238   display a,al ;
 239   
 240   
 241  * areas of heaters and coolers
 242   
 243   ahu(j) = (qh.l(j)*((1/hc(j)) + (1/hhu))/(((thuin-tcout(j))*dthu.l(j)*
 244            ((thuin-tcout(j)+dthu.l(j)))/2) + 1e-6)**0.33333)  ;
 245   
 246   acu(i) = (qc.l(i)*((1/hh(i))+(1/hcu))/(((thout(i)-tcuin)*dtcu.l(i)*
 247            (thout(i)-tcuin+dtcu.l(i))/2 + 1e-6)**0.33333)) ;
 248   
 249   
 250   display acu, ahu ;
 251   
 252   
 253  *  utility costs
 254   
 255   costheat = sum(j,qh.l(j)*hucost) ;
 256   costcool = sum(i,qc.l(i)*cucost) ;
 257   
 258   
 259   display costheat, costcool ;
 260   
 261   
 262  *  investment cost
 263   
 264   invcost = cost.l - costheat - costcool ;
 265   
 266   
 267   display invcost ;
 268   


COMPILATION TIME     =        0.001 SECONDS      3 MB  24.7.4 r58773 LEX-LEG
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:52 Page 7
Simultaneous Optimization for HEN Synthesis (SYNHEAT,SEQ=117)
Model Statistics    SOLVE super Using MINLP From line 223


MODEL STATISTICS

BLOCKS OF EQUATIONS          20     SINGLE EQUATIONS           65
BLOCKS OF VARIABLES          12     SINGLE VARIABLES           57
NON ZERO ELEMENTS           225     NON LINEAR N-Z             32
DERIVATIVE POOL              20     CONSTANT POOL              28
CODE LENGTH                 233     DISCRETE VARIABLES         12


GENERATION TIME      =        0.002 SECONDS      4 MB  24.7.4 r58773 LEX-LEG


EXECUTION TIME       =        0.003 SECONDS      4 MB  24.7.4 r58773 LEX-LEG
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:52 Page 8
Simultaneous Optimization for HEN Synthesis (SYNHEAT,SEQ=117)
Solution Report     SOLVE super Using MINLP From line 223


               S O L V E      S U M M A R Y

     MODEL   super               OBJECTIVE  cost
     TYPE    MINLP               DIRECTION  MINIMIZE
     SOLVER  CONVERT             FROM LINE  223

**** SOLVER STATUS     1 Normal Completion         
**** MODEL STATUS      14 No Solution Returned     
**** OBJECTIVE VALUE                0.0000

 RESOURCE USAGE, LIMIT          0.000      1000.000
 ITERATION COUNT, LIMIT         0    2000000000
 EVALUATION ERRORS              0             0

Convert 2.0      24.7.4 r58773 Released Sep 19, 2016 LEG x86 64bit/Linux      

--- Using Option File
Reading parameter(s) from "/home/renigijus/gams/opt-mod-lib/gamslib/synheat/convert.opt"
>>  pyomo synheat-scalar.py
Finished reading from "/home/renigijus/gams/opt-mod-lib/gamslib/synheat/convert.opt"
Pyomo     : synheat-scalar.py


No solution returned
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:52 Page 9
Simultaneous Optimization for HEN Synthesis (SYNHEAT,SEQ=117)
E x e c u t i o n


----    238 PARAMETER a  area for exchanger for match ij in interval k (chen approx.)

              1           2

1.1      23.333      23.333
1.2      13.000      13.000
2.1      40.000      40.000
2.2      16.250      16.250


----    238 PARAMETER al  area calculated with log mean

              1           2

1.1      23.335      23.335
1.2      13.001      13.001
2.1      40.002      40.002
2.2      16.251      16.251


----    250 PARAMETER acu  area coolers

                      ( ALL       0.000 )


----    250 PARAMETER ahu  area heaters

                      ( ALL       0.000 )


----    259 PARAMETER costheat             =        0.000  cost of heating
            PARAMETER costcool             =        0.000  cost of cooling

----    267 PARAMETER invcost              =        0.000  investment cost


EXECUTION TIME       =        0.000 SECONDS      3 MB  24.7.4 r58773 LEX-LEG


USER: Remigijus Paulavicius, Single User License     S170731:0859AO-LNX
      Imperial College London, Dept. of Chemical Engineering    DC13449
      License for teaching and research at degree granting institutions


**** FILE SUMMARY

Input      /home/renigijus/gams/opt-mod-lib/gamslib/synheat/synheat.gms
Output     /home/renigijus/gams/opt-mod-lib/gamslib/synheat/synheat-scalar.py.lst
