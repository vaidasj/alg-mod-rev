GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:32:28 Page 1
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


   1  option NLP=convert;
   2  option NLP=convert;
   3  option NLP=convert;
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:32:28 Page 2
Gas Transmission Problem - Belgium (GASTRANS,SEQ=217)
C o m p i l a t i o n


      The problem of distributing gas through a network of pipelines is formulated as
      a cost minimization subject to nonlinear flow-pressure relations, material
      balances, and pressure bounds. The Belgian gas network is used as an example.
       
      First, we model a straight-forward NLP formulation that can be solved fine 
      by todays NLP solvers.
      Afterwards, the 3-stage approach by Wolf & Smeers is implemented (line 160ff).
       
      de Wolf, D, and Smeers, Y, The Gas Transmission Problem Solved by
      and Extension of the Simplex Algorithm. Management Science 46, 11
      (2000), 1454-1465.
       
  20   
  21  Sets i Towns / Anderlues, Antwerpen, Arlon, Berneau, Blaregnies, Brugge, Dudzele,
  22                 Gent, Liege, Loenhout, Mons, Namur, Petange, Peronnes, Sinsin,
  23                 Voeren, Wanze, Warnand, Zeebrugge, Zomergem /
  24       a Arcs  / 1*24 /
  25       as(a) active arcs
  26       ap(a) passive arcs
  27       aij(a,i,i) arc description
  28   
  29  alias (i,j)
  30   
  31  set nc node data column headers /
  32         slo supply lower bound (mill M3 per day)
  33         sup supply upper bound (mill M3 per day)
  34         plo pressure lower bound (bar)
  35         pup pressure upper bound (bar)
  36         c   cost ($ per MBTU)   /
  37   
  38  table Ndata(i,nc) Node Data
  39   
  40                 slo     sup     plo     pup     c
  41  Anderlues       0     1.2      0      66.2     0
  42  Antwerpen    -inf   -4.034    30      80.0     0
  43  Arlon        -inf   -0.222     0      66.2     0
  44  Berneau         0      0       0      66.2     0
  45  Blaregnies   -inf   -15.616   50      66.2     0
  46  Brugge       -inf    -3.918   30      80.0     0
  47  Dudzele         0     8.4      0      77.0    2.28
  48  Gent         -inf    -5.256   30      80       0
  49  Liege        -inf    -6.385   30      66.2     0
  50  Loenhout        0     4.8      0      77.0    2.28
  51  Mons         -inf    -6.848    0      66.2     0
  52  Namur        -inf    -2.120    0      66.2     0
  53  Petange      -inf    -1.919   25      66.2     0
  54  Peronnes        0     0.96     0      66.2    1.68
  55  Sinsin          0      0       0      63.0     0
  56  Voeren       20.344   22.012  50      66.2    1.68
  57  Wanze           0      0       0      66.2     0
  58  Warnand         0      0       0      66.2     0
  59  Zeebrugge      8.870  11.594   0      77.0    2.28
  60  Zomergem        0      0       0      80.0     0
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:32:28 Page 3
Gas Transmission Problem - Belgium (GASTRANS,SEQ=217)
C o m p i l a t i o n


  61   
  62  set ac  Arc data column headers /
  63          D   diameter (mm)
  64          L   length (km)
  65          act type indicator ( 1 = active)  /
  66   
  67  table AData(a,i,j,*) Arc Data
  68                                  D       L    act
  69   1 . Zeebrugge  . Dudzele      890.0   4.0
  70   2 . Zeebrugge  . Dudzele      890.0   4.0
  71   3 . Dudzele    . Brugge       890.0   6.0
  72   4 . Dudzele    . Brugge       890.0   6.0
  73   5 . Brugge     . Zomergem     890.0  26.0
  74   6 . Loenhout   . Antwerpen    590.1  43.0
  75   7 . Antwerpen  . Gent         590.1  29.0
  76   8 . Gent       . Zomergem     590.1  19.0
  77   9 . Zomergem   . Peronnes     890.0  55.0
  78  10 . Voeren     . Berneau      890.0   5.0    1
  79  11 . Voeren     . Berneau      395.0   5.0    1
  80  12 . Berneau    . Liege        890.0  20.0
  81  13 . Berneau    . Liege        395.0  20.0
  82  14 . Liege      . Warnand      890.0  25.0
  83  15 . Liege      . Warnand      395.0  25.0
  84  16 . Warnand    . Namur        890.0  42.0
  85  17 . Namur      . Anderlues    890.0  40.0
  86  18 . Anderlues  . Peronnes     890.0   5.0
  87  19 . Peronnes   . Mons         890.0  10.0
  88  20 . Mons       . Blaregnies   890.0  25.0
  89  21 . Warnand    . Wanze        395.5  10.5
  90  22 . Wanze      . Sinsin       315.5  26.0    1
  91  23 . Sinsin     . Arlon        315.5  98.0
  92  24 . Arlon      . Petange      315.5   6.0
  93   
  94  Scalars  T   gas temperature (K)                / 281.15  /
  95           e   absolute rugosity (mm)             /   0.05  /
  96           den density of gas relative to air (-) /   0.616 /
  97           z   compressibility factor (-)         /   0.8   /
  98   
  99  parameter lam(a,i,j)    lambda constant (page 1464)
 100            c2(a,i,j)     pipe constant (page 1463)
 101            arep(a,i,j,*) Arc Report;
 102   
 103    aij(a,i,j) = adata(a,i,j,'L');
 104   
 105    as(a) = sum(aij(a,i,j), adata(aij,'act'));
 106    ap(a) = not as(a);
 107   
 108    lam(aij(a,i,j)) = 1/sqr(2*log10(3.7*adata(aij,'D')/e));
 109    c2(aij(a,i,j)) = 96.074830e-15*power(adata(aij,'D'),5)/lam(aij)/z/t/adata(aij,'L')/den;
 110   
 111    arep(aij,'lam') = lam(aij);
 112    arep(aij,'c2')  = c2(aij);
 113   
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:32:28 Page 4
Gas Transmission Problem - Belgium (GASTRANS,SEQ=217)
C o m p i l a t i o n


 114  option arep:6:3:1; display arep,as,ap;
 115   
 116  Variables f(a,i,j)   Arc flow (1e6 SCM)
 117            s(i)       supply - demand (1e6 SCM)
 118            pi(i)      squared pressure
 119            sc         supply cost
 120  ;
 121   
 122  Equations flowbalance(i)    flow conservation
 123            weymouthp(a,i,j)  flow pressure relationship - passive
 124            weymoutha(a,i,j)  flow pressure relationship - active
 125            defsc             definition of supply cost
 126  ;
 127   
 128  flowbalance(i).. sum(aij(a,i,j), f(aij)) =e= sum(aij(a,j,i), f(aij)) + s(i);
 129   
 130  weymouthp(aij(ap,i,j)).. signpower(f(aij),2) =e= c2(aij)*(pi(i)-pi(j));
 131   
 132  weymoutha(aij(as,i,j))..       - sqr(f(aij)) =g= c2(aij)*(pi(i)-pi(j));
 133   
 134  defsc.. sc =e= sum(i, ndata(i,'c')*s(i));
 135   
 136  * supply, demand, pressure, and flow bounds
 137  s.lo(i)  = ndata(i,'slo');
 138  s.up(i)  = ndata(i,'sup');
 139  pi.lo(i) = sqr(ndata(i,'plo'));
 140  pi.up(i) = sqr(ndata(i,'pup'));
 141  f.lo(aij(as,i,j)) = 0;
 142   
 143  * initialize flow to avoid getting trapped at signpower(0,2)
 144  f.l(aij) = uniform(-1,1);
 145   
 146  model gastrans / flowbalance, weymouthp, weymoutha, defsc /;
 147   
 148  solve gastrans using nlp min sc;
 149   
 150  display f.l;
 151   
 152   
 153   
 154   
 155   
 156   
 157   
 158   
 159   
 160   
 161   
 162  * to run the Wolf & Smeers approach, remove the following $exit
EXIT /home/renigijus/gams/opt-mod-lib/gamslib/gastrans/gastrans.gms
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:32:28 Page 5
Gas Transmission Problem - Belgium (GASTRANS,SEQ=217)
Include File Summary


   SEQ   GLOBAL TYPE      PARENT   LOCAL  FILENAME

     1        1 INPUT          0       0  /home/renigijus/gams/opt-mod-lib/gamslib/gastrans/gastrans.gms
     2      163 EXIT           1     163  /home/renigijus/gams/opt-mod-lib/gamslib/gastrans/gastrans.gms


COMPILATION TIME     =        0.001 SECONDS      3 MB  24.7.4 r58773 LEX-LEG
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:32:28 Page 6
Gas Transmission Problem - Belgium (GASTRANS,SEQ=217)
E x e c u t i o n


----    114 PARAMETER arep  Arc Report

                                lam          c2

1 .Zeebrugge.Dudzele       0.010767    8.990763
2 .Zeebrugge.Dudzele       0.010767    8.990763
3 .Dudzele  .Brugge        0.010767    5.993842
4 .Dudzele  .Brugge        0.010767    5.993842
5 .Brugge   .Zomergem      0.010767    1.383194
6 .Loenhout .Antwerpen     0.011611    0.099377
7 .Antwerpen.Gent          0.011611    0.147352
8 .Gent     .Zomergem      0.011611    0.224906
9 .Zomergem .Peronnes      0.010767    0.653874
10.Voeren   .Berneau       0.010767    7.192610
11.Voeren   .Berneau       0.012535    0.106385
12.Berneau  .Liege         0.010767    1.798153
13.Berneau  .Liege         0.012535    0.026596
14.Liege    .Warnand       0.010767    1.438522
15.Liege    .Warnand       0.012535    0.021277
16.Warnand  .Namur         0.010767    0.856263
17.Namur    .Anderlues     0.010767    0.899076
18.Anderlues.Peronnes      0.010767    7.192610
19.Peronnes .Mons          0.010767    3.596305
20.Mons     .Blaregnies    0.010767    1.438522
21.Warnand  .Wanze         0.012532    0.050994
22.Wanze    .Sinsin        0.013102    0.006363
23.Sinsin   .Arlon         0.013102    0.001688
24.Arlon    .Petange       0.013102    0.027575


----    114 SET as  active arcs

10,    11,    22


----    114 SET ap  passive arcs

1 ,    2 ,    3 ,    4 ,    5 ,    6 ,    7 ,    8 ,    9 ,    12,    13,    14,    15,    16,    17,    18,    19,    20,    21,    23,    24

GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:32:28 Page 7
Gas Transmission Problem - Belgium (GASTRANS,SEQ=217)
Equation Listing    SOLVE gastrans Using NLP From line 148


---- flowbalance  =E=  flow conservation

flowbalance(Anderlues)..  - f(17,Namur,Anderlues) + f(18,Anderlues,Peronnes) - s(Anderlues) =E= 0 ; (LHS = 0.181125338, INFES = 0.181125338 ****)
     
flowbalance(Antwerpen)..  - f(6,Loenhout,Antwerpen) + f(7,Antwerpen,Gent) - s(Antwerpen) =E= 0 ; (LHS = 4.285555274, INFES = 4.285555274 ****)
     
flowbalance(Arlon)..  - f(23,Sinsin,Arlon) + f(24,Arlon,Petange) - s(Arlon) =E= 0 ; (LHS = 0.259220396, INFES = 0.259220396 ****)
     
REMAINING 17 ENTRIES SKIPPED


---- weymouthp  =E=  flow pressure relationship - passive

weymouthp(1,Zeebrugge,Dudzele)..  (1.313011472)*f(1,Zeebrugge,Dudzele) + 8.99076279639866*pi(Dudzele) - 8.99076279639866*pi(Zeebrugge) =E= 0 ; (LHS = -0.430999781400902, INFES = 0.430999781400902 ****)
     
weymouthp(2,Zeebrugge,Dudzele)..  (1.373066832)*f(2,Zeebrugge,Dudzele) + 8.99076279639866*pi(Dudzele) - 8.99076279639866*pi(Zeebrugge) =E= 0 ; (LHS = 0.471328131284629, INFES = 0.471328131284629 ****)
     
weymouthp(3,Dudzele,Brugge)..  (0.201501424)*f(3,Dudzele,Brugge) + 5.99384186426577*pi(Brugge) - 5.99384186426577*pi(Dudzele) =E= 0 ; (LHS = 5394.46782854516, INFES = 5394.46782854516 ****)
     
REMAINING 18 ENTRIES SKIPPED


---- weymoutha  =G=  flow pressure relationship - active

weymoutha(10,Voeren,Berneau)..  - (0.000842675999999987)*f(10,Voeren,Berneau) + 7.19261023711893*pi(Berneau) - 7.19261023711893*pi(Voeren) =G= 0 ; (LHS = -17981.5255929748, INFES = 17981.5255929748 ****)
     
weymoutha(11,Voeren,Berneau)..  - (1.992470508)*f(11,Voeren,Berneau) + 0.106385011792235*pi(Berneau) - 0.106385011792235*pi(Voeren) =G= 0 ; (LHS = -266.955014161901, INFES = 266.955014161901 ****)
     
weymoutha(22,Wanze,Sinsin)..  (0)*f(22,Wanze,Sinsin) + 0.0063634920908912*pi(Sinsin) - 0.0063634920908912*pi(Wanze) =G= 0 ; (LHS = 0)
     

---- defsc  =E=  definition of supply cost

defsc..  - 2.28*s(Dudzele) - 2.28*s(Loenhout) - 1.68*s(Peronnes) - 1.68*s(Voeren) - 2.28*s(Zeebrugge) + sc =E= 0 ; (LHS = -54.40152, INFES = 54.40152 ****)
     
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:32:28 Page 8
Gas Transmission Problem - Belgium (GASTRANS,SEQ=217)
Column Listing      SOLVE gastrans Using NLP From line 148


---- f  Arc flow (1e6 SCM)

f(1,Zeebrugge,Dudzele)
                (.LO, .L, .UP, .M = -INF, -0.656505736, +INF, 0)
       -1       flowbalance(Dudzele)
        1       flowbalance(Zeebrugge)
       (1.313)  weymouthp(1,Zeebrugge,Dudzele)

f(2,Zeebrugge,Dudzele)
                (.LO, .L, .UP, .M = -INF, 0.686533416, +INF, 0)
       -1       flowbalance(Dudzele)
        1       flowbalance(Zeebrugge)
       (1.3731) weymouthp(2,Zeebrugge,Dudzele)

f(3,Dudzele,Brugge)
                (.LO, .L, .UP, .M = -INF, 0.100750712, +INF, 0)
       -1       flowbalance(Brugge)
        1       flowbalance(Dudzele)
       (0.2015) weymouthp(3,Dudzele,Brugge)

REMAINING 21 ENTRIES SKIPPED

---- s  supply - demand (1e6 SCM)

s(Anderlues)
                (.LO, .L, .UP, .M = 0, 0, 1.2, 0)
       -1       flowbalance(Anderlues)

s(Antwerpen)
                (.LO, .L, .UP, .M = -INF, -4.034, -4.034, 0)
       -1       flowbalance(Antwerpen)
        0       (OLD LEVEL ****)

s(Arlon)
                (.LO, .L, .UP, .M = -INF, -0.222, -0.222, 0)
       -1       flowbalance(Arlon)
        0       (OLD LEVEL ****)

REMAINING 17 ENTRIES SKIPPED

---- pi  squared pressure

pi(Anderlues)
                (.LO, .L, .UP, .M = 0, 0, 4382.44, 0)
        0.8991  weymouthp(17,Namur,Anderlues)
       -7.1926  weymouthp(18,Anderlues,Peronnes)

pi(Antwerpen)
                (.LO, .L, .UP, .M = 900, 900, 6400, 0)
        0.0994  weymouthp(6,Loenhout,Antwerpen)
       -0.1474  weymouthp(7,Antwerpen,Gent)
        0       (OLD LEVEL ****)

GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:32:28 Page 9
Gas Transmission Problem - Belgium (GASTRANS,SEQ=217)
Column Listing      SOLVE gastrans Using NLP From line 148


     pi  squared pressure

pi(Arlon)
                (.LO, .L, .UP, .M = 0, 0, 4382.44, 0)
        0.0017  weymouthp(23,Sinsin,Arlon)
       -0.0276  weymouthp(24,Arlon,Petange)

REMAINING 17 ENTRIES SKIPPED

---- sc  supply cost

sc
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       defsc

GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 10:32:28 Page 10
Gas Transmission Problem - Belgium (GASTRANS,SEQ=217)
Model Statistics    SOLVE gastrans Using NLP From line 148


MODEL STATISTICS

BLOCKS OF EQUATIONS           4     SINGLE EQUATIONS           45
BLOCKS OF VARIABLES           4     SINGLE VARIABLES           65  19 projected
NON ZERO ELEMENTS           146     NON LINEAR N-Z             24
DERIVATIVE POOL              20     CONSTANT POOL              16
CODE LENGTH                 120


GENERATION TIME      =        0.003 SECONDS      4 MB  24.7.4 r58773 LEX-LEG


EXECUTION TIME       =        0.004 SECONDS      4 MB  24.7.4 r58773 LEX-LEG
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 10:32:28 Page 11
Gas Transmission Problem - Belgium (GASTRANS,SEQ=217)
Solution Report     SOLVE gastrans Using NLP From line 148


               S O L V E      S U M M A R Y

     MODEL   gastrans            OBJECTIVE  sc
     TYPE    NLP                 DIRECTION  MINIMIZE
     SOLVER  CONVERT             FROM LINE  148

**** SOLVER STATUS     1 Normal Completion         
**** MODEL STATUS      14 No Solution Returned     
**** OBJECTIVE VALUE                0.0000

 RESOURCE USAGE, LIMIT          0.000      1000.000
 ITERATION COUNT, LIMIT         0    2000000000
 EVALUATION ERRORS              0             0

Convert 2.0      24.7.4 r58773 Released Sep 19, 2016 LEG x86 64bit/Linux      

--- Using Option File
Reading parameter(s) from "/home/renigijus/gams/opt-mod-lib/gamslib/gastrans/convert.opt"
>>  pyomo gastrans-scalar.py
Finished reading from "/home/renigijus/gams/opt-mod-lib/gamslib/gastrans/convert.opt"
Pyomo     : gastrans-scalar.py


No solution returned
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 10:32:28 Page 12
Gas Transmission Problem - Belgium (GASTRANS,SEQ=217)
E x e c u t i o n


----    150 VARIABLE f.L  Arc flow (1e6 SCM)

               Anderlues   Antwerpen       Arlon     Berneau  Blaregnies      Brugge     Dudzele        Gent       Liege        Mons       Namur     Petange    Peronnes      Sinsin       Wanze     Warnand    Zomergem

1 .Zeebrugge                                                                              -0.657
2 .Zeebrugge                                                                               0.687
3 .Dudzele                                                                     0.101
4 .Dudzele                                                                    -0.398
5 .Brugge                                                                                                                                                                                                         -0.416
6 .Loenhout                   -0.552
7 .Antwerpen                                                                                          -0.300
8 .Gent                                                                                                                                                                                                            0.713
9 .Zomergem                                                                                                                                                       -0.866
10.Voeren                                        4.213380E-4
11.Voeren                                              0.996
12.Berneau                                                                                                         0.157
13.Berneau                                                                                                         0.982
14.Liege                                                                                                                                                                                               0.525
15.Liege                                                                                                                                                                                              -0.739
16.Warnand                                                                                                                                 0.279
17.Namur          -0.681
18.Anderlues                                                                                                                                                      -0.500
19.Peronnes                                                                                                                    0.338
20.Mons                                                           -0.129
21.Warnand                                                                                                                                                                                -0.281
22.Wanze                                                                                                                                                                      -0.297
23.Sinsin                                 -0.737
24.Arlon                                                                                                                                              -0.700



EXECUTION TIME       =        0.001 SECONDS      3 MB  24.7.4 r58773 LEX-LEG


USER: Remigijus Paulavicius, Single User License     S170731:0859AO-LNX
      Imperial College London, Dept. of Chemical Engineering    DC13449
      License for teaching and research at degree granting institutions


**** FILE SUMMARY

Input      /home/renigijus/gams/opt-mod-lib/gamslib/gastrans/gastrans.gms
Output     /home/renigijus/gams/opt-mod-lib/gamslib/gastrans/gastrans-scalar.py.lst
