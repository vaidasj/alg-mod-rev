GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:41 Page 1
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


   1  option NLP=convert;
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:41 Page 2
Linear Quadratic Control Problem  (ABEL,SEQ=64)
C o m p i l a t i o n


   3   
       
         Linear Quadratic Riccati Equations are solved as a General
         Nonlinear Programming Problem instead of the usual Matrix
         Recursion.
       
       
      Kendrick, D, Caution and Probing in a Macroeconomic Model. Journal of
      Economic Dynamics and Control 4, 2 (1982).
       
  15   
  16   Sets   n     states   / consumpt, invest /
  17          m     controls / gov-expend, money /
  18          k     horizon  / 1964-i, 1964-ii, 1964-iii, 1964-iv
  19                           1965-i, 1965-ii, 1965-iii, 1965-iv /
  20          ku(k) control horizon
  21          ki(k) initial period
  22          kt(k) terminal period ;
  23   
  24   Alias (n,np), (m,mp) ;
  25   
  26   ku(k) = yes$(ord(k) lt card(k));
  27   ki(k) = yes$(ord(k) eq 1);
  28   kt(k) = not ku(k);
  29   Display k, ki, kt, ku;
  30   
  31   Table a(n,np)  state vector matrix
  32   
  33            consumpt   invest
  34   consumpt    .914     -.016
  35   invest      .097      .424
  36   
  37   Table b(n,m)   control vector matrix
  38   
  39              gov-expend     money
  40   consumpt       .305        .424
  41   invest        -.101       1.459
  42   
  43   Table wk(n,np) penalty matrix for states - input
  44   
  45            consumpt  invest
  46   consumpt    .0625
  47   invest                1
  48   
  49   Table lambda(m,mp)  penalty matrix for controls
  50   
  51                gov-expend   money
  52   gov-expend      1
  53   money                      .444
  54   
  55   Parameter  c(n)     constant term    / consumpt -59.4,   invest -184.7 /
  56              xinit(n) initial value    / consumpt 387.9,   invest   85.3 /
  57              uinit(m) initial controls / gov-expend 110.5, money   147.1 /
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:41 Page 3
Linear Quadratic Control Problem  (ABEL,SEQ=64)
C o m p i l a t i o n


  58              xtilde(n,k)  desired path for x
  59              utilde(m,k)  desired path for u
  60              w(n,np,k)    penalty matrix on states ;
  61   
  62    w(n,np,ku) = wk(n,np);
  63    w(n,np,kt) = 100*wk(n,np);
  64   
  65   xtilde(n,k) = xinit(n)*1.0075**(ord(k)-1);
  66   utilde(m,k) = uinit(m)*1.0075**(ord(k)-1);
  67   
  68   Display w, xtilde, utilde;
  69   
  70   Variables x(n,k)  state variable
  71             u(m,k)  control variable
  72             j       criterion
  73   
  74   Equations  criterion   criterion definition
  75              stateq(n,k) state equation ;
  76   
  77   criterion..
  78   
  79   j =e= .5*sum((k,n,np),
  80            (x(n,k)-xtilde(n,k))*w(n,np,k)*(x(np,k)-xtilde(np,k)))
  81       + .5*sum((ku,m,mp),
  82            (u(m,ku)-utilde(m,ku))*lambda(m,mp)*(u(mp,ku)-utilde(mp,ku)));
  83   
  84   stateq(n,k+1)..
  85   
  86    x(n,k+1) =e= sum(np, a(n,np)*x(np,k)) + sum(m, b(n,m)*u(m,k)) + c(n);
  87   
  88   Model abel /all/;
  89   
  90   x.l(n,k)   = xinit(n); u.l(m,k) = uinit(m);
  91   x.fx(n,ki) = xinit(n);
  92   
  93   Solve abel minimizing j using nlp;
  94   
  95   Display x.l, u.l;


COMPILATION TIME     =        0.000 SECONDS      3 MB  24.7.4 r58773 LEX-LEG
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:41 Page 4
Linear Quadratic Control Problem  (ABEL,SEQ=64)
E x e c u t i o n


----     29 SET k  horizon

1964-i  ,    1964-ii ,    1964-iii,    1964-iv ,    1965-i  ,    1965-ii ,    1965-iii,    1965-iv 


----     29 SET ki  initial period

1964-i


----     29 SET kt  terminal period

1965-iv


----     29 SET ku  control horizon

1964-i  ,    1964-ii ,    1964-iii,    1964-iv ,    1965-i  ,    1965-ii ,    1965-iii


----     68 PARAMETER w  penalty matrix on states

                       1964-i     1964-ii    1964-iii     1964-iv      1965-i     1965-ii    1965-iii     1965-iv

consumpt.consumpt       0.062       0.062       0.062       0.062       0.062       0.062       0.062       6.250
invest  .invest         1.000       1.000       1.000       1.000       1.000       1.000       1.000     100.000


----     68 PARAMETER xtilde  desired path for x

              1964-i     1964-ii    1964-iii     1964-iv      1965-i     1965-ii    1965-iii     1965-iv

consumpt     387.900     390.809     393.740     396.693     399.669     402.666     405.686     408.729
invest        85.300      85.940      86.584      87.234      87.888      88.547      89.211      89.880


----     68 PARAMETER utilde  desired path for u

                1964-i     1964-ii    1964-iii     1964-iv      1965-i     1965-ii    1965-iii     1965-iv

gov-expend     110.500     111.329     112.164     113.005     113.852     114.706     115.567     116.433
money          147.100     148.203     149.315     150.435     151.563     152.700     153.845     154.999

GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:41 Page 5
Linear Quadratic Control Problem  (ABEL,SEQ=64)
Equation Listing    SOLVE abel Using NLP From line 93


---- criterion  =E=  criterion definition

criterion..  (0)*x(consumpt,1964-i) + (0.181828125000003)*x(consumpt,1964-ii) + (0.365019960937506)*x(consumpt,1964-iii) + (0.549585735644538)*x(consumpt,1964-iv) + (0.735535753661868)*x(consumpt,1965-i) + (0.922880396814339)*x(consumpt,1965-ii)
     
      + (1.11163012479044)*x(consumpt,1965-iii) + (130.179547572638)*x(consumpt,1965-iv) + (0)*x(invest,1964-i) + (0.639750000000006)*x(invest,1964-ii) + (1.28429812500002)*x(invest,1964-iii) + (1.93368036093753)*x(invest,1964-iv)
     
      + (2.58793296364455)*x(invest,1965-i) + (3.2470924608719)*x(invest,1965-ii) + (3.91119565432844)*x(invest,1965-iii) + (458.027962173591)*x(invest,1965-iv) + (0)*u(gov-expend,1964-i) + (0.828750000000014)*u(gov-expend,1964-ii)
     
      + (1.66371562500002)*u(gov-expend,1964-iii) + (2.50494349218754)*u(gov-expend,1964-iv) + (3.35248056837892)*u(gov-expend,1965-i) + (4.20637417264179)*u(gov-expend,1965-ii) + (5.0666719789366)*u(gov-expend,1965-iii) + (0)*u(money,1964-i)
     
      + (0.489843000000001)*u(money,1964-ii) + (0.983359822500008)*u(money,1964-iii) + (1.48057802116877)*u(money,1964-iv) + (1.98152535632752)*u(money,1965-i) + (2.48622979649999)*u(money,1965-ii) + (2.99471951997375)*u(money,1965-iii) + j =E= 0 ;
     
      (LHS = -2506.10426798121, INFES = 2506.10426798121 ****)
     

---- stateq  =E=  state equation

stateq(consumpt,1964-ii)..  - 0.914*x(consumpt,1964-i) + x(consumpt,1964-ii) + 0.016*x(invest,1964-i) - 0.305*u(gov-expend,1964-i) - 0.424*u(money,1964-i) =E= -59.4 ; (LHS = -61.3487, INFES = 1.94870000000003 ****)
     
stateq(consumpt,1964-iii)..  - 0.914*x(consumpt,1964-ii) + x(consumpt,1964-iii) + 0.016*x(invest,1964-ii) - 0.305*u(gov-expend,1964-ii) - 0.424*u(money,1964-ii) =E= -59.4 ; (LHS = -61.3487, INFES = 1.94870000000003 ****)
     
stateq(consumpt,1964-iv)..  - 0.914*x(consumpt,1964-iii) + x(consumpt,1964-iv) + 0.016*x(invest,1964-iii) - 0.305*u(gov-expend,1964-iii) - 0.424*u(money,1964-iii) =E= -59.4 ; (LHS = -61.3487, INFES = 1.94870000000003 ****)
     
REMAINING 11 ENTRIES SKIPPED

GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:41 Page 6
Linear Quadratic Control Problem  (ABEL,SEQ=64)
Column Listing      SOLVE abel Using NLP From line 93


---- x  state variable

x(consumpt,1964-i)
                (.LO, .L, .UP, .M = 387.9, 387.9, 387.9, 0)
       (0)      criterion
       -0.914   stateq(consumpt,1964-ii)
       -0.097   stateq(invest,1964-ii)

x(consumpt,1964-ii)
                (.LO, .L, .UP, .M = -INF, 387.9, +INF, 0)
       (0.1818) criterion
        1       stateq(consumpt,1964-ii)
       -0.914   stateq(consumpt,1964-iii)
       -0.097   stateq(invest,1964-iii)

x(consumpt,1964-iii)
                (.LO, .L, .UP, .M = -INF, 387.9, +INF, 0)
       (0.365)  criterion
        1       stateq(consumpt,1964-iii)
       -0.914   stateq(consumpt,1964-iv)
       -0.097   stateq(invest,1964-iv)

REMAINING 13 ENTRIES SKIPPED

---- u  control variable

u(gov-expend,1964-i)
                (.LO, .L, .UP, .M = -INF, 110.5, +INF, 0)
       (0)      criterion
       -0.305   stateq(consumpt,1964-ii)
        0.101   stateq(invest,1964-ii)

u(gov-expend,1964-ii)
                (.LO, .L, .UP, .M = -INF, 110.5, +INF, 0)
       (0.8288) criterion
       -0.305   stateq(consumpt,1964-iii)
        0.101   stateq(invest,1964-iii)

u(gov-expend,1964-iii)
                (.LO, .L, .UP, .M = -INF, 110.5, +INF, 0)
       (1.6637) criterion
       -0.305   stateq(consumpt,1964-iv)
        0.101   stateq(invest,1964-iv)

REMAINING 11 ENTRIES SKIPPED

---- j  criterion

j
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       criterion

GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:41 Page 7
Linear Quadratic Control Problem  (ABEL,SEQ=64)
Model Statistics    SOLVE abel Using NLP From line 93


MODEL STATISTICS

BLOCKS OF EQUATIONS           2     SINGLE EQUATIONS           15
BLOCKS OF VARIABLES           3     SINGLE VARIABLES           31
NON ZERO ELEMENTS           101     NON LINEAR N-Z             30
DERIVATIVE POOL              20     CONSTANT POOL              66
CODE LENGTH                 199


GENERATION TIME      =        0.003 SECONDS      4 MB  24.7.4 r58773 LEX-LEG


EXECUTION TIME       =        0.004 SECONDS      4 MB  24.7.4 r58773 LEX-LEG
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:41 Page 8
Linear Quadratic Control Problem  (ABEL,SEQ=64)
Solution Report     SOLVE abel Using NLP From line 93


               S O L V E      S U M M A R Y

     MODEL   abel                OBJECTIVE  j
     TYPE    NLP                 DIRECTION  MINIMIZE
     SOLVER  CONVERT             FROM LINE  93

**** SOLVER STATUS     1 Normal Completion         
**** MODEL STATUS      14 No Solution Returned     
**** OBJECTIVE VALUE                0.0000

 RESOURCE USAGE, LIMIT          0.000      1000.000
 ITERATION COUNT, LIMIT         0    2000000000
 EVALUATION ERRORS              0             0

Convert 2.0      24.7.4 r58773 Released Sep 19, 2016 LEG x86 64bit/Linux      

--- Using Option File
Reading parameter(s) from "/home/renigijus/gams/opt-mod-lib/gamslib/abel/convert.opt"
>>  ampl abel-scalar.mod
Finished reading from "/home/renigijus/gams/opt-mod-lib/gamslib/abel/convert.opt"
Ampl      : abel-scalar.mod


No solution returned
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:41 Page 9
Linear Quadratic Control Problem  (ABEL,SEQ=64)
E x e c u t i o n


----     95 VARIABLE x.L  state variable

              1964-i     1964-ii    1964-iii     1964-iv      1965-i     1965-ii    1965-iii     1965-iv

consumpt     387.900     387.900     387.900     387.900     387.900     387.900     387.900     387.900
invest        85.300      85.300      85.300      85.300      85.300      85.300      85.300      85.300


----     95 VARIABLE u.L  control variable

                1964-i     1964-ii    1964-iii     1964-iv      1965-i     1965-ii    1965-iii     1965-iv

gov-expend     110.500     110.500     110.500     110.500     110.500     110.500     110.500     110.500
money          147.100     147.100     147.100     147.100     147.100     147.100     147.100     147.100



EXECUTION TIME       =        0.000 SECONDS      3 MB  24.7.4 r58773 LEX-LEG


USER: Remigijus Paulavicius, Single User License     S170731:0859AO-LNX
      Imperial College London, Dept. of Chemical Engineering    DC13449
      License for teaching and research at degree granting institutions


**** FILE SUMMARY

Input      /home/renigijus/gams/opt-mod-lib/gamslib/abel/abel.gms
Output     /home/renigijus/gams/opt-mod-lib/gamslib/abel/abel-scalar.mod.lst
