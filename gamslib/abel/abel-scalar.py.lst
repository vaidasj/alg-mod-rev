GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:41 Page 1
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


   1  option NLP=convert;
   2  option NLP=convert;
   3  option NLP=convert;
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:41 Page 2
Linear Quadratic Control Problem  (ABEL,SEQ=64)
C o m p i l a t i o n


   5   
       
         Linear Quadratic Riccati Equations are solved as a General
         Nonlinear Programming Problem instead of the usual Matrix
         Recursion.
       
       
      Kendrick, D, Caution and Probing in a Macroeconomic Model. Journal of
      Economic Dynamics and Control 4, 2 (1982).
       
  17   
  18   Sets   n     states   / consumpt, invest /
  19          m     controls / gov-expend, money /
  20          k     horizon  / 1964-i, 1964-ii, 1964-iii, 1964-iv
  21                           1965-i, 1965-ii, 1965-iii, 1965-iv /
  22          ku(k) control horizon
  23          ki(k) initial period
  24          kt(k) terminal period ;
  25   
  26   Alias (n,np), (m,mp) ;
  27   
  28   ku(k) = yes$(ord(k) lt card(k));
  29   ki(k) = yes$(ord(k) eq 1);
  30   kt(k) = not ku(k);
  31   Display k, ki, kt, ku;
  32   
  33   Table a(n,np)  state vector matrix
  34   
  35            consumpt   invest
  36   consumpt    .914     -.016
  37   invest      .097      .424
  38   
  39   Table b(n,m)   control vector matrix
  40   
  41              gov-expend     money
  42   consumpt       .305        .424
  43   invest        -.101       1.459
  44   
  45   Table wk(n,np) penalty matrix for states - input
  46   
  47            consumpt  invest
  48   consumpt    .0625
  49   invest                1
  50   
  51   Table lambda(m,mp)  penalty matrix for controls
  52   
  53                gov-expend   money
  54   gov-expend      1
  55   money                      .444
  56   
  57   Parameter  c(n)     constant term    / consumpt -59.4,   invest -184.7 /
  58              xinit(n) initial value    / consumpt 387.9,   invest   85.3 /
  59              uinit(m) initial controls / gov-expend 110.5, money   147.1 /
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:41 Page 3
Linear Quadratic Control Problem  (ABEL,SEQ=64)
C o m p i l a t i o n


  60              xtilde(n,k)  desired path for x
  61              utilde(m,k)  desired path for u
  62              w(n,np,k)    penalty matrix on states ;
  63   
  64    w(n,np,ku) = wk(n,np);
  65    w(n,np,kt) = 100*wk(n,np);
  66   
  67   xtilde(n,k) = xinit(n)*1.0075**(ord(k)-1);
  68   utilde(m,k) = uinit(m)*1.0075**(ord(k)-1);
  69   
  70   Display w, xtilde, utilde;
  71   
  72   Variables x(n,k)  state variable
  73             u(m,k)  control variable
  74             j       criterion
  75   
  76   Equations  criterion   criterion definition
  77              stateq(n,k) state equation ;
  78   
  79   criterion..
  80   
  81   j =e= .5*sum((k,n,np),
  82            (x(n,k)-xtilde(n,k))*w(n,np,k)*(x(np,k)-xtilde(np,k)))
  83       + .5*sum((ku,m,mp),
  84            (u(m,ku)-utilde(m,ku))*lambda(m,mp)*(u(mp,ku)-utilde(mp,ku)));
  85   
  86   stateq(n,k+1)..
  87   
  88    x(n,k+1) =e= sum(np, a(n,np)*x(np,k)) + sum(m, b(n,m)*u(m,k)) + c(n);
  89   
  90   Model abel /all/;
  91   
  92   x.l(n,k)   = xinit(n); u.l(m,k) = uinit(m);
  93   x.fx(n,ki) = xinit(n);
  94   
  95   Solve abel minimizing j using nlp;
  96   
  97   Display x.l, u.l;


COMPILATION TIME     =        0.001 SECONDS      3 MB  24.7.4 r58773 LEX-LEG
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:41 Page 4
Linear Quadratic Control Problem  (ABEL,SEQ=64)
E x e c u t i o n


----     31 SET k  horizon

1964-i  ,    1964-ii ,    1964-iii,    1964-iv ,    1965-i  ,    1965-ii ,    1965-iii,    1965-iv 


----     31 SET ki  initial period

1964-i


----     31 SET kt  terminal period

1965-iv


----     31 SET ku  control horizon

1964-i  ,    1964-ii ,    1964-iii,    1964-iv ,    1965-i  ,    1965-ii ,    1965-iii


----     70 PARAMETER w  penalty matrix on states

                       1964-i     1964-ii    1964-iii     1964-iv      1965-i     1965-ii    1965-iii     1965-iv

consumpt.consumpt       0.062       0.062       0.062       0.062       0.062       0.062       0.062       6.250
invest  .invest         1.000       1.000       1.000       1.000       1.000       1.000       1.000     100.000


----     70 PARAMETER xtilde  desired path for x

              1964-i     1964-ii    1964-iii     1964-iv      1965-i     1965-ii    1965-iii     1965-iv

consumpt     387.900     390.809     393.740     396.693     399.669     402.666     405.686     408.729
invest        85.300      85.940      86.584      87.234      87.888      88.547      89.211      89.880


----     70 PARAMETER utilde  desired path for u

                1964-i     1964-ii    1964-iii     1964-iv      1965-i     1965-ii    1965-iii     1965-iv

gov-expend     110.500     111.329     112.164     113.005     113.852     114.706     115.567     116.433
money          147.100     148.203     149.315     150.435     151.563     152.700     153.845     154.999

GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:41 Page 5
Linear Quadratic Control Problem  (ABEL,SEQ=64)
Equation Listing    SOLVE abel Using NLP From line 95


---- criterion  =E=  criterion definition

criterion..  (0)*x(consumpt,1964-i) + (0.181828125000003)*x(consumpt,1964-ii) + (0.365019960937506)*x(consumpt,1964-iii) + (0.549585735644538)*x(consumpt,1964-iv) + (0.735535753661868)*x(consumpt,1965-i) + (0.922880396814339)*x(consumpt,1965-ii)
     
      + (1.11163012479044)*x(consumpt,1965-iii) + (130.179547572638)*x(consumpt,1965-iv) + (0)*x(invest,1964-i) + (0.639750000000006)*x(invest,1964-ii) + (1.28429812500002)*x(invest,1964-iii) + (1.93368036093753)*x(invest,1964-iv)
     
      + (2.58793296364455)*x(invest,1965-i) + (3.2470924608719)*x(invest,1965-ii) + (3.91119565432844)*x(invest,1965-iii) + (458.027962173591)*x(invest,1965-iv) + (0)*u(gov-expend,1964-i) + (0.828750000000014)*u(gov-expend,1964-ii)
     
      + (1.66371562500002)*u(gov-expend,1964-iii) + (2.50494349218754)*u(gov-expend,1964-iv) + (3.35248056837892)*u(gov-expend,1965-i) + (4.20637417264179)*u(gov-expend,1965-ii) + (5.0666719789366)*u(gov-expend,1965-iii) + (0)*u(money,1964-i)
     
      + (0.489843000000001)*u(money,1964-ii) + (0.983359822500008)*u(money,1964-iii) + (1.48057802116877)*u(money,1964-iv) + (1.98152535632752)*u(money,1965-i) + (2.48622979649999)*u(money,1965-ii) + (2.99471951997375)*u(money,1965-iii) + j =E= 0 ;
     
      (LHS = -2506.10426798121, INFES = 2506.10426798121 ****)
     

---- stateq  =E=  state equation

stateq(consumpt,1964-ii)..  - 0.914*x(consumpt,1964-i) + x(consumpt,1964-ii) + 0.016*x(invest,1964-i) - 0.305*u(gov-expend,1964-i) - 0.424*u(money,1964-i) =E= -59.4 ; (LHS = -61.3487, INFES = 1.94870000000003 ****)
     
stateq(consumpt,1964-iii)..  - 0.914*x(consumpt,1964-ii) + x(consumpt,1964-iii) + 0.016*x(invest,1964-ii) - 0.305*u(gov-expend,1964-ii) - 0.424*u(money,1964-ii) =E= -59.4 ; (LHS = -61.3487, INFES = 1.94870000000003 ****)
     
stateq(consumpt,1964-iv)..  - 0.914*x(consumpt,1964-iii) + x(consumpt,1964-iv) + 0.016*x(invest,1964-iii) - 0.305*u(gov-expend,1964-iii) - 0.424*u(money,1964-iii) =E= -59.4 ; (LHS = -61.3487, INFES = 1.94870000000003 ****)
     
REMAINING 11 ENTRIES SKIPPED

GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:41 Page 6
Linear Quadratic Control Problem  (ABEL,SEQ=64)
Column Listing      SOLVE abel Using NLP From line 95


---- x  state variable

x(consumpt,1964-i)
                (.LO, .L, .UP, .M = 387.9, 387.9, 387.9, 0)
       (0)      criterion
       -0.914   stateq(consumpt,1964-ii)
       -0.097   stateq(invest,1964-ii)

x(consumpt,1964-ii)
                (.LO, .L, .UP, .M = -INF, 387.9, +INF, 0)
       (0.1818) criterion
        1       stateq(consumpt,1964-ii)
       -0.914   stateq(consumpt,1964-iii)
       -0.097   stateq(invest,1964-iii)

x(consumpt,1964-iii)
                (.LO, .L, .UP, .M = -INF, 387.9, +INF, 0)
       (0.365)  criterion
        1       stateq(consumpt,1964-iii)
       -0.914   stateq(consumpt,1964-iv)
       -0.097   stateq(invest,1964-iv)

REMAINING 13 ENTRIES SKIPPED

---- u  control variable

u(gov-expend,1964-i)
                (.LO, .L, .UP, .M = -INF, 110.5, +INF, 0)
       (0)      criterion
       -0.305   stateq(consumpt,1964-ii)
        0.101   stateq(invest,1964-ii)

u(gov-expend,1964-ii)
                (.LO, .L, .UP, .M = -INF, 110.5, +INF, 0)
       (0.8288) criterion
       -0.305   stateq(consumpt,1964-iii)
        0.101   stateq(invest,1964-iii)

u(gov-expend,1964-iii)
                (.LO, .L, .UP, .M = -INF, 110.5, +INF, 0)
       (1.6637) criterion
       -0.305   stateq(consumpt,1964-iv)
        0.101   stateq(invest,1964-iv)

REMAINING 11 ENTRIES SKIPPED

---- j  criterion

j
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       criterion

GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:41 Page 7
Linear Quadratic Control Problem  (ABEL,SEQ=64)
Model Statistics    SOLVE abel Using NLP From line 95


MODEL STATISTICS

BLOCKS OF EQUATIONS           2     SINGLE EQUATIONS           15
BLOCKS OF VARIABLES           3     SINGLE VARIABLES           31
NON ZERO ELEMENTS           101     NON LINEAR N-Z             30
DERIVATIVE POOL              20     CONSTANT POOL              66
CODE LENGTH                 199


GENERATION TIME      =        0.002 SECONDS      4 MB  24.7.4 r58773 LEX-LEG


EXECUTION TIME       =        0.003 SECONDS      4 MB  24.7.4 r58773 LEX-LEG
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:41 Page 8
Linear Quadratic Control Problem  (ABEL,SEQ=64)
Solution Report     SOLVE abel Using NLP From line 95


               S O L V E      S U M M A R Y

     MODEL   abel                OBJECTIVE  j
     TYPE    NLP                 DIRECTION  MINIMIZE
     SOLVER  CONVERT             FROM LINE  95

**** SOLVER STATUS     1 Normal Completion         
**** MODEL STATUS      14 No Solution Returned     
**** OBJECTIVE VALUE                0.0000

 RESOURCE USAGE, LIMIT          0.000      1000.000
 ITERATION COUNT, LIMIT         0    2000000000
 EVALUATION ERRORS              0             0

Convert 2.0      24.7.4 r58773 Released Sep 19, 2016 LEG x86 64bit/Linux      

--- Using Option File
Reading parameter(s) from "/home/renigijus/gams/opt-mod-lib/gamslib/abel/convert.opt"
>>  pyomo abel-scalar.py
Finished reading from "/home/renigijus/gams/opt-mod-lib/gamslib/abel/convert.opt"
Pyomo     : abel-scalar.py


No solution returned
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 10:24:41 Page 9
Linear Quadratic Control Problem  (ABEL,SEQ=64)
E x e c u t i o n


----     97 VARIABLE x.L  state variable

              1964-i     1964-ii    1964-iii     1964-iv      1965-i     1965-ii    1965-iii     1965-iv

consumpt     387.900     387.900     387.900     387.900     387.900     387.900     387.900     387.900
invest        85.300      85.300      85.300      85.300      85.300      85.300      85.300      85.300


----     97 VARIABLE u.L  control variable

                1964-i     1964-ii    1964-iii     1964-iv      1965-i     1965-ii    1965-iii     1965-iv

gov-expend     110.500     110.500     110.500     110.500     110.500     110.500     110.500     110.500
money          147.100     147.100     147.100     147.100     147.100     147.100     147.100     147.100



EXECUTION TIME       =        0.000 SECONDS      3 MB  24.7.4 r58773 LEX-LEG


USER: Remigijus Paulavicius, Single User License     S170731:0859AO-LNX
      Imperial College London, Dept. of Chemical Engineering    DC13449
      License for teaching and research at degree granting institutions


**** FILE SUMMARY

Input      /home/renigijus/gams/opt-mod-lib/gamslib/abel/abel.gms
Output     /home/renigijus/gams/opt-mod-lib/gamslib/abel/abel-scalar.py.lst
