GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:30:34 Page 1
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


   1  option MIP=convert;
   2  option MIP=convert;
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:30:34 Page 2
Food Manufacturing Problem - Blending of oils  (FOOD,SEQ=352)
C o m p i l a t i o n


   4   
      The problem is to plan the blending of five kinds of oil, organized in two
      categories (two kinds of vegetable oils and three kinds of non vegetable oils)
      into batches of blended products over six months.
       
      Some of the oil is already available in storage. There is an initial stock of
      oil of 500 tons of each raw type when planning begins. An equal stock should
      exist in storage at the end of the plan. Up to 1000 tons of each type of raw oil
      can be stored each month for later use. The price for storage of raw oils is
      5 monetary units per ton. Refined oil cannot be stored. The blended product
      cannot be stored either.
       
      The rest of the oil (that is, any not available in storage) must be bought in
      quantities to meet the blending requirements. The price of each kind of oil
      varies over the six-month period.
       
      The two categories of oil cannot be refined on the same production line.
      There is a limit on how much oil of each category (vegetable or non vegetable)
      can be refined in a given month:
       - Not more than 200 tons of vegetable oil can be refined per month.
       - Not more than 250 tons of non vegetable oil can be refined per month.
       
      There are constraints on the blending of oils:
       - The product cannot blend more than three oils.
       - When a given type of oil is blended into the product, at least 20 tons of
         that type must be used.
       - If either vegetable oil 1 (v1) or vegetable oil 2 (v2) is blended in the
         product, then non vegetable oil 3 (o3) must also be blended in that product.
       
      The final product (refined and blended) sells for a known price:
      150 monetary units per ton.
       
      The aim of the six-month plan is to minimize production and storage costs while
      maximizing profit.
       
       
      This example is taken from the Cplex 12 User's Manual
      (ILOG, Cplex 12 User's Manual, 2009)
       
      Williams, H P, Model Building in Mathematical Programming. John Wiley
      and Sons, 1978.
       
  48   
  49  Sets m      planing period     / m1*m6 /
  50       p      raw oils           / v1*v2, o1*o3 /
  51       pv(p)  vegetable oils     / v1*v2 /
  52       pnv(p) non-vegetable oils / o1*o3 /
  53  Parameters
  54       maxstore  maximum storage of each type of raw oil /   1000 /
  55       maxusepv  maximum use of vegetable oils           /    200 /
  56       maxusepnv maximum use of non-vegetable oils       /    250 /
  57       minusep   minimum use of raw oil                  /     20 /
  58       maxnusep  maximum number of raw oils in a blend   /      3 /
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:30:34 Page 3
Food Manufacturing Problem - Blending of oils  (FOOD,SEQ=352)
C o m p i l a t i o n


  59       sp        sales price of refined and blended oil  /    150 /
  60       sc        storage cost of raw oils                /      5 /
  61       stock(p)  stock at the beginning and end          / #p 500 /
  62       hmin      minimum hardness of refined oil         /      3 /
  63       hmax      maximum hardness of refined oil         /      6 /
  64       h(p)      hardness of raw oils / v1 8.8, v2 6.1, o1 2, o2 4.2, o3 5.0 /
  65   
  66  Table cost(m,p) raw oil cost
  67      v1  v2  o1  o2  o3
  68  m1 110 120 130 110 115
  69  m2 130 130 110  90 115
  70  m3 110 140 130 100  95
  71  m4 120 110 120 120 125
  72  m5 100 120 150 110 105
  73  m6  90 100 140  80 135;
  74   
  75  Variables
  76       produce(m)    production of blended and refined oil per month
  77       use(m,p)      usage of raw oil per month
  78       induse(m,p)   indicator for usage of raw oil per month
  79       buy(m,p)      purchase of raw oil per month
  80       store(m,p)    storage of raw oil at end of the month
  81       profit        objective variable;
  82  Positive variables produce, buy, store, use;
  83  Binary variable induse;
  84   
  85  Equations
  86       defobj        objective
  87       defusepv(m)   maximum use of vegetable oils
  88       defusepnv(m)  maximum use of non-vegetable oils
  89       defproduce(m) production of refined oil
  90       defhmin(m)    minmum hardness requirement
  91       defhmax(m)    maximum hardness requirement
  92       stockbal(m,p) stock balance constraint
  93       minuse(m,p)   minimum usage of raw oil
  94       maxuse(m,p)   usage of raw oil is 0 if induse is 0
  95       maxnuse(m)    maximum number of raw oils used in a blend
  96       deflogic1(m)  if some vegetable raw oil is use we also need to use o1
  97  ;
  98   
  99  defobj..        profit =e=   sum(m, sp*produce(m))
 100                             - sum((m,p), cost(m,p)*buy(m,p))
 101                             - sum((m,p), sc*store(m,p));
 102   
 103  defusepv(m)..   sum(pv, use(m,pv)) =l= maxusepv;
 104   
 105  defusepnv(m)..  sum(pnv, use(m,pnv)) =l= maxusepnv;
 106   
 107  defproduce(m).. produce(m) =e= sum(p, use(m,p));
 108   
 109  defhmin(m)..    sum(p, h(p)*use(m,p)) =g= hmin*produce(m);
 110   
 111  defhmax(m)..    sum(p, h(p)*use(m,p)) =l= hmax*produce(m);
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:30:34 Page 4
Food Manufacturing Problem - Blending of oils  (FOOD,SEQ=352)
C o m p i l a t i o n


 112   
 113  * steady-state stock
 114  stockbal(m,p).. store(m--1,p) + buy(m,p) =e= use(m,p) + store(m,p);
 115   
 116  * Now come the logical constraints
 117  minuse(m,p)..   use(m,p) =g= minusep*induse(m,p);
 118   
 119  maxuse(m,p)..   use(m,p) =l= (maxusepv$pv(p)+maxusepnv$pnv(p))*induse(m,p);
 120   
 121  maxnuse(m)..    sum(p, induse(m,p)) =l= maxnusep;
 122   
 123  * sum(pv, induse(m,pv))>=1 => induse(m,'o3')=1
 124  * turn around induse(m,'o3')=0 => sum(pv, induse(m,pw))=0
 125  deflogic1(m)..  sum(pv, induse(m,pv)) =l= induse(m,'o3')*card(pv);
 126   
 127  model food / all /;
 128   
 129  store.up(m,p)    = maxstore;
 130  store.fx('m6',p) = stock(p);
 131   
 132  option optcr=0;
 133  solve food max profit using mip;


COMPILATION TIME     =        0.001 SECONDS      3 MB  24.7.4 r58773 LEX-LEG
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:30:34 Page 5
Food Manufacturing Problem - Blending of oils  (FOOD,SEQ=352)
Equation Listing    SOLVE food Using MIP From line 133


---- defobj  =E=  objective

defobj..  - 150*produce(m1) - 150*produce(m2) - 150*produce(m3) - 150*produce(m4) - 150*produce(m5) - 150*produce(m6) + 110*buy(m1,v1) + 120*buy(m1,v2) + 130*buy(m1,o1) + 110*buy(m1,o2) + 115*buy(m1,o3) + 130*buy(m2,v1) + 130*buy(m2,v2) + 110*buy(m2,o1)
     
      + 90*buy(m2,o2) + 115*buy(m2,o3) + 110*buy(m3,v1) + 140*buy(m3,v2) + 130*buy(m3,o1) + 100*buy(m3,o2) + 95*buy(m3,o3) + 120*buy(m4,v1) + 110*buy(m4,v2) + 120*buy(m4,o1) + 120*buy(m4,o2) + 125*buy(m4,o3) + 100*buy(m5,v1) + 120*buy(m5,v2)
     
      + 150*buy(m5,o1) + 110*buy(m5,o2) + 105*buy(m5,o3) + 90*buy(m6,v1) + 100*buy(m6,v2) + 140*buy(m6,o1) + 80*buy(m6,o2) + 135*buy(m6,o3) + 5*store(m1,v1) + 5*store(m1,v2) + 5*store(m1,o1) + 5*store(m1,o2) + 5*store(m1,o3) + 5*store(m2,v1)
     
      + 5*store(m2,v2) + 5*store(m2,o1) + 5*store(m2,o2) + 5*store(m2,o3) + 5*store(m3,v1) + 5*store(m3,v2) + 5*store(m3,o1) + 5*store(m3,o2) + 5*store(m3,o3) + 5*store(m4,v1) + 5*store(m4,v2) + 5*store(m4,o1) + 5*store(m4,o2) + 5*store(m4,o3)
     
      + 5*store(m5,v1) + 5*store(m5,v2) + 5*store(m5,o1) + 5*store(m5,o2) + 5*store(m5,o3) + 5*store(m6,v1) + 5*store(m6,v2) + 5*store(m6,o1) + 5*store(m6,o2) + 5*store(m6,o3) + profit =E= 0 ; (LHS = 12500, INFES = 12500 ****)
     

---- defusepv  =L=  maximum use of vegetable oils

defusepv(m1)..  use(m1,v1) + use(m1,v2) =L= 200 ; (LHS = 0)
     
defusepv(m2)..  use(m2,v1) + use(m2,v2) =L= 200 ; (LHS = 0)
     
defusepv(m3)..  use(m3,v1) + use(m3,v2) =L= 200 ; (LHS = 0)
     
REMAINING 3 ENTRIES SKIPPED


---- defusepnv  =L=  maximum use of non-vegetable oils

defusepnv(m1)..  use(m1,o1) + use(m1,o2) + use(m1,o3) =L= 250 ; (LHS = 0)
     
defusepnv(m2)..  use(m2,o1) + use(m2,o2) + use(m2,o3) =L= 250 ; (LHS = 0)
     
defusepnv(m3)..  use(m3,o1) + use(m3,o2) + use(m3,o3) =L= 250 ; (LHS = 0)
     
REMAINING 3 ENTRIES SKIPPED


---- defproduce  =E=  production of refined oil

defproduce(m1)..  produce(m1) - use(m1,v1) - use(m1,v2) - use(m1,o1) - use(m1,o2) - use(m1,o3) =E= 0 ; (LHS = 0)
     
defproduce(m2)..  produce(m2) - use(m2,v1) - use(m2,v2) - use(m2,o1) - use(m2,o2) - use(m2,o3) =E= 0 ; (LHS = 0)
     
defproduce(m3)..  produce(m3) - use(m3,v1) - use(m3,v2) - use(m3,o1) - use(m3,o2) - use(m3,o3) =E= 0 ; (LHS = 0)
     
REMAINING 3 ENTRIES SKIPPED


---- defhmin  =G=  minmum hardness requirement

defhmin(m1)..  - 3*produce(m1) + 8.8*use(m1,v1) + 6.1*use(m1,v2) + 2*use(m1,o1) + 4.2*use(m1,o2) + 5*use(m1,o3) =G= 0 ; (LHS = 0)
     
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:30:34 Page 6
Food Manufacturing Problem - Blending of oils  (FOOD,SEQ=352)
Equation Listing    SOLVE food Using MIP From line 133


     defhmin  =G=  minmum hardness requirement

defhmin(m2)..  - 3*produce(m2) + 8.8*use(m2,v1) + 6.1*use(m2,v2) + 2*use(m2,o1) + 4.2*use(m2,o2) + 5*use(m2,o3) =G= 0 ; (LHS = 0)
     
defhmin(m3)..  - 3*produce(m3) + 8.8*use(m3,v1) + 6.1*use(m3,v2) + 2*use(m3,o1) + 4.2*use(m3,o2) + 5*use(m3,o3) =G= 0 ; (LHS = 0)
     
REMAINING 3 ENTRIES SKIPPED


---- defhmax  =L=  maximum hardness requirement

defhmax(m1)..  - 6*produce(m1) + 8.8*use(m1,v1) + 6.1*use(m1,v2) + 2*use(m1,o1) + 4.2*use(m1,o2) + 5*use(m1,o3) =L= 0 ; (LHS = 0)
     
defhmax(m2)..  - 6*produce(m2) + 8.8*use(m2,v1) + 6.1*use(m2,v2) + 2*use(m2,o1) + 4.2*use(m2,o2) + 5*use(m2,o3) =L= 0 ; (LHS = 0)
     
defhmax(m3)..  - 6*produce(m3) + 8.8*use(m3,v1) + 6.1*use(m3,v2) + 2*use(m3,o1) + 4.2*use(m3,o2) + 5*use(m3,o3) =L= 0 ; (LHS = 0)
     
REMAINING 3 ENTRIES SKIPPED


---- stockbal  =E=  stock balance constraint

stockbal(m1,v1)..  - use(m1,v1) + buy(m1,v1) - store(m1,v1) + store(m6,v1) =E= 0 ; (LHS = 500, INFES = 500 ****)
     
stockbal(m1,v2)..  - use(m1,v2) + buy(m1,v2) - store(m1,v2) + store(m6,v2) =E= 0 ; (LHS = 500, INFES = 500 ****)
     
stockbal(m1,o1)..  - use(m1,o1) + buy(m1,o1) - store(m1,o1) + store(m6,o1) =E= 0 ; (LHS = 500, INFES = 500 ****)
     
REMAINING 27 ENTRIES SKIPPED


---- minuse  =G=  minimum usage of raw oil

minuse(m1,v1)..  use(m1,v1) - 20*induse(m1,v1) =G= 0 ; (LHS = 0)
     
minuse(m1,v2)..  use(m1,v2) - 20*induse(m1,v2) =G= 0 ; (LHS = 0)
     
minuse(m1,o1)..  use(m1,o1) - 20*induse(m1,o1) =G= 0 ; (LHS = 0)
     
REMAINING 27 ENTRIES SKIPPED


---- maxuse  =L=  usage of raw oil is 0 if induse is 0

maxuse(m1,v1)..  use(m1,v1) - 200*induse(m1,v1) =L= 0 ; (LHS = 0)
     
maxuse(m1,v2)..  use(m1,v2) - 200*induse(m1,v2) =L= 0 ; (LHS = 0)
     
maxuse(m1,o1)..  use(m1,o1) - 250*induse(m1,o1) =L= 0 ; (LHS = 0)
     
REMAINING 27 ENTRIES SKIPPED

GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:30:34 Page 7
Food Manufacturing Problem - Blending of oils  (FOOD,SEQ=352)
Equation Listing    SOLVE food Using MIP From line 133


---- maxnuse  =L=  maximum number of raw oils used in a blend

maxnuse(m1)..  induse(m1,v1) + induse(m1,v2) + induse(m1,o1) + induse(m1,o2) + induse(m1,o3) =L= 3 ; (LHS = 0)
     
maxnuse(m2)..  induse(m2,v1) + induse(m2,v2) + induse(m2,o1) + induse(m2,o2) + induse(m2,o3) =L= 3 ; (LHS = 0)
     
maxnuse(m3)..  induse(m3,v1) + induse(m3,v2) + induse(m3,o1) + induse(m3,o2) + induse(m3,o3) =L= 3 ; (LHS = 0)
     
REMAINING 3 ENTRIES SKIPPED


---- deflogic1  =L=  if some vegetable raw oil is use we also need to use o1

deflogic1(m1)..  induse(m1,v1) + induse(m1,v2) - 2*induse(m1,o3) =L= 0 ; (LHS = 0)
     
deflogic1(m2)..  induse(m2,v1) + induse(m2,v2) - 2*induse(m2,o3) =L= 0 ; (LHS = 0)
     
deflogic1(m3)..  induse(m3,v1) + induse(m3,v2) - 2*induse(m3,o3) =L= 0 ; (LHS = 0)
     
REMAINING 3 ENTRIES SKIPPED

GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:30:34 Page 8
Food Manufacturing Problem - Blending of oils  (FOOD,SEQ=352)
Column Listing      SOLVE food Using MIP From line 133


---- produce  production of blended and refined oil per month

produce(m1)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
     -150       defobj
        1       defproduce(m1)
       -3       defhmin(m1)
       -6       defhmax(m1)

produce(m2)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
     -150       defobj
        1       defproduce(m2)
       -3       defhmin(m2)
       -6       defhmax(m2)

produce(m3)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
     -150       defobj
        1       defproduce(m3)
       -3       defhmin(m3)
       -6       defhmax(m3)

REMAINING 3 ENTRIES SKIPPED

---- use  usage of raw oil per month

use(m1,v1)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
        1       defusepv(m1)
       -1       defproduce(m1)
        8.8     defhmin(m1)
        8.8     defhmax(m1)
       -1       stockbal(m1,v1)
        1       minuse(m1,v1)
        1       maxuse(m1,v1)

use(m1,v2)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
        1       defusepv(m1)
       -1       defproduce(m1)
        6.1     defhmin(m1)
        6.1     defhmax(m1)
       -1       stockbal(m1,v2)
        1       minuse(m1,v2)
        1       maxuse(m1,v2)

use(m1,o1)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
        1       defusepnv(m1)
       -1       defproduce(m1)
        2       defhmin(m1)
        2       defhmax(m1)
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                      12/13/18 11:30:34 Page 9
Food Manufacturing Problem - Blending of oils  (FOOD,SEQ=352)
Column Listing      SOLVE food Using MIP From line 133


     use  usage of raw oil per month

       -1       stockbal(m1,o1)
        1       minuse(m1,o1)
        1       maxuse(m1,o1)

REMAINING 27 ENTRIES SKIPPED

---- induse  indicator for usage of raw oil per month

induse(m1,v1)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
      -20       minuse(m1,v1)
     -200       maxuse(m1,v1)
        1       maxnuse(m1)
        1       deflogic1(m1)

induse(m1,v2)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
      -20       minuse(m1,v2)
     -200       maxuse(m1,v2)
        1       maxnuse(m1)
        1       deflogic1(m1)

induse(m1,o1)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
      -20       minuse(m1,o1)
     -250       maxuse(m1,o1)
        1       maxnuse(m1)

REMAINING 27 ENTRIES SKIPPED

---- buy  purchase of raw oil per month

buy(m1,v1)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
      110       defobj
        1       stockbal(m1,v1)

buy(m1,v2)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
      120       defobj
        1       stockbal(m1,v2)

buy(m1,o1)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
      130       defobj
        1       stockbal(m1,o1)

REMAINING 27 ENTRIES SKIPPED
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:30:34 Page 10
Food Manufacturing Problem - Blending of oils  (FOOD,SEQ=352)
Column Listing      SOLVE food Using MIP From line 133


---- store  storage of raw oil at end of the month

store(m1,v1)
                (.LO, .L, .UP, .M = 0, 0, 1000, 0)
        5       defobj
       -1       stockbal(m1,v1)
        1       stockbal(m2,v1)

store(m1,v2)
                (.LO, .L, .UP, .M = 0, 0, 1000, 0)
        5       defobj
       -1       stockbal(m1,v2)
        1       stockbal(m2,v2)

store(m1,o1)
                (.LO, .L, .UP, .M = 0, 0, 1000, 0)
        5       defobj
       -1       stockbal(m1,o1)
        1       stockbal(m2,o1)

REMAINING 27 ENTRIES SKIPPED

---- profit  objective variable

profit
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       defobj

GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:30:34 Page 11
Food Manufacturing Problem - Blending of oils  (FOOD,SEQ=352)
Model Statistics    SOLVE food Using MIP From line 133


MODEL STATISTICS

BLOCKS OF EQUATIONS          11     SINGLE EQUATIONS          133
BLOCKS OF VARIABLES           6     SINGLE VARIABLES          127
NON ZERO ELEMENTS           493     DISCRETE VARIABLES         30


GENERATION TIME      =        0.003 SECONDS      4 MB  24.7.4 r58773 LEX-LEG


EXECUTION TIME       =        0.003 SECONDS      4 MB  24.7.4 r58773 LEX-LEG
GAMS 24.7.4  r58773 Released Sep 19, 2016 LEX-LEG x86 64bit/Linux                                                                                                                                                                     12/13/18 11:30:34 Page 12
Food Manufacturing Problem - Blending of oils  (FOOD,SEQ=352)
Solution Report     SOLVE food Using MIP From line 133


               S O L V E      S U M M A R Y

     MODEL   food                OBJECTIVE  profit
     TYPE    MIP                 DIRECTION  MAXIMIZE
     SOLVER  CONVERT             FROM LINE  133

**** SOLVER STATUS     1 Normal Completion         
**** MODEL STATUS      14 No Solution Returned     
**** OBJECTIVE VALUE                0.0000

 RESOURCE USAGE, LIMIT          0.000      1000.000
 ITERATION COUNT, LIMIT         0    2000000000

Convert 2.0      24.7.4 r58773 Released Sep 19, 2016 LEG x86 64bit/Linux      

--- Using Option File
Reading parameter(s) from "/home/renigijus/gams/opt-mod-lib/gamslib/food/convert.opt"
>>  gams food-scalar.gms
Finished reading from "/home/renigijus/gams/opt-mod-lib/gamslib/food/convert.opt"
Gams      : food-scalar.gms


No solution returned


EXECUTION TIME       =        0.000 SECONDS      2 MB  24.7.4 r58773 LEX-LEG


USER: Remigijus Paulavicius, Single User License     S170731:0859AO-LNX
      Imperial College London, Dept. of Chemical Engineering    DC13449
      License for teaching and research at degree granting institutions


**** FILE SUMMARY

Input      /home/renigijus/gams/opt-mod-lib/gamslib/food/food.gms
Output     /home/renigijus/gams/opt-mod-lib/gamslib/food/food-scalar.gms.lst
